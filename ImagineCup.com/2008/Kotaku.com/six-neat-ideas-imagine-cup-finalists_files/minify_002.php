
(function(){var
window=this,undefined,_jQuery=window.jQuery,_$=window.$,jQuery=window.jQuery=window.$=function(selector,context){return new jQuery.fn.init(selector,context);},quickExpr=/^[^<]*(<(.|\s)+>)[^>]*$|^#([\w-]+)$/,isSimple=/^.[^:#\[\.,]*$/;jQuery.fn=jQuery.prototype={init:function(selector,context){selector=selector||document;if(selector.nodeType){this[0]=selector;this.length=1;this.context=selector;return this;}
if(typeof selector==="string"){var match=quickExpr.exec(selector);if(match&&(match[1]||!context)){if(match[1])
selector=jQuery.clean([match[1]],context);else{var elem=document.getElementById(match[3]);if(elem&&elem.id!=match[3])
return jQuery().find(selector);var ret=jQuery(elem||[]);ret.context=document;ret.selector=selector;return ret;}}else
return jQuery(context).find(selector);}else if(jQuery.isFunction(selector))
return jQuery(document).ready(selector);if(selector.selector&&selector.context){this.selector=selector.selector;this.context=selector.context;}
return this.setArray(jQuery.isArray(selector)?selector:jQuery.makeArray(selector));},selector:"",jquery:"1.3.2",size:function(){return this.length;},get:function(num){return num===undefined?Array.prototype.slice.call(this):this[num];},pushStack:function(elems,name,selector){var ret=jQuery(elems);ret.prevObject=this;ret.context=this.context;if(name==="find")
ret.selector=this.selector+(this.selector?" ":"")+selector;else if(name)
ret.selector=this.selector+"."+name+"("+selector+")";return ret;},setArray:function(elems){this.length=0;Array.prototype.push.apply(this,elems);return this;},each:function(callback,args){return jQuery.each(this,callback,args);},index:function(elem){return jQuery.inArray(elem&&elem.jquery?elem[0]:elem,this);},attr:function(name,value,type){var options=name;if(typeof name==="string")
if(value===undefined)
return this[0]&&jQuery[type||"attr"](this[0],name);else{options={};options[name]=value;}
return this.each(function(i){for(name in options)
jQuery.attr(type?this.style:this,name,jQuery.prop(this,options[name],type,i,name));});},css:function(key,value){if((key=='width'||key=='height')&&parseFloat(value)<0)
value=undefined;return this.attr(key,value,"curCSS");},text:function(text){if(typeof text!=="object"&&text!=null)
return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(text));var ret="";jQuery.each(text||this,function(){jQuery.each(this.childNodes,function(){if(this.nodeType!=8)
ret+=this.nodeType!=1?this.nodeValue:jQuery.fn.text([this]);});});return ret;},wrapAll:function(html){if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).clone();if(this[0].parentNode)
wrap.insertBefore(this[0]);wrap.map(function(){var elem=this;while(elem.firstChild)
elem=elem.firstChild;return elem;}).append(this);}
return this;},wrapInner:function(html){return this.each(function(){jQuery(this).contents().wrapAll(html);});},wrap:function(html){return this.each(function(){jQuery(this).wrapAll(html);});},append:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType==1)
this.appendChild(elem);});},prepend:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType==1)
this.insertBefore(elem,this.firstChild);});},before:function(){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this);});},after:function(){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this.nextSibling);});},end:function(){return this.prevObject||jQuery([]);},push:[].push,sort:[].sort,splice:[].splice,find:function(selector){if(this.length===1){var ret=this.pushStack([],"find",selector);ret.length=0;jQuery.find(selector,this[0],ret);return ret;}else{return this.pushStack(jQuery.unique(jQuery.map(this,function(elem){return jQuery.find(selector,elem);})),"find",selector);}},clone:function(events){var ret=this.map(function(){if(!jQuery.support.noCloneEvent&&!jQuery.isXMLDoc(this)){var html=this.outerHTML;if(!html){var div=this.ownerDocument.createElement("div");div.appendChild(this.cloneNode(true));html=div.innerHTML;}
return jQuery.clean([html.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/^\s*/,"")])[0];}else
return this.cloneNode(true);});if(events===true){var orig=this.find("*").andSelf(),i=0;ret.find("*").andSelf().each(function(){if(this.nodeName!==orig[i].nodeName)
return;var events=jQuery.data(orig[i],"events");for(var type in events){for(var handler in events[type]){jQuery.event.add(this,type,events[type][handler],events[type][handler].data);}}
i++;});}
return ret;},filter:function(selector){return this.pushStack(jQuery.isFunction(selector)&&jQuery.grep(this,function(elem,i){return selector.call(elem,i);})||jQuery.multiFilter(selector,jQuery.grep(this,function(elem){return elem.nodeType===1;})),"filter",selector);},closest:function(selector){var pos=jQuery.expr.match.POS.test(selector)?jQuery(selector):null,closer=0;return this.map(function(){var cur=this;while(cur&&cur.ownerDocument){if(pos?pos.index(cur)>-1:jQuery(cur).is(selector)){jQuery.data(cur,"closest",closer);return cur;}
cur=cur.parentNode;closer++;}});},not:function(selector){if(typeof selector==="string")
if(isSimple.test(selector))
return this.pushStack(jQuery.multiFilter(selector,this,true),"not",selector);else
selector=jQuery.multiFilter(selector,this);var isArrayLike=selector.length&&selector[selector.length-1]!==undefined&&!selector.nodeType;return this.filter(function(){return isArrayLike?jQuery.inArray(this,selector)<0:this!=selector;});},add:function(selector){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),typeof selector==="string"?jQuery(selector):jQuery.makeArray(selector))));},is:function(selector){return!!selector&&jQuery.multiFilter(selector,this).length>0;},hasClass:function(selector){return!!selector&&this.is("."+selector);},val:function(value){if(value===undefined){var elem=this[0];if(elem){if(jQuery.nodeName(elem,'option'))
return(elem.attributes.value||{}).specified?elem.value:elem.text;if(jQuery.nodeName(elem,"select")){var index=elem.selectedIndex,values=[],options=elem.options,one=elem.type=="select-one";if(index<0)
return null;for(var i=one?index:0,max=one?index+1:options.length;i<max;i++){var option=options[i];if(option.selected){value=jQuery(option).val();if(one)
return value;values.push(value);}}
return values;}
return(elem.value||"").replace(/\r/g,"");}
return undefined;}
if(typeof value==="number")
value+='';return this.each(function(){if(this.nodeType!=1)
return;if(jQuery.isArray(value)&&/radio|checkbox/.test(this.type))
this.checked=(jQuery.inArray(this.value,value)>=0||jQuery.inArray(this.name,value)>=0);else if(jQuery.nodeName(this,"select")){var values=jQuery.makeArray(value);jQuery("option",this).each(function(){this.selected=(jQuery.inArray(this.value,values)>=0||jQuery.inArray(this.text,values)>=0);});if(!values.length)
this.selectedIndex=-1;}else
this.value=value;});},html:function(value){return value===undefined?(this[0]?this[0].innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,""):null):this.empty().append(value);},replaceWith:function(value){return this.after(value).remove();},eq:function(i){return this.slice(i,+i+1);},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,arguments),"slice",Array.prototype.slice.call(arguments).join(","));},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},andSelf:function(){return this.add(this.prevObject);},domManip:function(args,table,callback){if(this[0]){var fragment=(this[0].ownerDocument||this[0]).createDocumentFragment(),scripts=jQuery.clean(args,(this[0].ownerDocument||this[0]),fragment),first=fragment.firstChild;if(first)
for(var i=0,l=this.length;i<l;i++)
callback.call(root(this[i],first),this.length>1||i>0?fragment.cloneNode(true):fragment);if(scripts)
jQuery.each(scripts,evalScript);}
return this;function root(elem,cur){return table&&jQuery.nodeName(elem,"table")&&jQuery.nodeName(cur,"tr")?(elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody"))):elem;}}};jQuery.fn.init.prototype=jQuery.fn;function evalScript(i,elem){if(elem.src)
jQuery.ajax({url:elem.src,async:false,dataType:"script"});else
jQuery.globalEval(elem.text||elem.textContent||elem.innerHTML||"");if(elem.parentNode)
elem.parentNode.removeChild(elem);}
function now(){return+new Date;}
jQuery.extend=jQuery.fn.extend=function(){var target=arguments[0]||{},i=1,length=arguments.length,deep=false,options;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2;}
if(typeof target!=="object"&&!jQuery.isFunction(target))
target={};if(length==i){target=this;--i;}
for(;i<length;i++)
if((options=arguments[i])!=null)
for(var name in options){var src=target[name],copy=options[name];if(target===copy)
continue;if(deep&&copy&&typeof copy==="object"&&!copy.nodeType)
target[name]=jQuery.extend(deep,src||(copy.length!=null?[]:{}),copy);else if(copy!==undefined)
target[name]=copy;}
return target;};var exclude=/z-?index|font-?weight|opacity|zoom|line-?height/i,defaultView=document.defaultView||{},toString=Object.prototype.toString;jQuery.extend({noConflict:function(deep){window.$=_$;if(deep)
window.jQuery=_jQuery;return jQuery;},isFunction:function(obj){return toString.call(obj)==="[object Function]";},isArray:function(obj){return toString.call(obj)==="[object Array]";},isXMLDoc:function(elem){return elem.nodeType===9&&elem.documentElement.nodeName!=="HTML"||!!elem.ownerDocument&&jQuery.isXMLDoc(elem.ownerDocument);},globalEval:function(data){if(data&&/\S/.test(data)){var head=document.getElementsByTagName("head")[0]||document.documentElement,script=document.createElement("script");script.type="text/javascript";if(jQuery.support.scriptEval)
script.appendChild(document.createTextNode(data));else
script.text=data;head.insertBefore(script,head.firstChild);head.removeChild(script);}},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toUpperCase()==name.toUpperCase();},each:function(object,callback,args){var name,i=0,length=object.length;if(args){if(length===undefined){for(name in object)
if(callback.apply(object[name],args)===false)
break;}else
for(;i<length;)
if(callback.apply(object[i++],args)===false)
break;}else{if(length===undefined){for(name in object)
if(callback.call(object[name],name,object[name])===false)
break;}else
for(var value=object[0];i<length&&callback.call(value,i,value)!==false;value=object[++i]){}}
return object;},prop:function(elem,value,type,i,name){if(jQuery.isFunction(value))
value=value.call(elem,i);return typeof value==="number"&&type=="curCSS"&&!exclude.test(name)?value+"px":value;},className:{add:function(elem,classNames){jQuery.each((classNames||"").split(/\s+/),function(i,className){if(elem.nodeType==1&&!jQuery.className.has(elem.className,className))
elem.className+=(elem.className?" ":"")+className;});},remove:function(elem,classNames){if(elem.nodeType==1)
elem.className=classNames!==undefined?jQuery.grep(elem.className.split(/\s+/),function(className){return!jQuery.className.has(classNames,className);}).join(" "):"";},has:function(elem,className){return elem&&jQuery.inArray(className,(elem.className||elem).toString().split(/\s+/))>-1;}},swap:function(elem,options,callback){var old={};for(var name in options){old[name]=elem.style[name];elem.style[name]=options[name];}
callback.call(elem);for(var name in options)
elem.style[name]=old[name];},css:function(elem,name,force,extra){if(name=="width"||name=="height"){var val,props={position:"absolute",visibility:"hidden",display:"block"},which=name=="width"?["Left","Right"]:["Top","Bottom"];function getWH(){val=name=="width"?elem.offsetWidth:elem.offsetHeight;if(extra==="border")
return;jQuery.each(which,function(){if(!extra)
val-=parseFloat(jQuery.curCSS(elem,"padding"+this,true))||0;if(extra==="margin")
val+=parseFloat(jQuery.curCSS(elem,"margin"+this,true))||0;else
val-=parseFloat(jQuery.curCSS(elem,"border"+this+"Width",true))||0;});}
if(elem.offsetWidth!==0)
getWH();else
jQuery.swap(elem,props,getWH);return Math.max(0,Math.round(val));}
return jQuery.curCSS(elem,name,force);},curCSS:function(elem,name,force){var ret,style=elem.style;if(name=="opacity"&&!jQuery.support.opacity){ret=jQuery.attr(style,"opacity");return ret==""?"1":ret;}
if(name.match(/float/i))
name=styleFloat;if(!force&&style&&style[name])
ret=style[name];else if(defaultView.getComputedStyle){if(name.match(/float/i))
name="float";name=name.replace(/([A-Z])/g,"-$1").toLowerCase();var computedStyle=defaultView.getComputedStyle(elem,null);if(computedStyle)
ret=computedStyle.getPropertyValue(name);if(name=="opacity"&&ret=="")
ret="1";}else if(elem.currentStyle){var camelCase=name.replace(/\-(\w)/g,function(all,letter){return letter.toUpperCase();});ret=elem.currentStyle[name]||elem.currentStyle[camelCase];if(!/^\d+(px)?$/i.test(ret)&&/^\d/.test(ret)){var left=style.left,rsLeft=elem.runtimeStyle.left;elem.runtimeStyle.left=elem.currentStyle.left;style.left=ret||0;ret=style.pixelLeft+"px";style.left=left;elem.runtimeStyle.left=rsLeft;}}
return ret;},clean:function(elems,context,fragment){context=context||document;if(typeof context.createElement==="undefined")
context=context.ownerDocument||context[0]&&context[0].ownerDocument||document;if(!fragment&&elems.length===1&&typeof elems[0]==="string"){var match=/^<(\w+)\s*\/?>$/.exec(elems[0]);if(match)
return[context.createElement(match[1])];}
var ret=[],scripts=[],div=context.createElement("div");jQuery.each(elems,function(i,elem){if(typeof elem==="number")
elem+='';if(!elem)
return;if(typeof elem==="string"){elem=elem.replace(/(<(\w+)[^>]*?)\/>/g,function(all,front,tag){return tag.match(/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i)?all:front+"></"+tag+">";});var tags=elem.replace(/^\s+/,"").substring(0,10).toLowerCase();var wrap=!tags.indexOf("<opt")&&[1,"<select multiple='multiple'>","</select>"]||!tags.indexOf("<leg")&&[1,"<fieldset>","</fieldset>"]||tags.match(/^<(thead|tbody|tfoot|colg|cap)/)&&[1,"<table>","</table>"]||!tags.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!tags.indexOf("<td")||!tags.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||!tags.indexOf("<col")&&[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"]||!jQuery.support.htmlSerialize&&[1,"div<div>","</div>"]||[0,"",""];div.innerHTML=wrap[1]+elem+wrap[2];while(wrap[0]--)
div=div.lastChild;if(!jQuery.support.tbody){var hasBody=/<tbody/i.test(elem),tbody=!tags.indexOf("<table")&&!hasBody?div.firstChild&&div.firstChild.childNodes:wrap[1]=="<table>"&&!hasBody?div.childNodes:[];for(var j=tbody.length-1;j>=0;--j)
if(jQuery.nodeName(tbody[j],"tbody")&&!tbody[j].childNodes.length)
tbody[j].parentNode.removeChild(tbody[j]);}
if(!jQuery.support.leadingWhitespace&&/^\s/.test(elem))
div.insertBefore(context.createTextNode(elem.match(/^\s*/)[0]),div.firstChild);elem=jQuery.makeArray(div.childNodes);}
if(elem.nodeType)
ret.push(elem);else
ret=jQuery.merge(ret,elem);});if(fragment){for(var i=0;ret[i];i++){if(jQuery.nodeName(ret[i],"script")&&(!ret[i].type||ret[i].type.toLowerCase()==="text/javascript")){scripts.push(ret[i].parentNode?ret[i].parentNode.removeChild(ret[i]):ret[i]);}else{if(ret[i].nodeType===1)
ret.splice.apply(ret,[i+1,0].concat(jQuery.makeArray(ret[i].getElementsByTagName("script"))));fragment.appendChild(ret[i]);}}
return scripts;}
return ret;},attr:function(elem,name,value){if(!elem||elem.nodeType==3||elem.nodeType==8)
return undefined;var notxml=!jQuery.isXMLDoc(elem),set=value!==undefined;name=notxml&&jQuery.props[name]||name;if(elem.tagName){var special=/href|src|style/.test(name);if(name=="selected"&&elem.parentNode)
elem.parentNode.selectedIndex;if(name in elem&&notxml&&!special){if(set){if(name=="type"&&jQuery.nodeName(elem,"input")&&elem.parentNode)
throw"type property can't be changed";elem[name]=value;}
if(jQuery.nodeName(elem,"form")&&elem.getAttributeNode(name))
return elem.getAttributeNode(name).nodeValue;if(name=="tabIndex"){var attributeNode=elem.getAttributeNode("tabIndex");return attributeNode&&attributeNode.specified?attributeNode.value:elem.nodeName.match(/(button|input|object|select|textarea)/i)?0:elem.nodeName.match(/^(a|area)$/i)&&elem.href?0:undefined;}
return elem[name];}
if(!jQuery.support.style&&notxml&&name=="style")
return jQuery.attr(elem.style,"cssText",value);if(set)
elem.setAttribute(name,""+value);var attr=!jQuery.support.hrefNormalized&&notxml&&special?elem.getAttribute(name,2):elem.getAttribute(name);return attr===null?undefined:attr;}
if(!jQuery.support.opacity&&name=="opacity"){if(set){elem.zoom=1;elem.filter=(elem.filter||"").replace(/alpha\([^)]*\)/,"")+
(parseInt(value)+''=="NaN"?"":"alpha(opacity="+value*100+")");}
return elem.filter&&elem.filter.indexOf("opacity=")>=0?(parseFloat(elem.filter.match(/opacity=([^)]*)/)[1])/100)+'':"";}
name=name.replace(/-([a-z])/ig,function(all,letter){return letter.toUpperCase();});if(set)
elem[name]=value;return elem[name];},trim:function(text){return(text||"").replace(/^\s+|\s+$/g,"");},makeArray:function(array){var ret=[];if(array!=null){var i=array.length;if(i==null||typeof array==="string"||jQuery.isFunction(array)||array.setInterval)
ret[0]=array;else
while(i)
ret[--i]=array[i];}
return ret;},inArray:function(elem,array){for(var i=0,length=array.length;i<length;i++)
if(array[i]===elem)
return i;return-1;},merge:function(first,second){var i=0,elem,pos=first.length;if(!jQuery.support.getAll){while((elem=second[i++])!=null)
if(elem.nodeType!=8)
first[pos++]=elem;}else
while((elem=second[i++])!=null)
first[pos++]=elem;return first;},unique:function(array){var ret=[],done={};try{for(var i=0,length=array.length;i<length;i++){var id=jQuery.data(array[i]);if(!done[id]){done[id]=true;ret.push(array[i]);}}}catch(e){ret=array;}
return ret;},grep:function(elems,callback,inv){var ret=[];for(var i=0,length=elems.length;i<length;i++)
if(!inv!=!callback(elems[i],i))
ret.push(elems[i]);return ret;},map:function(elems,callback){var ret=[];for(var i=0,length=elems.length;i<length;i++){var value=callback(elems[i],i);if(value!=null)
ret[ret.length]=value;}
return ret.concat.apply([],ret);}});var userAgent=navigator.userAgent.toLowerCase();jQuery.browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,'0'])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),msie:/msie/.test(userAgent)&&!/opera/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent)};jQuery.each({parent:function(elem){return elem.parentNode;},parents:function(elem){return jQuery.dir(elem,"parentNode");},next:function(elem){return jQuery.nth(elem,2,"nextSibling");},prev:function(elem){return jQuery.nth(elem,2,"previousSibling");},nextAll:function(elem){return jQuery.dir(elem,"nextSibling");},prevAll:function(elem){return jQuery.dir(elem,"previousSibling");},siblings:function(elem){return jQuery.sibling(elem.parentNode.firstChild,elem);},children:function(elem){return jQuery.sibling(elem.firstChild);},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.makeArray(elem.childNodes);}},function(name,fn){jQuery.fn[name]=function(selector){var ret=jQuery.map(this,fn);if(selector&&typeof selector=="string")
ret=jQuery.multiFilter(selector,ret);return this.pushStack(jQuery.unique(ret),name,selector);};});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector);for(var i=0,l=insert.length;i<l;i++){var elems=(i>0?this.clone(true):this).get();jQuery.fn[original].apply(jQuery(insert[i]),elems);ret=ret.concat(elems);}
return this.pushStack(ret,name,selector);};});jQuery.each({removeAttr:function(name){jQuery.attr(this,name,"");if(this.nodeType==1)
this.removeAttribute(name);},addClass:function(classNames){jQuery.className.add(this,classNames);},removeClass:function(classNames){jQuery.className.remove(this,classNames);},toggleClass:function(classNames,state){if(typeof state!=="boolean")
state=!jQuery.className.has(this,classNames);jQuery.className[state?"add":"remove"](this,classNames);},remove:function(selector){if(!selector||jQuery.filter(selector,[this]).length){jQuery("*",this).add([this]).each(function(){jQuery.event.remove(this);jQuery.removeData(this);});if(this.parentNode)
this.parentNode.removeChild(this);}},empty:function(){jQuery(this).children().remove();while(this.firstChild)
this.removeChild(this.firstChild);}},function(name,fn){jQuery.fn[name]=function(){return this.each(fn,arguments);};});function num(elem,prop){return elem[0]&&parseInt(jQuery.curCSS(elem[0],prop,true),10)||0;}
var expando="jQuery"+now(),uuid=0,windowData={};jQuery.extend({cache:{},data:function(elem,name,data){elem=elem==window?windowData:elem;var id=elem[expando];if(!id)
id=elem[expando]=++uuid;if(name&&!jQuery.cache[id])
jQuery.cache[id]={};if(data!==undefined)
jQuery.cache[id][name]=data;return name?jQuery.cache[id][name]:id;},removeData:function(elem,name){elem=elem==window?windowData:elem;var id=elem[expando];if(name){if(jQuery.cache[id]){delete jQuery.cache[id][name];name="";for(name in jQuery.cache[id])
break;if(!name)
jQuery.removeData(elem);}}else{try{delete elem[expando];}catch(e){if(elem.removeAttribute)
elem.removeAttribute(expando);}
delete jQuery.cache[id];}},queue:function(elem,type,data){if(elem){type=(type||"fx")+"queue";var q=jQuery.data(elem,type);if(!q||jQuery.isArray(data))
q=jQuery.data(elem,type,jQuery.makeArray(data));else if(data)
q.push(data);}
return q;},dequeue:function(elem,type){var queue=jQuery.queue(elem,type),fn=queue.shift();if(!type||type==="fx")
fn=queue[0];if(fn!==undefined)
fn.call(elem);}});jQuery.fn.extend({data:function(key,value){var parts=key.split(".");parts[1]=parts[1]?"."+parts[1]:"";if(value===undefined){var data=this.triggerHandler("getData"+parts[1]+"!",[parts[0]]);if(data===undefined&&this.length)
data=jQuery.data(this[0],key);return data===undefined&&parts[1]?this.data(parts[0]):data;}else
return this.trigger("setData"+parts[1]+"!",[parts[0],value]).each(function(){jQuery.data(this,key,value);});},removeData:function(key){return this.each(function(){jQuery.removeData(this,key);});},queue:function(type,data){if(typeof type!=="string"){data=type;type="fx";}
if(data===undefined)
return jQuery.queue(this[0],type);return this.each(function(){var queue=jQuery.queue(this,type,data);if(type=="fx"&&queue.length==1)
queue[0].call(this);});},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type);});}});(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?/g,done=0,toString=Object.prototype.toString;var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;if(context.nodeType!==1&&context.nodeType!==9)
return[];if(!selector||typeof selector!=="string"){return results;}
var parts=[],m,set,checkSet,check,mode,extra,prune=true;chunker.lastIndex=0;while((m=chunker.exec(selector))!==null){parts.push(m[1]);if(m[2]){extra=RegExp.rightContext;break;}}
if(parts.length>1&&origPOS.exec(selector)){if(parts.length===2&&Expr.relative[parts[0]]){set=posProcess(parts[0]+parts[1],context);}else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector])
selector+=parts.shift();set=posProcess(selector,set);}}}else{var ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&context.parentNode?context.parentNode:context,isXML(context));set=Sizzle.filter(ret.expr,ret.set);if(parts.length>0){checkSet=makeArray(set);}else{prune=false;}
while(parts.length){var cur=parts.pop(),pop=cur;if(!Expr.relative[cur]){cur="";}else{pop=parts.pop();}
if(pop==null){pop=context;}
Expr.relative[cur](checkSet,pop,isXML(context));}}
if(!checkSet){checkSet=set;}
if(!checkSet){throw"Syntax error, unrecognized expression: "+(cur||selector);}
if(toString.call(checkSet)==="[object Array]"){if(!prune){results.push.apply(results,checkSet);}else if(context.nodeType===1){for(var i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&contains(context,checkSet[i]))){results.push(set[i]);}}}else{for(var i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1){results.push(set[i]);}}}}else{makeArray(checkSet,results);}
if(extra){Sizzle(extra,context,results,seed);if(sortOrder){hasDuplicate=false;results.sort(sortOrder);if(hasDuplicate){for(var i=1;i<results.length;i++){if(results[i]===results[i-1]){results.splice(i--,1);}}}}}
return results;};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set);};Sizzle.find=function(expr,context,isXML){var set,match;if(!expr){return[];}
for(var i=0,l=Expr.order.length;i<l;i++){var type=Expr.order[i],match;if((match=Expr.match[type].exec(expr))){var left=RegExp.leftContext;if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(/\\/g,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break;}}}}
if(!set){set=context.getElementsByTagName("*");}
return{set:set,expr:expr};};Sizzle.filter=function(expr,set,inplace,not){var old=expr,result=[],curLoop=set,match,anyFound,isXMLFilter=set&&set[0]&&isXML(set[0]);while(expr&&set.length){for(var type in Expr.filter){if((match=Expr.match[type].exec(expr))!=null){var filter=Expr.filter[type],found,item;anyFound=false;if(curLoop==result){result=[];}
if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match){anyFound=found=true;}else if(match===true){continue;}}
if(match){for(var i=0;(item=curLoop[i])!=null;i++){if(item){found=filter(item,match,i,curLoop);var pass=not^!!found;if(inplace&&found!=null){if(pass){anyFound=true;}else{curLoop[i]=false;}}else if(pass){result.push(item);anyFound=true;}}}}
if(found!==undefined){if(!inplace){curLoop=result;}
expr=expr.replace(Expr.match[type],"");if(!anyFound){return[];}
break;}}}
if(expr==old){if(anyFound==null){throw"Syntax error, unrecognized expression: "+expr;}else{break;}}
old=expr;}
return curLoop;};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF_-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF_-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href");}},relative:{"+":function(checkSet,part,isXML){var isPartStr=typeof part==="string",isTag=isPartStr&&!/\W/.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag&&!isXML){part=part.toUpperCase();}
for(var i=0,l=checkSet.length,elem;i<l;i++){if((elem=checkSet[i])){while((elem=elem.previousSibling)&&elem.nodeType!==1){}
checkSet[i]=isPartStrNotTag||elem&&elem.nodeName===part?elem||false:elem===part;}}
if(isPartStrNotTag){Sizzle.filter(part,checkSet,true);}},">":function(checkSet,part,isXML){var isPartStr=typeof part==="string";if(isPartStr&&!/\W/.test(part)){part=isXML?part:part.toUpperCase();for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName===part?parent:false;}}}else{for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part;}}
if(isPartStr){Sizzle.filter(part,checkSet,true);}}},"":function(checkSet,part,isXML){var doneName=done++,checkFn=dirCheck;if(!part.match(/\W/)){var nodeCheck=part=isXML?part:part.toUpperCase();checkFn=dirNodeCheck;}
checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML);},"~":function(checkSet,part,isXML){var doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!part.match(/\W/)){var nodeCheck=part=isXML?part:part.toUpperCase();checkFn=dirNodeCheck;}
checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML);}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?[m]:[];}},NAME:function(match,context,isXML){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++){if(results[i].getAttribute("name")===match[1]){ret.push(results[i]);}}
return ret.length===0?null:ret;}},TAG:function(match,context){return context.getElementsByTagName(match[1]);}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(/\\/g,"")+" ";if(isXML){return match;}
for(var i=0,elem;(elem=curLoop[i])!=null;i++){if(elem){if(not^(elem.className&&(" "+elem.className+" ").indexOf(match)>=0)){if(!inplace)
result.push(elem);}else if(inplace){curLoop[i]=false;}}}
return false;},ID:function(match){return match[1].replace(/\\/g,"");},TAG:function(match,curLoop){for(var i=0;curLoop[i]===false;i++){}
return curLoop[i]&&isXML(curLoop[i])?match[1]:match[1].toUpperCase();},CHILD:function(match){if(match[1]=="nth"){var test=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(match[2]=="even"&&"2n"||match[2]=="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=(test[1]+(test[2]||1))-0;match[3]=test[3]-0;}
match[0]=done++;return match;},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1].replace(/\\/g,"");if(!isXML&&Expr.attrMap[name]){match[1]=Expr.attrMap[name];}
if(match[2]==="~="){match[4]=" "+match[4]+" ";}
return match;},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not"){if(match[3].match(chunker).length>1||/^\w/.test(match[3])){match[3]=Sizzle(match[3],null,null,curLoop);}else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace){result.push.apply(result,ret);}
return false;}}else if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0])){return true;}
return match;},POS:function(match){match.unshift(true);return match;}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden";},disabled:function(elem){return elem.disabled===true;},checked:function(elem){return elem.checked===true;},selected:function(elem){elem.parentNode.selectedIndex;return elem.selected===true;},parent:function(elem){return!!elem.firstChild;},empty:function(elem){return!elem.firstChild;},has:function(elem,i,match){return!!Sizzle(match[3],elem).length;},header:function(elem){return/h\d/i.test(elem.nodeName);},text:function(elem){return"text"===elem.type;},radio:function(elem){return"radio"===elem.type;},checkbox:function(elem){return"checkbox"===elem.type;},file:function(elem){return"file"===elem.type;},password:function(elem){return"password"===elem.type;},submit:function(elem){return"submit"===elem.type;},image:function(elem){return"image"===elem.type;},reset:function(elem){return"reset"===elem.type;},button:function(elem){return"button"===elem.type||elem.nodeName.toUpperCase()==="BUTTON";},input:function(elem){return/input|select|textarea|button/i.test(elem.nodeName);}},setFilters:{first:function(elem,i){return i===0;},last:function(elem,i,match,array){return i===array.length-1;},even:function(elem,i){return i%2===0;},odd:function(elem,i){return i%2===1;},lt:function(elem,i,match){return i<match[3]-0;},gt:function(elem,i,match){return i>match[3]-0;},nth:function(elem,i,match){return match[3]-0==i;},eq:function(elem,i,match){return match[3]-0==i;}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter){return filter(elem,i,match,array);}else if(name==="contains"){return(elem.textContent||elem.innerText||"").indexOf(match[3])>=0;}else if(name==="not"){var not=match[3];for(var i=0,l=not.length;i<l;i++){if(not[i]===elem){return false;}}
return true;}},CHILD:function(elem,match){var type=match[1],node=elem;switch(type){case'only':case'first':while(node=node.previousSibling){if(node.nodeType===1)return false;}
if(type=='first')return true;node=elem;case'last':while(node=node.nextSibling){if(node.nodeType===1)return false;}
return true;case'nth':var first=match[2],last=match[3];if(first==1&&last==0){return true;}
var doneName=match[0],parent=elem.parentNode;if(parent&&(parent.sizcache!==doneName||!elem.nodeIndex)){var count=0;for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.nodeIndex=++count;}}
parent.sizcache=doneName;}
var diff=elem.nodeIndex-last;if(first==0){return diff==0;}else{return(diff%first==0&&diff/first>=0);}}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match;},TAG:function(elem,match){return(match==="*"&&elem.nodeType===1)||elem.nodeName===match;},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1;},ATTR:function(elem,match){var name=match[1],result=Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!=check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false;},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter){return filter(elem,i,match,array);}}}};var origPOS=Expr.match.POS;for(var type in Expr.match){Expr.match[type]=RegExp(Expr.match[type].source+/(?![^\[]*\])(?![^\(]*\))/.source);}
var makeArray=function(array,results){array=Array.prototype.slice.call(array);if(results){results.push.apply(results,array);return results;}
return array;};try{Array.prototype.slice.call(document.documentElement.childNodes);}catch(e){makeArray=function(array,results){var ret=results||[];if(toString.call(array)==="[object Array]"){Array.prototype.push.apply(ret,array);}else{if(typeof array.length==="number"){for(var i=0,l=array.length;i<l;i++){ret.push(array[i]);}}else{for(var i=0;array[i];i++){ret.push(array[i]);}}}
return ret;};}
var sortOrder;if(document.documentElement.compareDocumentPosition){sortOrder=function(a,b){var ret=a.compareDocumentPosition(b)&4?-1:a===b?0:1;if(ret===0){hasDuplicate=true;}
return ret;};}else if("sourceIndex"in document.documentElement){sortOrder=function(a,b){var ret=a.sourceIndex-b.sourceIndex;if(ret===0){hasDuplicate=true;}
return ret;};}else if(document.createRange){sortOrder=function(a,b){var aRange=a.ownerDocument.createRange(),bRange=b.ownerDocument.createRange();aRange.selectNode(a);aRange.collapse(true);bRange.selectNode(b);bRange.collapse(true);var ret=aRange.compareBoundaryPoints(Range.START_TO_END,bRange);if(ret===0){hasDuplicate=true;}
return ret;};}
(function(){var form=document.createElement("form"),id="script"+(new Date).getTime();form.innerHTML="<input name='"+id+"'/>";var root=document.documentElement;root.insertBefore(form,root.firstChild);if(!!document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[];}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match;};}
root.removeChild(form);})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0){Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++){if(results[i].nodeType===1){tmp.push(results[i]);}}
results=tmp;}
return results;};}
div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#"){Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2);};}})();if(document.querySelectorAll)(function(){var oldSizzle=Sizzle,div=document.createElement("div");div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0){return;}
Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&context.nodeType===9&&!isXML(context)){try{return makeArray(context.querySelectorAll(query),extra);}catch(e){}}
return oldSizzle(query,context,extra,seed);};Sizzle.find=oldSizzle.find;Sizzle.filter=oldSizzle.filter;Sizzle.selectors=oldSizzle.selectors;Sizzle.matches=oldSizzle.matches;})();if(document.getElementsByClassName&&document.documentElement.getElementsByClassName)(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(div.getElementsByClassName("e").length===0)
return;div.lastChild.className="e";if(div.getElementsByClassName("e").length===1)
return;Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML){return context.getElementsByClassName(match[1]);}};})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){var sibDir=dir=="previousSibling"&&!isXML;for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){if(sibDir&&elem.nodeType===1){elem.sizcache=doneName;elem.sizset=i;}
elem=elem[dir];var match=false;while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break;}
if(elem.nodeType===1&&!isXML){elem.sizcache=doneName;elem.sizset=i;}
if(elem.nodeName===cur){match=elem;break;}
elem=elem[dir];}
checkSet[i]=match;}}}
function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){var sibDir=dir=="previousSibling"&&!isXML;for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){if(sibDir&&elem.nodeType===1){elem.sizcache=doneName;elem.sizset=i;}
elem=elem[dir];var match=false;while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break;}
if(elem.nodeType===1){if(!isXML){elem.sizcache=doneName;elem.sizset=i;}
if(typeof cur!=="string"){if(elem===cur){match=true;break;}}else if(Sizzle.filter(cur,[elem]).length>0){match=elem;break;}}
elem=elem[dir];}
checkSet[i]=match;}}}
var contains=document.compareDocumentPosition?function(a,b){return a.compareDocumentPosition(b)&16;}:function(a,b){return a!==b&&(a.contains?a.contains(b):true);};var isXML=function(elem){return elem.nodeType===9&&elem.documentElement.nodeName!=="HTML"||!!elem.ownerDocument&&isXML(elem.ownerDocument);};var posProcess=function(selector,context){var tmpSet=[],later="",match,root=context.nodeType?[context]:context;while((match=Expr.match.PSEUDO.exec(selector))){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"");}
selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++){Sizzle(selector,root[i],tmpSet);}
return Sizzle.filter(later,tmpSet);};jQuery.find=Sizzle;jQuery.filter=Sizzle.filter;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.filters;Sizzle.selectors.filters.hidden=function(elem){return elem.offsetWidth===0||elem.offsetHeight===0;};Sizzle.selectors.filters.visible=function(elem){return elem.offsetWidth>0||elem.offsetHeight>0;};Sizzle.selectors.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem;}).length;};jQuery.multiFilter=function(expr,elems,not){if(not){expr=":not("+expr+")";}
return Sizzle.matches(expr,elems);};jQuery.dir=function(elem,dir){var matched=[],cur=elem[dir];while(cur&&cur!=document){if(cur.nodeType==1)
matched.push(cur);cur=cur[dir];}
return matched;};jQuery.nth=function(cur,result,dir,elem){result=result||1;var num=0;for(;cur;cur=cur[dir])
if(cur.nodeType==1&&++num==result)
break;return cur;};jQuery.sibling=function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType==1&&n!=elem)
r.push(n);}
return r;};return;window.Sizzle=Sizzle;})();jQuery.event={add:function(elem,types,handler,data){if(elem.nodeType==3||elem.nodeType==8)
return;if(elem.setInterval&&elem!=window)
elem=window;if(!handler.guid)
handler.guid=this.guid++;if(data!==undefined){var fn=handler;handler=this.proxy(fn);handler.data=data;}
var events=jQuery.data(elem,"events")||jQuery.data(elem,"events",{}),handle=jQuery.data(elem,"handle")||jQuery.data(elem,"handle",function(){return typeof jQuery!=="undefined"&&!jQuery.event.triggered?jQuery.event.handle.apply(arguments.callee.elem,arguments):undefined;});handle.elem=elem;jQuery.each(types.split(/\s+/),function(index,type){var namespaces=type.split(".");type=namespaces.shift();handler.type=namespaces.slice().sort().join(".");var handlers=events[type];if(jQuery.event.specialAll[type])
jQuery.event.specialAll[type].setup.call(elem,data,namespaces);if(!handlers){handlers=events[type]={};if(!jQuery.event.special[type]||jQuery.event.special[type].setup.call(elem,data,namespaces)===false){if(elem.addEventListener)
elem.addEventListener(type,handle,false);else if(elem.attachEvent)
elem.attachEvent("on"+type,handle);}}
handlers[handler.guid]=handler;jQuery.event.global[type]=true;});elem=null;},guid:1,global:{},remove:function(elem,types,handler){if(elem.nodeType==3||elem.nodeType==8)
return;var events=jQuery.data(elem,"events"),ret,index;if(events){if(types===undefined||(typeof types==="string"&&types.charAt(0)=="."))
for(var type in events)
this.remove(elem,type+(types||""));else{if(types.type){handler=types.handler;types=types.type;}
jQuery.each(types.split(/\s+/),function(index,type){var namespaces=type.split(".");type=namespaces.shift();var namespace=RegExp("(^|\\.)"+namespaces.slice().sort().join(".*\\.")+"(\\.|$)");if(events[type]){if(handler)
delete events[type][handler.guid];else
for(var handle in events[type])
if(namespace.test(events[type][handle].type))
delete events[type][handle];if(jQuery.event.specialAll[type])
jQuery.event.specialAll[type].teardown.call(elem,namespaces);for(ret in events[type])break;if(!ret){if(!jQuery.event.special[type]||jQuery.event.special[type].teardown.call(elem,namespaces)===false){if(elem.removeEventListener)
elem.removeEventListener(type,jQuery.data(elem,"handle"),false);else if(elem.detachEvent)
elem.detachEvent("on"+type,jQuery.data(elem,"handle"));}
ret=null;delete events[type];}}});}
for(ret in events)break;if(!ret){var handle=jQuery.data(elem,"handle");if(handle)handle.elem=null;jQuery.removeData(elem,"events");jQuery.removeData(elem,"handle");}}},trigger:function(event,data,elem,bubbling){var type=event.type||event;if(!bubbling){event=typeof event==="object"?event[expando]?event:jQuery.extend(jQuery.Event(type),event):jQuery.Event(type);if(type.indexOf("!")>=0){event.type=type=type.slice(0,-1);event.exclusive=true;}
if(!elem){event.stopPropagation();if(this.global[type])
jQuery.each(jQuery.cache,function(){if(this.events&&this.events[type])
jQuery.event.trigger(event,data,this.handle.elem);});}
if(!elem||elem.nodeType==3||elem.nodeType==8)
return undefined;event.result=undefined;event.target=elem;data=jQuery.makeArray(data);data.unshift(event);}
event.currentTarget=elem;var handle=jQuery.data(elem,"handle");if(handle)
handle.apply(elem,data);if((!elem[type]||(jQuery.nodeName(elem,'a')&&type=="click"))&&elem["on"+type]&&elem["on"+type].apply(elem,data)===false)
event.result=false;if(!bubbling&&elem[type]&&!event.isDefaultPrevented()&&!(jQuery.nodeName(elem,'a')&&type=="click")){this.triggered=true;try{elem[type]();}catch(e){}}
this.triggered=false;if(!event.isPropagationStopped()){var parent=elem.parentNode||elem.ownerDocument;if(parent)
jQuery.event.trigger(event,data,parent,true);}},handle:function(event){var all,handlers;event=arguments[0]=jQuery.event.fix(event||window.event);event.currentTarget=this;var namespaces=event.type.split(".");event.type=namespaces.shift();all=!namespaces.length&&!event.exclusive;var namespace=RegExp("(^|\\.)"+namespaces.slice().sort().join(".*\\.")+"(\\.|$)");handlers=(jQuery.data(this,"events")||{})[event.type];for(var j in handlers){var handler=handlers[j];if(all||namespace.test(handler.type)){event.handler=handler;event.data=handler.data;var ret=handler.apply(this,arguments);if(ret!==undefined){event.result=ret;if(ret===false){event.preventDefault();event.stopPropagation();}}
if(event.isImmediatePropagationStopped())
break;}}},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(event){if(event[expando])
return event;var originalEvent=event;event=jQuery.Event(originalEvent);for(var i=this.props.length,prop;i;){prop=this.props[--i];event[prop]=originalEvent[prop];}
if(!event.target)
event.target=event.srcElement||document;if(event.target.nodeType==3)
event.target=event.target.parentNode;if(!event.relatedTarget&&event.fromElement)
event.relatedTarget=event.fromElement==event.target?event.toElement:event.fromElement;if(event.pageX==null&&event.clientX!=null){var doc=document.documentElement,body=document.body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc.clientLeft||0);event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc.clientTop||0);}
if(!event.which&&((event.charCode||event.charCode===0)?event.charCode:event.keyCode))
event.which=event.charCode||event.keyCode;if(!event.metaKey&&event.ctrlKey)
event.metaKey=event.ctrlKey;if(!event.which&&event.button)
event.which=(event.button&1?1:(event.button&2?3:(event.button&4?2:0)));return event;},proxy:function(fn,proxy){proxy=proxy||function(){return fn.apply(this,arguments);};proxy.guid=fn.guid=fn.guid||proxy.guid||this.guid++;return proxy;},special:{ready:{setup:bindReady,teardown:function(){}}},specialAll:{live:{setup:function(selector,namespaces){jQuery.event.add(this,namespaces[0],liveHandler);},teardown:function(namespaces){if(namespaces.length){var remove=0,name=RegExp("(^|\\.)"+namespaces[0]+"(\\.|$)");jQuery.each((jQuery.data(this,"events").live||{}),function(){if(name.test(this.type))
remove++;});if(remove<1)
jQuery.event.remove(this,namespaces[0],liveHandler);}}}}};jQuery.Event=function(src){if(!this.preventDefault)
return new jQuery.Event(src);if(src&&src.type){this.originalEvent=src;this.type=src.type;}else
this.type=src;this.timeStamp=now();this[expando]=true;};function returnFalse(){return false;}
function returnTrue(){return true;}
jQuery.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e)
return;if(e.preventDefault)
e.preventDefault();e.returnValue=false;},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e)
return;if(e.stopPropagation)
e.stopPropagation();e.cancelBubble=true;},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation();},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};var withinElement=function(event){var parent=event.relatedTarget;while(parent&&parent!=this)
try{parent=parent.parentNode;}
catch(e){parent=this;}
if(parent!=this){event.type=event.data;jQuery.event.handle.apply(this,arguments);}};jQuery.each({mouseover:'mouseenter',mouseout:'mouseleave'},function(orig,fix){jQuery.event.special[fix]={setup:function(){jQuery.event.add(this,orig,withinElement,fix);},teardown:function(){jQuery.event.remove(this,orig,withinElement);}};});jQuery.fn.extend({bind:function(type,data,fn){return type=="unload"?this.one(type,data,fn):this.each(function(){jQuery.event.add(this,type,fn||data,fn&&data);});},one:function(type,data,fn){var one=jQuery.event.proxy(fn||data,function(event){jQuery(this).unbind(event,one);return(fn||data).apply(this,arguments);});return this.each(function(){jQuery.event.add(this,type,one,fn&&data);});},unbind:function(type,fn){return this.each(function(){jQuery.event.remove(this,type,fn);});},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this);});},triggerHandler:function(type,data){if(this[0]){var event=jQuery.Event(type);event.preventDefault();event.stopPropagation();jQuery.event.trigger(event,data,this[0]);return event.result;}},toggle:function(fn){var args=arguments,i=1;while(i<args.length)
jQuery.event.proxy(fn,args[i++]);return this.click(jQuery.event.proxy(fn,function(event){this.lastToggle=(this.lastToggle||0)%i;event.preventDefault();return args[this.lastToggle++].apply(this,arguments)||false;}));},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut);},ready:function(fn){bindReady();if(jQuery.isReady)
fn.call(document,jQuery);else
jQuery.readyList.push(fn);return this;},live:function(type,fn){var proxy=jQuery.event.proxy(fn);proxy.guid+=this.selector+type;jQuery(document).bind(liveConvert(type,this.selector),this.selector,proxy);return this;},die:function(type,fn){jQuery(document).unbind(liveConvert(type,this.selector),fn?{guid:fn.guid+this.selector+type}:null);return this;}});function liveHandler(event){var check=RegExp("(^|\\.)"+event.type+"(\\.|$)"),stop=true,elems=[];jQuery.each(jQuery.data(this,"events").live||[],function(i,fn){if(check.test(fn.type)){var elem=jQuery(event.target).closest(fn.data)[0];if(elem)
elems.push({elem:elem,fn:fn});}});elems.sort(function(a,b){return jQuery.data(a.elem,"closest")-jQuery.data(b.elem,"closest");});jQuery.each(elems,function(){if(this.fn.call(this.elem,event,this.fn.data)===false)
return(stop=false);});return stop;}
function liveConvert(type,selector){return["live",type,selector.replace(/\./g,"`").replace(/ /g,"|")].join(".");}
jQuery.extend({isReady:false,readyList:[],ready:function(){if(!jQuery.isReady){jQuery.isReady=true;if(jQuery.readyList){jQuery.each(jQuery.readyList,function(){this.call(document,jQuery);});jQuery.readyList=null;}
jQuery(document).triggerHandler("ready");}}});var readyBound=false;function bindReady(){if(readyBound)return;readyBound=true;if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);jQuery.ready();},false);}else if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);jQuery.ready();}});if(document.documentElement.doScroll&&window==window.top)(function(){if(jQuery.isReady)return;try{document.documentElement.doScroll("left");}catch(error){setTimeout(arguments.callee,0);return;}
jQuery.ready();})();}
jQuery.event.add(window,"load",jQuery.ready);}
jQuery.each(("blur,focus,load,resize,scroll,unload,click,dblclick,"+"mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,"+"change,select,submit,keydown,keypress,keyup,error").split(","),function(i,name){jQuery.fn[name]=function(fn){return fn?this.bind(name,fn):this.trigger(name);};});jQuery(window).bind('unload',function(){for(var id in jQuery.cache)
if(id!=1&&jQuery.cache[id].handle)
jQuery.event.remove(jQuery.cache[id].handle.elem);});(function(){jQuery.support={};var root=document.documentElement,script=document.createElement("script"),div=document.createElement("div"),id="script"+(new Date).getTime();div.style.display="none";div.innerHTML='   <link/><table></table><a href="/a" style="color:red;float:left;opacity:.5;">a</a><select><option>text</option></select><object><param/></object>';var all=div.getElementsByTagName("*"),a=div.getElementsByTagName("a")[0];if(!all||!all.length||!a){return;}
jQuery.support={leadingWhitespace:div.firstChild.nodeType==3,tbody:!div.getElementsByTagName("tbody").length,objectAll:!!div.getElementsByTagName("object")[0].getElementsByTagName("*").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/red/.test(a.getAttribute("style")),hrefNormalized:a.getAttribute("href")==="/a",opacity:a.style.opacity==="0.5",cssFloat:!!a.style.cssFloat,scriptEval:false,noCloneEvent:true,boxModel:null};script.type="text/javascript";try{script.appendChild(document.createTextNode("window."+id+"=1;"));}catch(e){}
root.insertBefore(script,root.firstChild);if(window[id]){jQuery.support.scriptEval=true;delete window[id];}
root.removeChild(script);if(div.attachEvent&&div.fireEvent){div.attachEvent("onclick",function(){jQuery.support.noCloneEvent=false;div.detachEvent("onclick",arguments.callee);});div.cloneNode(true).fireEvent("onclick");}
jQuery(function(){var div=document.createElement("div");div.style.width=div.style.paddingLeft="1px";document.body.appendChild(div);jQuery.boxModel=jQuery.support.boxModel=div.offsetWidth===2;document.body.removeChild(div).style.display='none';});})();var styleFloat=jQuery.support.cssFloat?"cssFloat":"styleFloat";jQuery.props={"for":"htmlFor","class":"className","float":styleFloat,cssFloat:styleFloat,styleFloat:styleFloat,readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",tabindex:"tabIndex"};jQuery.fn.extend({_load:jQuery.fn.load,load:function(url,params,callback){if(typeof url!=="string")
return this._load(url);var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off);}
var type="GET";if(params)
if(jQuery.isFunction(params)){callback=params;params=null;}else if(typeof params==="object"){params=jQuery.param(params);type="POST";}
var self=this;jQuery.ajax({url:url,type:type,dataType:"html",data:params,complete:function(res,status){if(status=="success"||status=="notmodified")
self.html(selector?jQuery("<div/>").append(res.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(selector):res.responseText);if(callback)
self.each(callback,[res.responseText,status,res]);}});return this;},serialize:function(){return jQuery.param(this.serializeArray());},serializeArray:function(){return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this;}).filter(function(){return this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/text|hidden|password|search/i.test(this.type));}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val,i){return{name:elem.name,value:val};}):{name:elem.name,value:val};}).get();}});jQuery.each("ajaxStart,ajaxStop,ajaxComplete,ajaxError,ajaxSuccess,ajaxSend".split(","),function(i,o){jQuery.fn[o]=function(f){return this.bind(o,f);};});var jsc=now();jQuery.extend({get:function(url,data,callback,type){if(jQuery.isFunction(data)){callback=data;data=null;}
return jQuery.ajax({type:"GET",url:url,data:data,success:callback,dataType:type});},getScript:function(url,callback){return jQuery.get(url,null,callback,"script");},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json");},post:function(url,data,callback,type){if(jQuery.isFunction(data)){callback=data;data={};}
return jQuery.ajax({type:"POST",url:url,data:data,success:callback,dataType:type});},ajaxSetup:function(settings){jQuery.extend(jQuery.ajaxSettings,settings);},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:function(){return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest();},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},ajax:function(s){s=jQuery.extend(true,s,jQuery.extend(true,{},jQuery.ajaxSettings,s));var jsonp,jsre=/=\?(&|$)/g,status,data,type=s.type.toUpperCase();if(s.data&&s.processData&&typeof s.data!=="string")
s.data=jQuery.param(s.data);if(s.dataType=="jsonp"){if(type=="GET"){if(!s.url.match(jsre))
s.url+=(s.url.match(/\?/)?"&":"?")+(s.jsonp||"callback")+"=?";}else if(!s.data||!s.data.match(jsre))
s.data=(s.data?s.data+"&":"")+(s.jsonp||"callback")+"=?";s.dataType="json";}
if(s.dataType=="json"&&(s.data&&s.data.match(jsre)||s.url.match(jsre))){jsonp="jsonp"+jsc++;if(s.data)
s.data=(s.data+"").replace(jsre,"="+jsonp+"$1");s.url=s.url.replace(jsre,"="+jsonp+"$1");s.dataType="script";window[jsonp]=function(tmp){data=tmp;success();complete();window[jsonp]=undefined;try{delete window[jsonp];}catch(e){}
if(head)
head.removeChild(script);};}
if(s.dataType=="script"&&s.cache==null)
s.cache=false;if(s.cache===false&&type=="GET"){var ts=now();var ret=s.url.replace(/(\?|&)_=.*?(&|$)/,"$1_="+ts+"$2");s.url=ret+((ret==s.url)?(s.url.match(/\?/)?"&":"?")+"_="+ts:"");}
if(s.data&&type=="GET"){s.url+=(s.url.match(/\?/)?"&":"?")+s.data;s.data=null;}
if(s.global&&!jQuery.active++)
jQuery.event.trigger("ajaxStart");var parts=/^(\w+:)?\/\/([^\/?#]+)/.exec(s.url);if(s.dataType=="script"&&type=="GET"&&parts&&(parts[1]&&parts[1]!=location.protocol||parts[2]!=location.host)){var head=document.getElementsByTagName("head")[0];var script=document.createElement("script");script.src=s.url;if(s.scriptCharset)
script.charset=s.scriptCharset;if(!jsonp){var done=false;script.onload=script.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")){done=true;success();complete();script.onload=script.onreadystatechange=null;head.removeChild(script);}};}
head.appendChild(script);return undefined;}
var requestDone=false;var xhr=s.xhr();if(s.username)
xhr.open(type,s.url,s.async,s.username,s.password);else
xhr.open(type,s.url,s.async);try{if(s.data)
xhr.setRequestHeader("Content-Type",s.contentType);if(s.ifModified)
xhr.setRequestHeader("If-Modified-Since",jQuery.lastModified[s.url]||"Thu, 01 Jan 1970 00:00:00 GMT");xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.setRequestHeader("Accept",s.dataType&&s.accepts[s.dataType]?s.accepts[s.dataType]+", */*":s.accepts._default);}catch(e){}
if(s.beforeSend&&s.beforeSend(xhr,s)===false){if(s.global&&!--jQuery.active)
jQuery.event.trigger("ajaxStop");xhr.abort();return false;}
if(s.global)
jQuery.event.trigger("ajaxSend",[xhr,s]);var onreadystatechange=function(isTimeout){if(xhr.readyState==0){if(ival){clearInterval(ival);ival=null;if(s.global&&!--jQuery.active)
jQuery.event.trigger("ajaxStop");}}else if(!requestDone&&xhr&&(xhr.readyState==4||isTimeout=="timeout")){requestDone=true;if(ival){clearInterval(ival);ival=null;}
status=isTimeout=="timeout"?"timeout":!jQuery.httpSuccess(xhr)?"error":s.ifModified&&jQuery.httpNotModified(xhr,s.url)?"notmodified":"success";if(status=="success"){try{data=jQuery.httpData(xhr,s.dataType,s);}catch(e){status="parsererror";}}
if(status=="success"){var modRes;try{modRes=xhr.getResponseHeader("Last-Modified");}catch(e){}
if(s.ifModified&&modRes)
jQuery.lastModified[s.url]=modRes;if(!jsonp)
success();}else
jQuery.handleError(s,xhr,status);complete();if(isTimeout)
xhr.abort();if(s.async)
xhr=null;}};if(s.async){var ival=setInterval(onreadystatechange,13);if(s.timeout>0)
setTimeout(function(){if(xhr&&!requestDone)
onreadystatechange("timeout");},s.timeout);}
try{xhr.send(s.data);}catch(e){jQuery.handleError(s,xhr,null,e);}
if(!s.async)
onreadystatechange();function success(){if(s.success)
s.success(data,status);if(s.global)
jQuery.event.trigger("ajaxSuccess",[xhr,s]);}
function complete(){if(s.complete)
s.complete(xhr,status);if(s.global)
jQuery.event.trigger("ajaxComplete",[xhr,s]);if(s.global&&!--jQuery.active)
jQuery.event.trigger("ajaxStop");}
return xhr;},handleError:function(s,xhr,status,e){if(s.error)s.error(xhr,status,e);if(s.global)
jQuery.event.trigger("ajaxError",[xhr,s,e]);},active:0,httpSuccess:function(xhr){try{return!xhr.status&&location.protocol=="file:"||(xhr.status>=200&&xhr.status<300)||xhr.status==304||xhr.status==1223;}catch(e){}
return false;},httpNotModified:function(xhr,url){try{var xhrRes=xhr.getResponseHeader("Last-Modified");return xhr.status==304||xhrRes==jQuery.lastModified[url];}catch(e){}
return false;},httpData:function(xhr,type,s){var ct=xhr.getResponseHeader("content-type"),xml=type=="xml"||!type&&ct&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.tagName=="parsererror")
throw"parsererror";if(s&&s.dataFilter)
data=s.dataFilter(data,type);if(typeof data==="string"){if(type=="script")
jQuery.globalEval(data);if(type=="json")
data=window["eval"]("("+data+")");}
return data;},param:function(a){var s=[];function add(key,value){s[s.length]=encodeURIComponent(key)+'='+encodeURIComponent(value);};if(jQuery.isArray(a)||a.jquery)
jQuery.each(a,function(){add(this.name,this.value);});else
for(var j in a)
if(jQuery.isArray(a[j]))
jQuery.each(a[j],function(){add(j,this);});else
add(j,jQuery.isFunction(a[j])?a[j]():a[j]);return s.join("&").replace(/%20/g,"+");}});var elemdisplay={},timerId,fxAttrs=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];function genFx(type,num){var obj={};jQuery.each(fxAttrs.concat.apply([],fxAttrs.slice(0,num)),function(){obj[this]=type;});return obj;}
jQuery.fn.extend({show:function(speed,callback){if(speed){return this.animate(genFx("show",3),speed,callback);}else{for(var i=0,l=this.length;i<l;i++){var old=jQuery.data(this[i],"olddisplay");this[i].style.display=old||"";if(jQuery.css(this[i],"display")==="none"){var tagName=this[i].tagName,display;if(elemdisplay[tagName]){display=elemdisplay[tagName];}else{var elem=jQuery("<"+tagName+" />").appendTo("body");display=elem.css("display");if(display==="none")
display="block";elem.remove();elemdisplay[tagName]=display;}
jQuery.data(this[i],"olddisplay",display);}}
for(var i=0,l=this.length;i<l;i++){this[i].style.display=jQuery.data(this[i],"olddisplay")||"";}
return this;}},hide:function(speed,callback){if(speed){return this.animate(genFx("hide",3),speed,callback);}else{for(var i=0,l=this.length;i<l;i++){var old=jQuery.data(this[i],"olddisplay");if(!old&&old!=="none")
jQuery.data(this[i],"olddisplay",jQuery.css(this[i],"display"));}
for(var i=0,l=this.length;i<l;i++){this[i].style.display="none";}
return this;}},_toggle:jQuery.fn.toggle,toggle:function(fn,fn2){var bool=typeof fn==="boolean";return jQuery.isFunction(fn)&&jQuery.isFunction(fn2)?this._toggle.apply(this,arguments):fn==null||bool?this.each(function(){var state=bool?fn:jQuery(this).is(":hidden");jQuery(this)[state?"show":"hide"]();}):this.animate(genFx("toggle",3),fn,fn2);},fadeTo:function(speed,to,callback){return this.animate({opacity:to},speed,callback);},animate:function(prop,speed,easing,callback){var optall=jQuery.speed(speed,easing,callback);return this[optall.queue===false?"each":"queue"](function(){var opt=jQuery.extend({},optall),p,hidden=this.nodeType==1&&jQuery(this).is(":hidden"),self=this;for(p in prop){if(prop[p]=="hide"&&hidden||prop[p]=="show"&&!hidden)
return opt.complete.call(this);if((p=="height"||p=="width")&&this.style){opt.display=jQuery.css(this,"display");opt.overflow=this.style.overflow;}}
if(opt.overflow!=null)
this.style.overflow="hidden";opt.curAnim=jQuery.extend({},prop);jQuery.each(prop,function(name,val){var e=new jQuery.fx(self,opt,name);if(/toggle|show|hide/.test(val))
e[val=="toggle"?hidden?"show":"hide":val](prop);else{var parts=val.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/),start=e.cur(true)||0;if(parts){var end=parseFloat(parts[2]),unit=parts[3]||"px";if(unit!="px"){self.style[name]=(end||1)+unit;start=((end||1)/e.cur(true))*start;self.style[name]=start+unit;}
if(parts[1])
end=((parts[1]=="-="?-1:1)*end)+start;e.custom(start,end,unit);}else
e.custom(start,val,"");}});return true;});},stop:function(clearQueue,gotoEnd){var timers=jQuery.timers;if(clearQueue)
this.queue([]);this.each(function(){for(var i=timers.length-1;i>=0;i--)
if(timers[i].elem==this){if(gotoEnd)
timers[i](true);timers.splice(i,1);}});if(!gotoEnd)
this.dequeue();return this;}});jQuery.each({slideDown:genFx("show",1),slideUp:genFx("hide",1),slideToggle:genFx("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(name,props){jQuery.fn[name]=function(speed,callback){return this.animate(props,speed,callback);};});jQuery.extend({speed:function(speed,easing,fn){var opt=typeof speed==="object"?speed:{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:jQuery.fx.speeds[opt.duration]||jQuery.fx.speeds._default;opt.old=opt.complete;opt.complete=function(){if(opt.queue!==false)
jQuery(this).dequeue();if(jQuery.isFunction(opt.old))
opt.old.call(this);};return opt;},easing:{linear:function(p,n,firstNum,diff){return firstNum+diff*p;},swing:function(p,n,firstNum,diff){return((-Math.cos(p*Math.PI)/2)+0.5)*diff+firstNum;}},timers:[],fx:function(elem,options,prop){this.options=options;this.elem=elem;this.prop=prop;if(!options.orig)
options.orig={};}});jQuery.fx.prototype={update:function(){if(this.options.step)
this.options.step.call(this.elem,this.now,this);(jQuery.fx.step[this.prop]||jQuery.fx.step._default)(this);if((this.prop=="height"||this.prop=="width")&&this.elem.style)
this.elem.style.display="block";},cur:function(force){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))
return this.elem[this.prop];var r=parseFloat(jQuery.css(this.elem,this.prop,force));return r&&r>-10000?r:parseFloat(jQuery.curCSS(this.elem,this.prop))||0;},custom:function(from,to,unit){this.startTime=now();this.start=from;this.end=to;this.unit=unit||this.unit||"px";this.now=this.start;this.pos=this.state=0;var self=this;function t(gotoEnd){return self.step(gotoEnd);}
t.elem=this.elem;if(t()&&jQuery.timers.push(t)&&!timerId){timerId=setInterval(function(){var timers=jQuery.timers;for(var i=0;i<timers.length;i++)
if(!timers[i]())
timers.splice(i--,1);if(!timers.length){clearInterval(timerId);timerId=undefined;}},13);}},show:function(){this.options.orig[this.prop]=jQuery.attr(this.elem.style,this.prop);this.options.show=true;this.custom(this.prop=="width"||this.prop=="height"?1:0,this.cur());jQuery(this.elem).show();},hide:function(){this.options.orig[this.prop]=jQuery.attr(this.elem.style,this.prop);this.options.hide=true;this.custom(this.cur(),0);},step:function(gotoEnd){var t=now();if(gotoEnd||t>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;var done=true;for(var i in this.options.curAnim)
if(this.options.curAnim[i]!==true)
done=false;if(done){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;this.elem.style.display=this.options.display;if(jQuery.css(this.elem,"display")=="none")
this.elem.style.display="block";}
if(this.options.hide)
jQuery(this.elem).hide();if(this.options.hide||this.options.show)
for(var p in this.options.curAnim)
jQuery.attr(this.elem.style,p,this.options.orig[p]);this.options.complete.call(this.elem);}
return false;}else{var n=t-this.startTime;this.state=n/this.options.duration;this.pos=jQuery.easing[this.options.easing||(jQuery.easing.swing?"swing":"linear")](this.state,n,0,1,this.options.duration);this.now=this.start+((this.end-this.start)*this.pos);this.update();}
return true;}};jQuery.extend(jQuery.fx,{speeds:{slow:600,fast:200,_default:400},step:{opacity:function(fx){jQuery.attr(fx.elem.style,"opacity",fx.now);},_default:function(fx){if(fx.elem.style&&fx.elem.style[fx.prop]!=null)
fx.elem.style[fx.prop]=fx.now+fx.unit;else
fx.elem[fx.prop]=fx.now;}}});if(document.documentElement["getBoundingClientRect"])
jQuery.fn.offset=function(){if(!this[0])return{top:0,left:0};if(this[0]===this[0].ownerDocument.body)return jQuery.offset.bodyOffset(this[0]);var box=this[0].getBoundingClientRect(),doc=this[0].ownerDocument,body=doc.body,docElem=doc.documentElement,clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,top=box.top+(self.pageYOffset||jQuery.boxModel&&docElem.scrollTop||body.scrollTop)-clientTop,left=box.left+(self.pageXOffset||jQuery.boxModel&&docElem.scrollLeft||body.scrollLeft)-clientLeft;return{top:top,left:left};};else
jQuery.fn.offset=function(){if(!this[0])return{top:0,left:0};if(this[0]===this[0].ownerDocument.body)return jQuery.offset.bodyOffset(this[0]);jQuery.offset.initialized||jQuery.offset.initialize();var elem=this[0],offsetParent=elem.offsetParent,prevOffsetParent=elem,doc=elem.ownerDocument,computedStyle,docElem=doc.documentElement,body=doc.body,defaultView=doc.defaultView,prevComputedStyle=defaultView.getComputedStyle(elem,null),top=elem.offsetTop,left=elem.offsetLeft;while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){computedStyle=defaultView.getComputedStyle(elem,null);top-=elem.scrollTop,left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop,left+=elem.offsetLeft;if(jQuery.offset.doesNotAddBorder&&!(jQuery.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(elem.tagName)))
top+=parseInt(computedStyle.borderTopWidth,10)||0,left+=parseInt(computedStyle.borderLeftWidth,10)||0;prevOffsetParent=offsetParent,offsetParent=elem.offsetParent;}
if(jQuery.offset.subtractsBorderForOverflowNotVisible&&computedStyle.overflow!=="visible")
top+=parseInt(computedStyle.borderTopWidth,10)||0,left+=parseInt(computedStyle.borderLeftWidth,10)||0;prevComputedStyle=computedStyle;}
if(prevComputedStyle.position==="relative"||prevComputedStyle.position==="static")
top+=body.offsetTop,left+=body.offsetLeft;if(prevComputedStyle.position==="fixed")
top+=Math.max(docElem.scrollTop,body.scrollTop),left+=Math.max(docElem.scrollLeft,body.scrollLeft);return{top:top,left:left};};jQuery.offset={initialize:function(){if(this.initialized)return;var body=document.body,container=document.createElement('div'),innerDiv,checkDiv,table,td,rules,prop,bodyMarginTop=body.style.marginTop,html='<div style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;"><div></div></div><table style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;" cellpadding="0" cellspacing="0"><tr><td></td></tr></table>';rules={position:'absolute',top:0,left:0,margin:0,border:0,width:'1px',height:'1px',visibility:'hidden'};for(prop in rules)container.style[prop]=rules[prop];container.innerHTML=html;body.insertBefore(container,body.firstChild);innerDiv=container.firstChild,checkDiv=innerDiv.firstChild,td=innerDiv.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(checkDiv.offsetTop!==5);this.doesAddBorderForTableAndCells=(td.offsetTop===5);innerDiv.style.overflow='hidden',innerDiv.style.position='relative';this.subtractsBorderForOverflowNotVisible=(checkDiv.offsetTop===-5);body.style.marginTop='1px';this.doesNotIncludeMarginInBodyOffset=(body.offsetTop===0);body.style.marginTop=bodyMarginTop;body.removeChild(container);this.initialized=true;},bodyOffset:function(body){jQuery.offset.initialized||jQuery.offset.initialize();var top=body.offsetTop,left=body.offsetLeft;if(jQuery.offset.doesNotIncludeMarginInBodyOffset)
top+=parseInt(jQuery.curCSS(body,'marginTop',true),10)||0,left+=parseInt(jQuery.curCSS(body,'marginLeft',true),10)||0;return{top:top,left:left};}};jQuery.fn.extend({position:function(){var left=0,top=0,results;if(this[0]){var offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=/^body|html$/i.test(offsetParent[0].tagName)?{top:0,left:0}:offsetParent.offset();offset.top-=num(this,'marginTop');offset.left-=num(this,'marginLeft');parentOffset.top+=num(offsetParent,'borderTopWidth');parentOffset.left+=num(offsetParent,'borderLeftWidth');results={top:offset.top-parentOffset.top,left:offset.left-parentOffset.left};}
return results;},offsetParent:function(){var offsetParent=this[0].offsetParent||document.body;while(offsetParent&&(!/^body|html$/i.test(offsetParent.tagName)&&jQuery.css(offsetParent,'position')=='static'))
offsetParent=offsetParent.offsetParent;return jQuery(offsetParent);}});jQuery.each(['Left','Top'],function(i,name){var method='scroll'+name;jQuery.fn[method]=function(val){if(!this[0])return null;return val!==undefined?this.each(function(){this==window||this==document?window.scrollTo(!i?val:jQuery(window).scrollLeft(),i?val:jQuery(window).scrollTop()):this[method]=val;}):this[0]==window||this[0]==document?self[i?'pageYOffset':'pageXOffset']||jQuery.boxModel&&document.documentElement[method]||document.body[method]:this[0][method];};});jQuery.each(["Height","Width"],function(i,name){var tl=i?"Left":"Top",br=i?"Right":"Bottom",lower=name.toLowerCase();jQuery.fn["inner"+name]=function(){return this[0]?jQuery.css(this[0],lower,false,"padding"):null;};jQuery.fn["outer"+name]=function(margin){return this[0]?jQuery.css(this[0],lower,false,margin?"margin":"border"):null;};var type=name.toLowerCase();jQuery.fn[type]=function(size){return this[0]==window?document.compatMode=="CSS1Compat"&&document.documentElement["client"+name]||document.body["client"+name]:this[0]==document?Math.max(document.documentElement["client"+name],document.body["scroll"+name],document.documentElement["scroll"+name],document.body["offset"+name],document.documentElement["offset"+name]):size===undefined?(this.length?jQuery.css(this[0],type):null):this.css(type,typeof size==="string"?size:size+"px");};});})();var $j=jQuery.noConflict();jQuery.httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type"),isXML=type=="xml"||!type&&ct&&ct.indexOf("xml")>=0,isJSON=type=="json",hasXJSON=(xhr.getResponseHeader("X-JSON")!=undefined&&xhr.getResponseHeader("X-JSON")!=''),content=xhr.responseText,data=isXML?xhr.responseXML:(hasXJSON?xhr.getResponseHeader('X-JSON'):(isJSON?content:{}));if(content==data){content='';}
if(isXML&&data.documentElement.tagName=="parsererror")
throw"parsererror";if(s&&s.dataFilter)
data=s.dataFilter(data,type);if(typeof data==="string"){if(type=="json"){data=window["eval"]("("+data+")");}}
if(content.length>0){data.content=content;}
return data;};jQuery.ui||(function(c){var i=c.fn.remove,d=c.browser.mozilla&&(parseFloat(c.browser.version)<1.9);c.ui={version:"1.7.2",plugin:{add:function(k,l,n){var m=c.ui[k].prototype;for(var j in n){m.plugins[j]=m.plugins[j]||[];m.plugins[j].push([l,n[j]])}},call:function(j,l,k){var n=j.plugins[l];if(!n||!j.element[0].parentNode){return}for(var m=0;m<n.length;m++){if(j.options[n[m][0]]){n[m][1].apply(j.element,k)}}}},contains:function(k,j){return document.compareDocumentPosition?k.compareDocumentPosition(j)&16:k!==j&&k.contains(j)},hasScroll:function(m,k){if(c(m).css("overflow")=="hidden"){return false}var j=(k&&k=="left")?"scrollLeft":"scrollTop",l=false;if(m[j]>0){return true}m[j]=1;l=(m[j]>0);m[j]=0;return l},isOverAxis:function(k,j,l){return(k>j)&&(k<(j+l))},isOver:function(o,k,n,m,j,l){return c.ui.isOverAxis(o,n,j)&&c.ui.isOverAxis(k,m,l)},keyCode:{BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38}};if(d){var f=c.attr,e=c.fn.removeAttr,h="http://www.w3.org/2005/07/aaa",a=/^aria-/,b=/^wairole:/;c.attr=function(k,j,l){var m=l!==undefined;return(j=="role"?(m?f.call(this,k,j,"wairole:"+l):(f.apply(this,arguments)||"").replace(b,"")):(a.test(j)?(m?k.setAttributeNS(h,j.replace(a,"aaa:"),l):f.call(this,k,j.replace(a,"aaa:"))):f.apply(this,arguments)))};c.fn.removeAttr=function(j){return(a.test(j)?this.each(function(){this.removeAttributeNS(h,j.replace(a,""))}):e.call(this,j))}}c.fn.extend({remove:function(){c("*",this).add(this).each(function(){c(this).triggerHandler("remove")});return i.apply(this,arguments)},enableSelection:function(){return this.attr("unselectable","off").css("MozUserSelect","").unbind("selectstart.ui")},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return false})},scrollParent:function(){var j;if((c.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){j=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(c.curCSS(this,"position",1))&&(/(auto|scroll)/).test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0)}else{j=this.parents().filter(function(){return(/(auto|scroll)/).test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!j.length?c(document):j}});c.extend(c.expr[":"],{data:function(l,k,j){return!!c.data(l,j[3])},focusable:function(k){var l=k.nodeName.toLowerCase(),j=c.attr(k,"tabindex");return(/input|select|textarea|button|object/.test(l)?!k.disabled:"a"==l||"area"==l?k.href||!isNaN(j):!isNaN(j))&&!c(k)["area"==l?"parents":"closest"](":hidden").length},tabbable:function(k){var j=c.attr(k,"tabindex");return(isNaN(j)||j>=0)&&c(k).is(":focusable")}});function g(m,n,o,l){function k(q){var p=c[m][n][q]||[];return(typeof p=="string"?p.split(/,?\s+/):p)}var j=k("getter");if(l.length==1&&typeof l[0]=="string"){j=j.concat(k("getterSetter"))}return(c.inArray(o,j)!=-1)}c.widget=function(k,j){var l=k.split(".")[0];k=k.split(".")[1];c.fn[k]=function(p){var n=(typeof p=="string"),o=Array.prototype.slice.call(arguments,1);if(n&&p.substring(0,1)=="_"){return this}if(n&&g(l,k,p,o)){var m=c.data(this[0],k);return(m?m[p].apply(m,o):undefined)}return this.each(function(){var q=c.data(this,k);(!q&&!n&&c.data(this,k,new c[l][k](this,p))._init());(q&&n&&c.isFunction(q[p])&&q[p].apply(q,o))})};c[l]=c[l]||{};c[l][k]=function(o,n){var m=this;this.namespace=l;this.widgetName=k;this.widgetEventPrefix=c[l][k].eventPrefix||k;this.widgetBaseClass=l+"-"+k;this.options=c.extend({},c.widget.defaults,c[l][k].defaults,c.metadata&&c.metadata.get(o)[k],n);this.element=c(o).bind("setData."+k,function(q,p,r){if(q.target==o){return m._setData(p,r)}}).bind("getData."+k,function(q,p){if(q.target==o){return m._getData(p)}}).bind("remove",function(){return m.destroy()})};c[l][k].prototype=c.extend({},c.widget.prototype,j);c[l][k].getterSetter="option"};c.widget.prototype={_init:function(){},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").removeAttr("aria-disabled")},option:function(l,m){var k=l,j=this;if(typeof l=="string"){if(m===undefined){return this._getData(l)}k={};k[l]=m}c.each(k,function(n,o){j._setData(n,o)})},_getData:function(j){return this.options[j]},_setData:function(j,k){this.options[j]=k;if(j=="disabled"){this.element[k?"addClass":"removeClass"](this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",k)}},enable:function(){this._setData("disabled",false)},disable:function(){this._setData("disabled",true)},_trigger:function(l,m,n){var p=this.options[l],j=(l==this.widgetEventPrefix?l:this.widgetEventPrefix+l);m=c.Event(m);m.type=j;if(m.originalEvent){for(var k=c.event.props.length,o;k;){o=c.event.props[--k];m[o]=m.originalEvent[o]}}this.element.trigger(m,n);return!(c.isFunction(p)&&p.call(this.element[0],m,n)===false||m.isDefaultPrevented())}};c.widget.defaults={disabled:false};c.ui.mouse={_mouseInit:function(){var j=this;this.element.bind("mousedown."+this.widgetName,function(k){return j._mouseDown(k)}).bind("click."+this.widgetName,function(k){if(j._preventClickEvent){j._preventClickEvent=false;k.stopImmediatePropagation();return false}});if(c.browser.msie){this._mouseUnselectable=this.element.attr("unselectable");this.element.attr("unselectable","on")}this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);(c.browser.msie&&this.element.attr("unselectable",this._mouseUnselectable))},_mouseDown:function(l){l.originalEvent=l.originalEvent||{};if(l.originalEvent.mouseHandled){return}(this._mouseStarted&&this._mouseUp(l));this._mouseDownEvent=l;var k=this,m=(l.which==1),j=(typeof this.options.cancel=="string"?c(l.target).parents().add(l.target).filter(this.options.cancel).length:false);if(!m||j||!this._mouseCapture(l)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){k.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(l)&&this._mouseDelayMet(l)){this._mouseStarted=(this._mouseStart(l)!==false);if(!this._mouseStarted){l.preventDefault();return true}}this._mouseMoveDelegate=function(n){return k._mouseMove(n)};this._mouseUpDelegate=function(n){return k._mouseUp(n)};c(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);(c.browser.safari||l.preventDefault());l.originalEvent.mouseHandled=true;return true},_mouseMove:function(j){if(c.browser.msie&&!j.button){return this._mouseUp(j)}if(this._mouseStarted){this._mouseDrag(j);return j.preventDefault()}if(this._mouseDistanceMet(j)&&this._mouseDelayMet(j)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,j)!==false);(this._mouseStarted?this._mouseDrag(j):this._mouseUp(j))}return!this._mouseStarted},_mouseUp:function(j){c(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;this._preventClickEvent=(j.target==this._mouseDownEvent.target);this._mouseStop(j)}return false},_mouseDistanceMet:function(j){return(Math.max(Math.abs(this._mouseDownEvent.pageX-j.pageX),Math.abs(this._mouseDownEvent.pageY-j.pageY))>=this.options.distance)},_mouseDelayMet:function(j){return this.mouseDelayMet},_mouseStart:function(j){},_mouseDrag:function(j){},_mouseStop:function(j){},_mouseCapture:function(j){return true}};c.ui.mouse.defaults={cancel:null,distance:1,delay:0}})(jQuery);;(function(a){a.widget("ui.accordion",{_init:function(){var d=this.options,b=this;this.running=0;if(d.collapsible==a.ui.accordion.defaults.collapsible&&d.alwaysOpen!=a.ui.accordion.defaults.alwaysOpen){d.collapsible=!d.alwaysOpen}if(d.navigation){var c=this.element.find("a").filter(d.navigationFilter);if(c.length){if(c.filter(d.header).length){this.active=c}else{this.active=c.parent().parent().prev();c.addClass("ui-accordion-content-active")}}}this.element.addClass("ui-accordion ui-widget ui-helper-reset");if(this.element[0].nodeName=="UL"){this.element.children("li").addClass("ui-accordion-li-fix")}this.headers=this.element.find(d.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){a(this).removeClass("ui-state-focus")});this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");this.active=this._findActive(this.active||d.active).toggleClass("ui-state-default").toggleClass("ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");this.active.next().addClass("ui-accordion-content-active");a("<span/>").addClass("ui-icon "+d.icons.header).prependTo(this.headers);this.active.find(".ui-icon").toggleClass(d.icons.header).toggleClass(d.icons.headerSelected);if(a.browser.msie){this.element.find("a").css("zoom","1")}this.resize();this.element.attr("role","tablist");this.headers.attr("role","tab").bind("keydown",function(e){return b._keydown(e)}).next().attr("role","tabpanel");this.headers.not(this.active||"").attr("aria-expanded","false").attr("tabIndex","-1").next().hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex","0")}else{this.active.attr("aria-expanded","true").attr("tabIndex","0")}if(!a.browser.safari){this.headers.find("a").attr("tabIndex","-1")}if(d.event){this.headers.bind((d.event)+".accordion",function(e){return b._clickHandler.call(b,e,this)})}},destroy:function(){var c=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role").unbind(".accordion").removeData("accordion");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("tabindex");this.headers.find("a").removeAttr("tabindex");this.headers.children(".ui-icon").remove();var b=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active");if(c.autoHeight||c.fillHeight){b.css("height","")}},_setData:function(b,c){if(b=="alwaysOpen"){b="collapsible";c=!c}a.widget.prototype._setData.apply(this,arguments)},_keydown:function(e){var g=this.options,f=a.ui.keyCode;if(g.disabled||e.altKey||e.ctrlKey){return}var d=this.headers.length;var b=this.headers.index(e.target);var c=false;switch(e.keyCode){case f.RIGHT:case f.DOWN:c=this.headers[(b+1)%d];break;case f.LEFT:case f.UP:c=this.headers[(b-1+d)%d];break;case f.SPACE:case f.ENTER:return this._clickHandler({target:e.target},e.target)}if(c){a(e.target).attr("tabIndex","-1");a(c).attr("tabIndex","0");c.focus();return false}return true},resize:function(){var e=this.options,d;if(e.fillSpace){if(a.browser.msie){var b=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}d=this.element.parent().height();if(a.browser.msie){this.element.parent().css("overflow",b)}this.headers.each(function(){d-=a(this).outerHeight()});var c=0;this.headers.next().each(function(){c=Math.max(c,a(this).innerHeight()-a(this).height())}).height(Math.max(0,d-c)).css("overflow","auto")}else{if(e.autoHeight){d=0;this.headers.next().each(function(){d=Math.max(d,a(this).outerHeight())}).height(d)}}},activate:function(b){var c=this._findActive(b)[0];this._clickHandler({target:c},c)},_findActive:function(b){return b?typeof b=="number"?this.headers.filter(":eq("+b+")"):this.headers.not(this.headers.not(b)):b===false?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(b,f){var d=this.options;if(d.disabled){return false}if(!b.target&&d.collapsible){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").find(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header);this.active.next().addClass("ui-accordion-content-active");var h=this.active.next(),e={options:d,newHeader:a([]),oldHeader:d.active,newContent:a([]),oldContent:h},c=(this.active=a([]));this._toggle(c,h,e);return false}var g=a(b.currentTarget||f);var i=g[0]==this.active[0];if(this.running||(!d.collapsible&&i)){return false}this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").find(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header);this.active.next().addClass("ui-accordion-content-active");if(!i){g.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").find(".ui-icon").removeClass(d.icons.header).addClass(d.icons.headerSelected);g.next().addClass("ui-accordion-content-active")}var c=g.next(),h=this.active.next(),e={options:d,newHeader:i&&d.collapsible?a([]):g,oldHeader:this.active,newContent:i&&d.collapsible?a([]):c.find("> *"),oldContent:h.find("> *")},j=this.headers.index(this.active[0])>this.headers.index(g[0]);this.active=i?a([]):g;this._toggle(c,h,e,i,j);return false},_toggle:function(b,i,g,j,k){var d=this.options,m=this;this.toShow=b;this.toHide=i;this.data=g;var c=function(){if(!m){return}return m._completed.apply(m,arguments)};this._trigger("changestart",null,this.data);this.running=i.size()===0?b.size():i.size();if(d.animated){var f={};if(d.collapsible&&j){f={toShow:a([]),toHide:i,complete:c,down:k,autoHeight:d.autoHeight||d.fillSpace}}else{f={toShow:b,toHide:i,complete:c,down:k,autoHeight:d.autoHeight||d.fillSpace}}if(!d.proxied){d.proxied=d.animated}if(!d.proxiedDuration){d.proxiedDuration=d.duration}d.animated=a.isFunction(d.proxied)?d.proxied(f):d.proxied;d.duration=a.isFunction(d.proxiedDuration)?d.proxiedDuration(f):d.proxiedDuration;var l=a.ui.accordion.animations,e=d.duration,h=d.animated;if(!l[h]){l[h]=function(n){this.slide(n,{easing:h,duration:e||700})}}l[h](f)}else{if(d.collapsible&&j){b.toggle()}else{i.hide();b.show()}c(true)}i.prev().attr("aria-expanded","false").attr("tabIndex","-1").blur();b.prev().attr("aria-expanded","true").attr("tabIndex","0").focus()},_completed:function(b){var c=this.options;this.running=b?0:--this.running;if(this.running){return}if(c.clearStyle){this.toShow.add(this.toHide).css({height:"",overflow:""})}this._trigger("change",null,this.data)}});a.extend(a.ui.accordion,{version:"1.7.2",defaults:{active:null,alwaysOpen:true,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()==location.href.toLowerCase()}},animations:{slide:function(j,h){j=a.extend({easing:"swing",duration:300},j,h);if(!j.toHide.size()){j.toShow.animate({height:"show"},j);return}if(!j.toShow.size()){j.toHide.animate({height:"hide"},j);return}var c=j.toShow.css("overflow"),g,d={},f={},e=["height","paddingTop","paddingBottom"],b;var i=j.toShow;b=i[0].style.width;i.width(parseInt(i.parent().width(),10)-parseInt(i.css("paddingLeft"),10)-parseInt(i.css("paddingRight"),10)-(parseInt(i.css("borderLeftWidth"),10)||0)-(parseInt(i.css("borderRightWidth"),10)||0));a.each(e,function(k,m){f[m]="hide";var l=(""+a.css(j.toShow[0],m)).match(/^([\d+-.]+)(.*)$/);d[m]={value:l[1],unit:l[2]||"px"}});j.toShow.css({height:0,overflow:"hidden"}).show();j.toHide.filter(":hidden").each(j.complete).end().filter(":visible").animate(f,{step:function(k,l){if(l.prop=="height"){g=(l.now-l.start)/(l.end-l.start)}j.toShow[0].style[l.prop]=(g*d[l.prop].value)+d[l.prop].unit},duration:j.duration,easing:j.easing,complete:function(){if(!j.autoHeight){j.toShow.css("height","")}j.toShow.css("width",b);j.toShow.css({overflow:c});j.complete()}})},bounceslide:function(b){this.slide(b,{easing:b.down?"easeOutBounce":"swing",duration:b.down?1000:200})},easeslide:function(b){this.slide(b,{easing:"easeinout",duration:700})}}})})(jQuery);;(function(c){var b={dragStart:"start.draggable",drag:"drag.draggable",dragStop:"stop.draggable",maxHeight:"maxHeight.resizable",minHeight:"minHeight.resizable",maxWidth:"maxWidth.resizable",minWidth:"minWidth.resizable",resizeStart:"start.resizable",resize:"drag.resizable",resizeStop:"stop.resizable"},a="ui-dialog ui-widget ui-widget-content ui-corner-all ";c.widget("ui.dialog",{_init:function(){this.originalTitle=this.element.attr("title");var l=this,m=this.options,j=m.title||this.originalTitle||"&nbsp;",e=c.ui.dialog.getTitleId(this.element),k=(this.uiDialog=c("<div/>")).appendTo(document.body).hide().addClass(a+m.dialogClass).css({position:"absolute",overflow:"hidden",zIndex:m.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(n){(m.closeOnEscape&&n.keyCode&&n.keyCode==c.ui.keyCode.ESCAPE&&l.close(n))}).attr({role:"dialog","aria-labelledby":e}).mousedown(function(n){l.moveToTop(false,n)}),g=this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(k),f=(this.uiDialogTitlebar=c("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(k),i=c('<a href="#"/>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){i.addClass("ui-state-hover")},function(){i.removeClass("ui-state-hover")}).focus(function(){i.addClass("ui-state-focus")}).blur(function(){i.removeClass("ui-state-focus")}).mousedown(function(n){n.stopPropagation()}).click(function(n){l.close(n);return false}).appendTo(f),h=(this.uiDialogTitlebarCloseText=c("<span/>")).addClass("ui-icon ui-icon-closethick").text(m.closeText).appendTo(i),d=c("<span/>").addClass("ui-dialog-title").attr("id",e).html(j).prependTo(f);f.find("*").add(f).disableSelection();(m.draggable&&c.fn.draggable&&this._makeDraggable());(m.resizable&&c.fn.resizable&&this._makeResizable());this._createButtons(m.buttons);this._isOpen=false;(m.bgiframe&&c.fn.bgiframe&&k.bgiframe());(m.autoOpen&&this.open())},destroy:function(){(this.overlay&&this.overlay.destroy());this.uiDialog.hide();this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();(this.originalTitle&&this.element.attr("title",this.originalTitle))},close:function(f){var d=this;if(false===d._trigger("beforeclose",f)){return}(d.overlay&&d.overlay.destroy());d.uiDialog.unbind("keypress.ui-dialog");(d.options.hide?d.uiDialog.hide(d.options.hide,function(){d._trigger("close",f)}):d.uiDialog.hide()&&d._trigger("close",f));c.ui.dialog.overlay.resize();d._isOpen=false;if(d.options.modal){var e=0;c(".ui-dialog").each(function(){if(this!=d.uiDialog[0]){e=Math.max(e,c(this).css("z-index"))}});c.ui.dialog.maxZ=e}},isOpen:function(){return this._isOpen},moveToTop:function(f,e){if((this.options.modal&&!f)||(!this.options.stack&&!this.options.modal)){return this._trigger("focus",e)}if(this.options.zIndex>c.ui.dialog.maxZ){c.ui.dialog.maxZ=this.options.zIndex}(this.overlay&&this.overlay.$el.css("z-index",c.ui.dialog.overlay.maxZ=++c.ui.dialog.maxZ));var d={scrollTop:this.element.attr("scrollTop"),scrollLeft:this.element.attr("scrollLeft")};this.uiDialog.css("z-index",++c.ui.dialog.maxZ);this.element.attr(d);this._trigger("focus",e)},open:function(){if(this._isOpen){return}var e=this.options,d=this.uiDialog;this.overlay=e.modal?new c.ui.dialog.overlay(this):null;(d.next().length&&d.appendTo("body"));this._size();this._position(e.position);d.show(e.show);this.moveToTop(true);(e.modal&&d.bind("keypress.ui-dialog",function(h){if(h.keyCode!=c.ui.keyCode.TAB){return}var g=c(":tabbable",this),i=g.filter(":first")[0],f=g.filter(":last")[0];if(h.target==f&&!h.shiftKey){setTimeout(function(){i.focus()},1)}else{if(h.target==i&&h.shiftKey){setTimeout(function(){f.focus()},1)}}}));c([]).add(d.find(".ui-dialog-content :tabbable:first")).add(d.find(".ui-dialog-buttonpane :tabbable:first")).add(d).filter(":first").focus();this._trigger("open");this._isOpen=true},_createButtons:function(g){var f=this,d=false,e=c("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiDialog.find(".ui-dialog-buttonpane").remove();(typeof g=="object"&&g!==null&&c.each(g,function(){return!(d=true)}));if(d){c.each(g,function(h,i){c('<button type="button"></button>').addClass("ui-state-default ui-corner-all").text(h).click(function(){i.apply(f.element[0],arguments)}).hover(function(){c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")}).focus(function(){c(this).addClass("ui-state-focus")}).blur(function(){c(this).removeClass("ui-state-focus")}).appendTo(e)});e.appendTo(this.uiDialog)}},_makeDraggable:function(){var d=this,f=this.options,e;this.uiDialog.draggable({cancel:".ui-dialog-content",handle:".ui-dialog-titlebar",containment:"document",start:function(){e=f.height;c(this).height(c(this).height()).addClass("ui-dialog-dragging");(f.dragStart&&f.dragStart.apply(d.element[0],arguments))},drag:function(){(f.drag&&f.drag.apply(d.element[0],arguments))},stop:function(){c(this).removeClass("ui-dialog-dragging").height(e);(f.dragStop&&f.dragStop.apply(d.element[0],arguments));c.ui.dialog.overlay.resize()}})},_makeResizable:function(g){g=(g===undefined?this.options.resizable:g);var d=this,f=this.options,e=typeof g=="string"?g:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",alsoResize:this.element,maxWidth:f.maxWidth,maxHeight:f.maxHeight,minWidth:f.minWidth,minHeight:f.minHeight,start:function(){c(this).addClass("ui-dialog-resizing");(f.resizeStart&&f.resizeStart.apply(d.element[0],arguments))},resize:function(){(f.resize&&f.resize.apply(d.element[0],arguments))},handles:e,stop:function(){c(this).removeClass("ui-dialog-resizing");f.height=c(this).height();f.width=c(this).width();(f.resizeStop&&f.resizeStop.apply(d.element[0],arguments));c.ui.dialog.overlay.resize()}}).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_position:function(i){var e=c(window),f=c(document),g=f.scrollTop(),d=f.scrollLeft(),h=g;if(c.inArray(i,["center","top","right","bottom","left"])>=0){i=[i=="right"||i=="left"?i:"center",i=="top"||i=="bottom"?i:"middle"]}if(i.constructor!=Array){i=["center","middle"]}if(i[0].constructor==Number){d+=i[0]}else{switch(i[0]){case"left":d+=0;break;case"right":d+=e.width()-this.uiDialog.outerWidth();break;default:case"center":d+=(e.width()-this.uiDialog.outerWidth())/2}}if(i[1].constructor==Number){g+=i[1]}else{switch(i[1]){case"top":g+=0;break;case"bottom":g+=e.height()-this.uiDialog.outerHeight();break;default:case"middle":g+=(e.height()-this.uiDialog.outerHeight())/2}}g=Math.max(g,h);this.uiDialog.css({top:g,left:d})},_setData:function(e,f){(b[e]&&this.uiDialog.data(b[e],f));switch(e){case"buttons":this._createButtons(f);break;case"closeText":this.uiDialogTitlebarCloseText.text(f);break;case"dialogClass":this.uiDialog.removeClass(this.options.dialogClass).addClass(a+f);break;case"draggable":(f?this._makeDraggable():this.uiDialog.draggable("destroy"));break;case"height":this.uiDialog.height(f);break;case"position":this._position(f);break;case"resizable":var d=this.uiDialog,g=this.uiDialog.is(":data(resizable)");(g&&!f&&d.resizable("destroy"));(g&&typeof f=="string"&&d.resizable("option","handles",f));(g||this._makeResizable(f));break;case"title":c(".ui-dialog-title",this.uiDialogTitlebar).html(f||"&nbsp;");break;case"width":this.uiDialog.width(f);break}c.widget.prototype._setData.apply(this,arguments)},_size:function(){var e=this.options;this.element.css({height:0,minHeight:0,width:"auto"});var d=this.uiDialog.css({height:"auto",width:e.width}).height();this.element.css({minHeight:Math.max(e.minHeight-d,0),height:e.height=="auto"?"auto":Math.max(e.height-d,0)})}});c.extend(c.ui.dialog,{version:"1.7.2",defaults:{autoOpen:true,bgiframe:false,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:"center",resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},getter:"isOpen",uuid:0,maxZ:0,getTitleId:function(d){return"ui-dialog-title-"+(d.attr("id")||++this.uuid)},overlay:function(d){this.$el=c.ui.dialog.overlay.create(d)}});c.extend(c.ui.dialog.overlay,{instances:[],maxZ:0,events:c.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(d){return d+".dialog-overlay"}).join(" "),create:function(e){if(this.instances.length===0){setTimeout(function(){if(c.ui.dialog.overlay.instances.length){c(document).bind(c.ui.dialog.overlay.events,function(f){var g=c(f.target).parents(".ui-dialog").css("zIndex")||0;return(g>c.ui.dialog.overlay.maxZ)})}},1);c(document).bind("keydown.dialog-overlay",function(f){(e.options.closeOnEscape&&f.keyCode&&f.keyCode==c.ui.keyCode.ESCAPE&&e.close(f))});c(window).bind("resize.dialog-overlay",c.ui.dialog.overlay.resize)}var d=c("<div></div>").appendTo(document.body).addClass("ui-widget-overlay").css({width:this.width(),height:this.height()});(e.options.bgiframe&&c.fn.bgiframe&&d.bgiframe());this.instances.push(d);return d},destroy:function(d){this.instances.splice(c.inArray(this.instances,d),1);if(this.instances.length===0){c([document,window]).unbind(".dialog-overlay")}d.remove();var e=0;c.each(this.instances,function(){e=Math.max(e,this.css("z-index"))});this.maxZ=e},height:function(){if(c.browser.msie&&c.browser.version<7){var e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);var d=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(e<d){return c(window).height()+"px"}else{return e+"px"}}else{return c(document).height()+"px"}},width:function(){if(c.browser.msie&&c.browser.version<7){var d=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);var e=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(d<e){return c(window).width()+"px"}else{return d+"px"}}else{return c(document).width()+"px"}},resize:function(){var d=c([]);c.each(c.ui.dialog.overlay.instances,function(){d=d.add(this)});d.css({width:0,height:0}).css({width:c.ui.dialog.overlay.width(),height:c.ui.dialog.overlay.height()})}});c.extend(c.ui.dialog.overlay.prototype,{destroy:function(){c.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);;(function(a){a.widget("ui.progressbar",{_init:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this._valueMin(),"aria-valuemax":this._valueMax(),"aria-valuenow":this._value()});this.valueDiv=a('<div class="ui-progressbar-value ui-widget-header ui-corner-left"></div>').appendTo(this.element);this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow").removeData("progressbar").unbind(".progressbar");this.valueDiv.remove();a.widget.prototype.destroy.apply(this,arguments)},value:function(b){if(b===undefined){return this._value()}this._setData("value",b);return this},_setData:function(b,c){switch(b){case"value":this.options.value=c;this._refreshValue();this._trigger("change",null,{});break}a.widget.prototype._setData.apply(this,arguments)},_value:function(){var b=this.options.value;if(b<this._valueMin()){b=this._valueMin()}if(b>this._valueMax()){b=this._valueMax()}return b},_valueMin:function(){var b=0;return b},_valueMax:function(){var b=100;return b},_refreshValue:function(){var b=this.value();this.valueDiv[b==this._valueMax()?"addClass":"removeClass"]("ui-corner-right");this.valueDiv.width(b+"%");this.element.attr("aria-valuenow",b)}});a.extend(a.ui.progressbar,{version:"1.7.2",defaults:{value:0}})})(jQuery);;jQuery.effects||(function(d){d.effects={version:"1.7.2",save:function(g,h){for(var f=0;f<h.length;f++){if(h[f]!==null){g.data("ec.storage."+h[f],g[0].style[h[f]])}}},restore:function(g,h){for(var f=0;f<h.length;f++){if(h[f]!==null){g.css(h[f],g.data("ec.storage."+h[f]))}}},setMode:function(f,g){if(g=="toggle"){g=f.is(":hidden")?"show":"hide"}return g},getBaseline:function(g,h){var i,f;switch(g[0]){case"top":i=0;break;case"middle":i=0.5;break;case"bottom":i=1;break;default:i=g[0]/h.height}switch(g[1]){case"left":f=0;break;case"center":f=0.5;break;case"right":f=1;break;default:f=g[1]/h.width}return{x:f,y:i}},createWrapper:function(f){if(f.parent().is(".ui-effects-wrapper")){return f.parent()}var g={width:f.outerWidth(true),height:f.outerHeight(true),"float":f.css("float")};f.wrap('<div class="ui-effects-wrapper" style="font-size:100%;background:transparent;border:none;margin:0;padding:0"></div>');var j=f.parent();if(f.css("position")=="static"){j.css({position:"relative"});f.css({position:"relative"})}else{var i=f.css("top");if(isNaN(parseInt(i,10))){i="auto"}var h=f.css("left");if(isNaN(parseInt(h,10))){h="auto"}j.css({position:f.css("position"),top:i,left:h,zIndex:f.css("z-index")}).show();f.css({position:"relative",top:0,left:0})}j.css(g);return j},removeWrapper:function(f){if(f.parent().is(".ui-effects-wrapper")){return f.parent().replaceWith(f)}return f},setTransition:function(g,i,f,h){h=h||{};d.each(i,function(k,j){unit=g.cssUnit(j);if(unit[0]>0){h[j]=unit[0]*f+unit[1]}});return h},animateClass:function(h,i,k,j){var f=(typeof k=="function"?k:(j?j:null));var g=(typeof k=="string"?k:null);return this.each(function(){var q={};var o=d(this);var p=o.attr("style")||"";if(typeof p=="object"){p=p.cssText}if(h.toggle){o.hasClass(h.toggle)?h.remove=h.toggle:h.add=h.toggle}var l=d.extend({},(document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle));if(h.add){o.addClass(h.add)}if(h.remove){o.removeClass(h.remove)}var m=d.extend({},(document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle));if(h.add){o.removeClass(h.add)}if(h.remove){o.addClass(h.remove)}for(var r in m){if(typeof m[r]!="function"&&m[r]&&r.indexOf("Moz")==-1&&r.indexOf("length")==-1&&m[r]!=l[r]&&(r.match(/color/i)||(!r.match(/color/i)&&!isNaN(parseInt(m[r],10))))&&(l.position!="static"||(l.position=="static"&&!r.match(/left|top|bottom|right/)))){q[r]=m[r]}}o.animate(q,i,g,function(){if(typeof d(this).attr("style")=="object"){d(this).attr("style")["cssText"]="";d(this).attr("style")["cssText"]=p}else{d(this).attr("style",p)}if(h.add){d(this).addClass(h.add)}if(h.remove){d(this).removeClass(h.remove)}if(f){f.apply(this,arguments)}})})}};function c(g,f){var i=g[1]&&g[1].constructor==Object?g[1]:{};if(f){i.mode=f}var h=g[1]&&g[1].constructor!=Object?g[1]:(i.duration?i.duration:g[2]);h=d.fx.off?0:typeof h==="number"?h:d.fx.speeds[h]||d.fx.speeds._default;var j=i.callback||(d.isFunction(g[1])&&g[1])||(d.isFunction(g[2])&&g[2])||(d.isFunction(g[3])&&g[3]);return[g[0],i,h,j]}d.fn.extend({_show:d.fn.show,_hide:d.fn.hide,__toggle:d.fn.toggle,_addClass:d.fn.addClass,_removeClass:d.fn.removeClass,_toggleClass:d.fn.toggleClass,effect:function(g,f,h,i){return d.effects[g]?d.effects[g].call(this,{method:g,options:f||{},duration:h,callback:i}):null},show:function(){if(!arguments[0]||(arguments[0].constructor==Number||(/(slow|normal|fast)/).test(arguments[0]))){return this._show.apply(this,arguments)}else{return this.effect.apply(this,c(arguments,"show"))}},hide:function(){if(!arguments[0]||(arguments[0].constructor==Number||(/(slow|normal|fast)/).test(arguments[0]))){return this._hide.apply(this,arguments)}else{return this.effect.apply(this,c(arguments,"hide"))}},toggle:function(){if(!arguments[0]||(arguments[0].constructor==Number||(/(slow|normal|fast)/).test(arguments[0]))||(d.isFunction(arguments[0])||typeof arguments[0]=="boolean")){return this.__toggle.apply(this,arguments)}else{return this.effect.apply(this,c(arguments,"toggle"))}},addClass:function(g,f,i,h){return f?d.effects.animateClass.apply(this,[{add:g},f,i,h]):this._addClass(g)},removeClass:function(g,f,i,h){return f?d.effects.animateClass.apply(this,[{remove:g},f,i,h]):this._removeClass(g)},toggleClass:function(g,f,i,h){return((typeof f!=="boolean")&&f)?d.effects.animateClass.apply(this,[{toggle:g},f,i,h]):this._toggleClass(g,f)},morph:function(f,h,g,j,i){return d.effects.animateClass.apply(this,[{add:h,remove:f},g,j,i])},switchClass:function(){return this.morph.apply(this,arguments)},cssUnit:function(f){var g=this.css(f),h=[];d.each(["em","px","%","pt"],function(j,k){if(g.indexOf(k)>0){h=[parseFloat(g),k]}});return h}});d.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(g,f){d.fx.step[f]=function(h){if(h.state==0){h.start=e(h.elem,f);h.end=b(h.end)}h.elem.style[f]="rgb("+[Math.max(Math.min(parseInt((h.pos*(h.end[0]-h.start[0]))+h.start[0],10),255),0),Math.max(Math.min(parseInt((h.pos*(h.end[1]-h.start[1]))+h.start[1],10),255),0),Math.max(Math.min(parseInt((h.pos*(h.end[2]-h.start[2]))+h.start[2],10),255),0)].join(",")+")"}});function b(g){var f;if(g&&g.constructor==Array&&g.length==3){return g}if(f=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(g)){return[parseInt(f[1],10),parseInt(f[2],10),parseInt(f[3],10)]}if(f=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(g)){return[parseFloat(f[1])*2.55,parseFloat(f[2])*2.55,parseFloat(f[3])*2.55]}if(f=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(g)){return[parseInt(f[1],16),parseInt(f[2],16),parseInt(f[3],16)]}if(f=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(g)){return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)]}if(f=/rgba\(0, 0, 0, 0\)/.exec(g)){return a.transparent}return a[d.trim(g).toLowerCase()]}function e(h,f){var g;do{g=d.curCSS(h,f);if(g!=""&&g!="transparent"||d.nodeName(h,"body")){break}f="backgroundColor"}while(h=h.parentNode);return b(g)}var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};d.easing.jswing=d.easing.swing;d.extend(d.easing,{def:"easeOutQuad",swing:function(g,h,f,j,i){return d.easing[d.easing.def](g,h,f,j,i)},easeInQuad:function(g,h,f,j,i){return j*(h/=i)*h+f},easeOutQuad:function(g,h,f,j,i){return-j*(h/=i)*(h-2)+f},easeInOutQuad:function(g,h,f,j,i){if((h/=i/2)<1){return j/2*h*h+f}return-j/2*((--h)*(h-2)-1)+f},easeInCubic:function(g,h,f,j,i){return j*(h/=i)*h*h+f},easeOutCubic:function(g,h,f,j,i){return j*((h=h/i-1)*h*h+1)+f},easeInOutCubic:function(g,h,f,j,i){if((h/=i/2)<1){return j/2*h*h*h+f}return j/2*((h-=2)*h*h+2)+f},easeInQuart:function(g,h,f,j,i){return j*(h/=i)*h*h*h+f},easeOutQuart:function(g,h,f,j,i){return-j*((h=h/i-1)*h*h*h-1)+f},easeInOutQuart:function(g,h,f,j,i){if((h/=i/2)<1){return j/2*h*h*h*h+f}return-j/2*((h-=2)*h*h*h-2)+f},easeInQuint:function(g,h,f,j,i){return j*(h/=i)*h*h*h*h+f},easeOutQuint:function(g,h,f,j,i){return j*((h=h/i-1)*h*h*h*h+1)+f},easeInOutQuint:function(g,h,f,j,i){if((h/=i/2)<1){return j/2*h*h*h*h*h+f}return j/2*((h-=2)*h*h*h*h+2)+f},easeInSine:function(g,h,f,j,i){return-j*Math.cos(h/i*(Math.PI/2))+j+f},easeOutSine:function(g,h,f,j,i){return j*Math.sin(h/i*(Math.PI/2))+f},easeInOutSine:function(g,h,f,j,i){return-j/2*(Math.cos(Math.PI*h/i)-1)+f},easeInExpo:function(g,h,f,j,i){return(h==0)?f:j*Math.pow(2,10*(h/i-1))+f},easeOutExpo:function(g,h,f,j,i){return(h==i)?f+j:j*(-Math.pow(2,-10*h/i)+1)+f},easeInOutExpo:function(g,h,f,j,i){if(h==0){return f}if(h==i){return f+j}if((h/=i/2)<1){return j/2*Math.pow(2,10*(h-1))+f}return j/2*(-Math.pow(2,-10*--h)+2)+f},easeInCirc:function(g,h,f,j,i){return-j*(Math.sqrt(1-(h/=i)*h)-1)+f},easeOutCirc:function(g,h,f,j,i){return j*Math.sqrt(1-(h=h/i-1)*h)+f},easeInOutCirc:function(g,h,f,j,i){if((h/=i/2)<1){return-j/2*(Math.sqrt(1-h*h)-1)+f}return j/2*(Math.sqrt(1-(h-=2)*h)+1)+f},easeInElastic:function(g,i,f,m,l){var j=1.70158;var k=0;var h=m;if(i==0){return f}if((i/=l)==1){return f+m}if(!k){k=l*0.3}if(h<Math.abs(m)){h=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/h)}return-(h*Math.pow(2,10*(i-=1))*Math.sin((i*l-j)*(2*Math.PI)/k))+f},easeOutElastic:function(g,i,f,m,l){var j=1.70158;var k=0;var h=m;if(i==0){return f}if((i/=l)==1){return f+m}if(!k){k=l*0.3}if(h<Math.abs(m)){h=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/h)}return h*Math.pow(2,-10*i)*Math.sin((i*l-j)*(2*Math.PI)/k)+m+f},easeInOutElastic:function(g,i,f,m,l){var j=1.70158;var k=0;var h=m;if(i==0){return f}if((i/=l/2)==2){return f+m}if(!k){k=l*(0.3*1.5)}if(h<Math.abs(m)){h=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/h)}if(i<1){return-0.5*(h*Math.pow(2,10*(i-=1))*Math.sin((i*l-j)*(2*Math.PI)/k))+f}return h*Math.pow(2,-10*(i-=1))*Math.sin((i*l-j)*(2*Math.PI)/k)*0.5+m+f},easeInBack:function(g,h,f,k,j,i){if(i==undefined){i=1.70158}return k*(h/=j)*h*((i+1)*h-i)+f},easeOutBack:function(g,h,f,k,j,i){if(i==undefined){i=1.70158}return k*((h=h/j-1)*h*((i+1)*h+i)+1)+f},easeInOutBack:function(g,h,f,k,j,i){if(i==undefined){i=1.70158}if((h/=j/2)<1){return k/2*(h*h*(((i*=(1.525))+1)*h-i))+f}return k/2*((h-=2)*h*(((i*=(1.525))+1)*h+i)+2)+f},easeInBounce:function(g,h,f,j,i){return j-d.easing.easeOutBounce(g,i-h,0,j,i)+f},easeOutBounce:function(g,h,f,j,i){if((h/=i)<(1/2.75)){return j*(7.5625*h*h)+f}else{if(h<(2/2.75)){return j*(7.5625*(h-=(1.5/2.75))*h+0.75)+f}else{if(h<(2.5/2.75)){return j*(7.5625*(h-=(2.25/2.75))*h+0.9375)+f}else{return j*(7.5625*(h-=(2.625/2.75))*h+0.984375)+f}}}},easeInOutBounce:function(g,h,f,j,i){if(h<i/2){return d.easing.easeInBounce(g,h*2,0,j,i)*0.5+f}return d.easing.easeOutBounce(g,h*2-i,0,j,i)*0.5+j*0.5+f}})})(jQuery);;(function(a){a.effects.blind=function(b){return this.queue(function(){var d=a(this),c=["position","top","left"];var h=a.effects.setMode(d,b.options.mode||"hide");var g=b.options.direction||"vertical";a.effects.save(d,c);d.show();var j=a.effects.createWrapper(d).css({overflow:"hidden"});var e=(g=="vertical")?"height":"width";var i=(g=="vertical")?j.height():j.width();if(h=="show"){j.css(e,0)}var f={};f[e]=h=="show"?i:0;j.animate(f,b.duration,b.options.easing,function(){if(h=="hide"){d.hide()}a.effects.restore(d,c);a.effects.removeWrapper(d);if(b.callback){b.callback.apply(d[0],arguments)}d.dequeue()})})}})(jQuery);;(function(a){a.effects.clip=function(b){return this.queue(function(){var f=a(this),j=["position","top","left","height","width"];var i=a.effects.setMode(f,b.options.mode||"hide");var k=b.options.direction||"vertical";a.effects.save(f,j);f.show();var c=a.effects.createWrapper(f).css({overflow:"hidden"});var e=f[0].tagName=="IMG"?c:f;var g={size:(k=="vertical")?"height":"width",position:(k=="vertical")?"top":"left"};var d=(k=="vertical")?e.height():e.width();if(i=="show"){e.css(g.size,0);e.css(g.position,d/2)}var h={};h[g.size]=i=="show"?d:0;h[g.position]=i=="show"?0:d/2;e.animate(h,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){if(i=="hide"){f.hide()}a.effects.restore(f,j);a.effects.removeWrapper(f);if(b.callback){b.callback.apply(f[0],arguments)}f.dequeue()}})})}})(jQuery);;(function(a){a.effects.drop=function(b){return this.queue(function(){var e=a(this),d=["position","top","left","opacity"];var i=a.effects.setMode(e,b.options.mode||"hide");var h=b.options.direction||"left";a.effects.save(e,d);e.show();a.effects.createWrapper(e);var f=(h=="up"||h=="down")?"top":"left";var c=(h=="up"||h=="left")?"pos":"neg";var j=b.options.distance||(f=="top"?e.outerHeight({margin:true})/2:e.outerWidth({margin:true})/2);if(i=="show"){e.css("opacity",0).css(f,c=="pos"?-j:j)}var g={opacity:i=="show"?1:0};g[f]=(i=="show"?(c=="pos"?"+=":"-="):(c=="pos"?"-=":"+="))+j;e.animate(g,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){if(i=="hide"){e.hide()}a.effects.restore(e,d);a.effects.removeWrapper(e);if(b.callback){b.callback.apply(this,arguments)}e.dequeue()}})})}})(jQuery);;(function(a){a.effects.fold=function(b){return this.queue(function(){var e=a(this),k=["position","top","left"];var h=a.effects.setMode(e,b.options.mode||"hide");var o=b.options.size||15;var n=!(!b.options.horizFirst);var g=b.duration?b.duration/2:a.fx.speeds._default/2;a.effects.save(e,k);e.show();var d=a.effects.createWrapper(e).css({overflow:"hidden"});var i=((h=="show")!=n);var f=i?["width","height"]:["height","width"];var c=i?[d.width(),d.height()]:[d.height(),d.width()];var j=/([0-9]+)%/.exec(o);if(j){o=parseInt(j[1],10)/100*c[h=="hide"?0:1]}if(h=="show"){d.css(n?{height:0,width:o}:{height:o,width:0})}var m={},l={};m[f[0]]=h=="show"?c[0]:o;l[f[1]]=h=="show"?c[1]:0;d.animate(m,g,b.options.easing).animate(l,g,b.options.easing,function(){if(h=="hide"){e.hide()}a.effects.restore(e,k);a.effects.removeWrapper(e);if(b.callback){b.callback.apply(e[0],arguments)}e.dequeue()})})}})(jQuery);;(function(a){a.effects.highlight=function(b){return this.queue(function(){var e=a(this),d=["backgroundImage","backgroundColor","opacity"];var h=a.effects.setMode(e,b.options.mode||"show");var c=b.options.color||"#ffff99";var g=e.css("backgroundColor");a.effects.save(e,d);e.show();e.css({backgroundImage:"none",backgroundColor:c});var f={backgroundColor:g};if(h=="hide"){f.opacity=0}e.animate(f,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){if(h=="hide"){e.hide()}a.effects.restore(e,d);if(h=="show"&&a.browser.msie){this.style.removeAttribute("filter")}if(b.callback){b.callback.apply(this,arguments)}e.dequeue()}})})}})(jQuery);;(function(a){a.effects.puff=function(b){return this.queue(function(){var f=a(this);var c=a.extend(true,{},b.options);var h=a.effects.setMode(f,b.options.mode||"hide");var g=parseInt(b.options.percent,10)||150;c.fade=true;var e={height:f.height(),width:f.width()};var d=g/100;f.from=(h=="hide")?e:{height:e.height*d,width:e.width*d};c.from=f.from;c.percent=(h=="hide")?g:100;c.mode=h;f.effect("scale",c,b.duration,b.callback);f.dequeue()})};a.effects.scale=function(b){return this.queue(function(){var g=a(this);var d=a.extend(true,{},b.options);var j=a.effects.setMode(g,b.options.mode||"effect");var h=parseInt(b.options.percent,10)||(parseInt(b.options.percent,10)==0?0:(j=="hide"?0:100));var i=b.options.direction||"both";var c=b.options.origin;if(j!="effect"){d.origin=c||["middle","center"];d.restore=true}var f={height:g.height(),width:g.width()};g.from=b.options.from||(j=="show"?{height:0,width:0}:f);var e={y:i!="horizontal"?(h/100):1,x:i!="vertical"?(h/100):1};g.to={height:f.height*e.y,width:f.width*e.x};if(b.options.fade){if(j=="show"){g.from.opacity=0;g.to.opacity=1}if(j=="hide"){g.from.opacity=1;g.to.opacity=0}}d.from=g.from;d.to=g.to;d.mode=j;g.effect("size",d,b.duration,b.callback);g.dequeue()})};a.effects.size=function(b){return this.queue(function(){var c=a(this),n=["position","top","left","width","height","overflow","opacity"];var m=["position","top","left","overflow","opacity"];var j=["width","height","overflow"];var p=["fontSize"];var k=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];var f=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];var g=a.effects.setMode(c,b.options.mode||"effect");var i=b.options.restore||false;var e=b.options.scale||"both";var o=b.options.origin;var d={height:c.height(),width:c.width()};c.from=b.options.from||d;c.to=b.options.to||d;if(o){var h=a.effects.getBaseline(o,d);c.from.top=(d.height-c.from.height)*h.y;c.from.left=(d.width-c.from.width)*h.x;c.to.top=(d.height-c.to.height)*h.y;c.to.left=(d.width-c.to.width)*h.x}var l={from:{y:c.from.height/d.height,x:c.from.width/d.width},to:{y:c.to.height/d.height,x:c.to.width/d.width}};if(e=="box"||e=="both"){if(l.from.y!=l.to.y){n=n.concat(k);c.from=a.effects.setTransition(c,k,l.from.y,c.from);c.to=a.effects.setTransition(c,k,l.to.y,c.to)}if(l.from.x!=l.to.x){n=n.concat(f);c.from=a.effects.setTransition(c,f,l.from.x,c.from);c.to=a.effects.setTransition(c,f,l.to.x,c.to)}}if(e=="content"||e=="both"){if(l.from.y!=l.to.y){n=n.concat(p);c.from=a.effects.setTransition(c,p,l.from.y,c.from);c.to=a.effects.setTransition(c,p,l.to.y,c.to)}}a.effects.save(c,i?n:m);c.show();a.effects.createWrapper(c);c.css("overflow","hidden").css(c.from);if(e=="content"||e=="both"){k=k.concat(["marginTop","marginBottom"]).concat(p);f=f.concat(["marginLeft","marginRight"]);j=n.concat(k).concat(f);c.find("*[width]").each(function(){child=a(this);if(i){a.effects.save(child,j)}var q={height:child.height(),width:child.width()};child.from={height:q.height*l.from.y,width:q.width*l.from.x};child.to={height:q.height*l.to.y,width:q.width*l.to.x};if(l.from.y!=l.to.y){child.from=a.effects.setTransition(child,k,l.from.y,child.from);child.to=a.effects.setTransition(child,k,l.to.y,child.to)}if(l.from.x!=l.to.x){child.from=a.effects.setTransition(child,f,l.from.x,child.from);child.to=a.effects.setTransition(child,f,l.to.x,child.to)}child.css(child.from);child.animate(child.to,b.duration,b.options.easing,function(){if(i){a.effects.restore(child,j)}})})}c.animate(c.to,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){if(g=="hide"){c.hide()}a.effects.restore(c,i?n:m);a.effects.removeWrapper(c);if(b.callback){b.callback.apply(this,arguments)}c.dequeue()}})})}})(jQuery);;(function(a){a.effects.slide=function(b){return this.queue(function(){var e=a(this),d=["position","top","left"];var i=a.effects.setMode(e,b.options.mode||"show");var h=b.options.direction||"left";a.effects.save(e,d);e.show();a.effects.createWrapper(e).css({overflow:"hidden"});var f=(h=="up"||h=="down")?"top":"left";var c=(h=="up"||h=="left")?"pos":"neg";var j=b.options.distance||(f=="top"?e.outerHeight({margin:true}):e.outerWidth({margin:true}));if(i=="show"){e.css(f,c=="pos"?-j:j)}var g={};g[f]=(i=="show"?(c=="pos"?"+=":"-="):(c=="pos"?"-=":"+="))+j;e.animate(g,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){if(i=="hide"){e.hide()}a.effects.restore(e,d);a.effects.removeWrapper(e);if(b.callback){b.callback.apply(this,arguments)}e.dequeue()}})})}})(jQuery);;(function(a){a.effects.transfer=function(b){return this.queue(function(){var f=a(this),h=a(b.options.to),e=h.offset(),g={top:e.top,left:e.left,height:h.innerHeight(),width:h.innerWidth()},d=f.offset(),c=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.options.className).css({top:d.top,left:d.left,height:f.innerHeight(),width:f.innerWidth(),position:"absolute"}).animate(g,b.duration,b.options.easing,function(){c.remove();(b.callback&&b.callback.apply(f[0],arguments));f.dequeue()})})}})(jQuery);;jQuery.comparePosition=function(element,context){jQuery.comparePosition=document.documentElement.compareDocumentPosition?function(element,context){return!!(element.compareDocumentPosition(context)&8);}:document.documentElement.contains?function(element,context){return element!=context&&context.contains(element);}:function(element,context){for(;element!=context;element=element.parentNode)
if(!element)return false;return true;};return jQuery.comparePosition(element,context);}
jQuery.fn.ancestorOf=function(context){return this.filter(function(){return jQuery.comparePosition(context,this);});};jQuery.fn.descendantOf=function(context){return this.filter(function(){return jQuery.comparePosition(this,context);});};(function($){$.fn.at_intervals=function(fn,options){var settings=$.extend({},$.fn.at_intervals.defaults,options);return this.each(function(){var e=$(this)
var name=settings.name
var delay=settings.delay
var helper={should_stop:function(){return this.user_wants_to_stop()},should_work:function(){return!this.user_wants_to_pause()},user_wants_to_stop:function(){return e.data(name).should_stop==true},user_wants_to_pause:function(){return e.data(name).should_pause==true},element_in_dom:function(){return e.parents("html").length>0},element_visible:function(){return e.parents("*").andSelf().not(":visible").length==0},stop:function(interval_id){clearInterval(interval_id)
e.removeData(name)}}
if(e.data(name)){helper.stop(e.data(name).interval_id)}
e.data(name,{delay:delay})
if(helper.should_work()){fn()}
var interval_id=setInterval(function(){if(helper.should_stop()){helper.stop(interval_id)}else{if(helper.should_work()){fn()}}},delay)
e.data(name).interval_id=interval_id})};$.fn.at_intervals.defaults={name:"at_intervals",delay:1000}})(jQuery);(function($){$.fn.autogrow=function(options){this.filter('textarea').each(function(){var $this=$(this),minHeight=$this.height(),lineHeight=$this.css('lineHeight');var shadow=$('<div></div>').css({position:'absolute',top:-10000,left:-10000,width:$(this).width()-parseInt($this.css('paddingLeft'))-parseInt($this.css('paddingRight')),fontSize:$this.css('fontSize'),fontFamily:$this.css('fontFamily'),lineHeight:$this.css('lineHeight'),resize:'none'}).appendTo(document.body);var update=function(){var times=function(string,number){for(var i=0,r='';i<number;i++)r+=string;return r;};var val=this.value.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/&/g,'&amp;').replace(/\n$/,'<br/>&nbsp;').replace(/\n/g,'<br/>').replace(/ {2,}/g,function(space){return times('&nbsp;',space.length-1)+' '});shadow.html(val);$(this).css('height',Math.max(shadow.height()+20,minHeight));}
$(this).change(update).keyup(update).keydown(update);update.apply(this);});return this;}})(jQuery);jQuery.cookie=function(name,value,options){if(typeof value!='undefined'){options=options||{};if(value===null){value='';options.expires=-1;}
var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var date;if(typeof options.expires=='number'){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000));}else{date=options.expires;}
expires='; expires='+date.toUTCString();}
var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('');}else{var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}};jQuery.fn.delay=function(time,name){return this.queue((name||"fx"),function(){var self=this;setTimeout(function(){jQuery.dequeue(self);},time);});};(function($){$.ifixpng=function(customPixel){$.ifixpng.pixel=customPixel;};$.ifixpng.getPixel=function(){return $.ifixpng.pixel||'/assets/base.v8/img/x.gif';};var hack={ltie7:$.browser.msie&&$.browser.version<7,filter:function(src){return"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=crop,src='"+src+"')";}};$.fn.ifixpng=hack.ltie7?function(){return this.each(function(){var $$=$(this);var base=$('base').attr('href');if(base){base=base.replace(/\/[^\/]+$/,'/');}
if($$.is('img')||$$.is('input')){if($$.attr('src')){if($$.attr('src').match(/.*\.png([?].*)?$/i)){var source=(base&&$$.attr('src').search(/^(\/|http:)/i))?base+$$.attr('src'):$$.attr('src');$$.css({filter:hack.filter(source),width:$$.width(),height:$$.height()}).attr({src:$.ifixpng.getPixel()}).positionFix();}}}else{var image=$$.css('backgroundImage');if(image.match(/^url\(["']?(.*\.png([?].*)?)["']?\)$/i)){image=RegExp.$1;image=(base&&image.substring(0,1)!='/')?base+image:image;$$.css({backgroundImage:'none',filter:hack.filter(image)}).children().children().positionFix();}}});}:function(){return this;};$.fn.iunfixpng=hack.ltie7?function(){return this.each(function(){var $$=$(this);var src=$$.css('filter');if(src.match(/src=["']?(.*\.png([?].*)?)["']?/i)){src=RegExp.$1;if($$.is('img')||$$.is('input')){$$.attr({src:src}).css({filter:''});}else{$$.css({filter:'',background:'url('+src+')'});}}});}:function(){return this;};$.fn.positionFix=function(){return this.each(function(){var $$=$(this);var position=$$.css('position');if(position!='absolute'&&position!='relative'){$$.css({position:'relative'});}});};})(jQuery);(function($){$.fn.editable=function(target,options){if('disable'==target){$(this).data('disabled.editable',true);return;}
if('enable'==target){$(this).data('disabled.editable',false);return;}
if('destroy'==target){$(this).unbind($(this).data('event.editable')).removeData('disabled.editable').removeData('event.editable');return;}
var settings=$.extend({},$.fn.editable.defaults,{target:target},options);var plugin=$.editable.types[settings.type].plugin||function(){};var submit=$.editable.types[settings.type].submit||function(){};var buttons=$.editable.types[settings.type].buttons||$.editable.types['defaults'].buttons;var content=$.editable.types[settings.type].content||$.editable.types['defaults'].content;var element=$.editable.types[settings.type].element||$.editable.types['defaults'].element;var reset=$.editable.types[settings.type].reset||$.editable.types['defaults'].reset;var callback=settings.callback||function(){};var onedit=settings.onedit||function(){};var onsubmit=settings.onsubmit||function(){};var onreset=settings.onreset||function(){};var onerror=settings.onerror||reset;if(settings.tooltip){$(this).attr('title',settings.tooltip);}
settings.autowidth='auto'==settings.width;settings.autoheight='auto'==settings.height;return this.each(function(){var self=this;var savedwidth=$(self).width();var savedheight=$(self).height();$(this).data('event.editable',settings.event);if(!$.trim($(this).html())){$(this).html(settings.placeholder);}
$(this).bind(settings.event,function(e){if(true===$(this).data('disabled.editable')){return;}
if(self.editing){return;}
if(false===onedit.apply(this,[settings,self])){return;}
e.preventDefault();e.stopPropagation();if(settings.tooltip){$(self).removeAttr('title');}
if(0==$(self).width()){settings.width=savedwidth;settings.height=savedheight;}else{if(settings.width!='none'){settings.width=settings.autowidth?$(self).width():settings.width;}
if(settings.height!='none'){settings.height=settings.autoheight?$(self).height():settings.height;}}
if($(this).html().toLowerCase().replace(/(;|")/g,'')==settings.placeholder.toLowerCase().replace(/(;|")/g,'')){$(this).html('');}
self.editing=true;self.revert=$(self).html();$(self).html('');var form=$('<form />');if(settings.cssclass){if('inherit'==settings.cssclass){form.attr('class',$(self).attr('class'));}else{form.attr('class',settings.cssclass);}}
if(settings.style){if('inherit'==settings.style){form.attr('style',$(self).attr('style'));form.css('display',$(self).css('display'));}else{form.attr('style',settings.style);}}
var input=element.apply(form,[settings,self]);var input_content;if(settings.loadurl){var t=setTimeout(function(){input.disabled=true;content.apply(form,[settings.loadtext,settings,self]);},100);var loaddata={};loaddata[settings.id]=self.id;if($.isFunction(settings.loaddata)){$.extend(loaddata,settings.loaddata.apply(self,[self.revert,settings]));}else{$.extend(loaddata,settings.loaddata);}
$.ajax({type:settings.loadtype,url:settings.loadurl,data:loaddata,async:false,success:function(result){window.clearTimeout(t);input_content=result;input.disabled=false;}});}else if(settings.data){input_content=settings.data;if($.isFunction(settings.data)){input_content=settings.data.apply(self,[self.revert,settings]);}}else{input_content=self.revert;}
content.apply(form,[input_content,settings,self]);input.attr('name',settings.name);buttons.apply(form,[settings,self]);$(self).append(form);plugin.apply(form,[settings,self]);$(':input:visible:enabled:first',form).focus();if(settings.select){input.select();}
input.keydown(function(e){if(e.keyCode==27){e.preventDefault();reset.apply(form,[settings,self]);}});var t;if('cancel'==settings.onblur){input.blur(function(e){t=setTimeout(function(){reset.apply(form,[settings,self]);},500);});}else if('submit'==settings.onblur){input.blur(function(e){t=setTimeout(function(){form.submit();},200);});}else if($.isFunction(settings.onblur)){input.blur(function(e){settings.onblur.apply(self,[input.val(),settings]);});}else{input.blur(function(e){});}
form.submit(function(e){if(t){clearTimeout(t);}
e.preventDefault();if(false!==onsubmit.apply(form,[settings,self])){if(false!==submit.apply(form,[settings,self])){if($.isFunction(settings.target)){var str=settings.target.apply(self,[input.val(),settings]);$(self).html(str);self.editing=false;callback.apply(self,[self.innerHTML,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder);}}else{var submitdata={};submitdata[settings.name]=input.val();submitdata[settings.id]=self.id;if($.isFunction(settings.submitdata)){$.extend(submitdata,settings.submitdata.apply(self,[self.revert,settings]));}else{$.extend(submitdata,settings.submitdata);}
if('PUT'==settings.method){submitdata['_method']='put';}
$(self).html(settings.indicator);var ajaxoptions={type:'POST',data:submitdata,dataType:'json',url:settings.target,success:function(result,status){if(ajaxoptions.dataType=='html'){$(self).html(result);}else if(ajaxoptions.dataType=='json'){if(result.postSave.success==true){$(self).html(submitdata.entry);$('#tag-metaEdit').html('');}else{$('#tag-metaEdit').html('Error saving:<br/>'+result.postSave.message);onerror.apply(form,[settings,self]);}}
self.editing=false;callback.apply(self,[result,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder);}},error:function(xhr,status,error){onerror.apply(form,[settings,self,xhr]);}};$.extend(ajaxoptions,settings.ajaxoptions);$.ajax(ajaxoptions);}}}
$(self).attr('title',settings.tooltip);return false;});});this.reset=function(form){if(this.editing){if(false!==onreset.apply(form,[settings,self])){$(self).html(self.revert);self.editing=false;if(!$.trim($(self).html())){$(self).html(settings.placeholder);}
if(settings.tooltip){$(self).attr('title',settings.tooltip);}}}};});};$.editable={types:{defaults:{element:function(settings,original){var input=$('<input type="hidden"></input>');$(this).append(input);return(input);},content:function(string,settings,original){$(':input:first',this).val(string);},reset:function(settings,original){original.reset(this);},buttons:function(settings,original){var form=this;if(settings.submit){if(settings.submit.match(/>$/)){var submit=$(settings.submit).click(function(){if(submit.attr("type")!="submit"){form.submit();}});}else{var submit=$('<button type="submit" />');submit.html(settings.submit);}
$(this).append(submit);}
if(settings.cancel){if(settings.cancel.match(/>$/)){var cancel=$(settings.cancel);}else{var cancel=$('<button type="cancel" />');cancel.html(settings.cancel);}
$(this).append(cancel);$(cancel).click(function(event){if($.isFunction($.editable.types[settings.type].reset)){var reset=$.editable.types[settings.type].reset;}else{var reset=$.editable.types['defaults'].reset;}
reset.apply(form,[settings,original]);return false;});}}},text:{element:function(settings,original){var input=$('<input />');if(settings.width!='none'){input.width(settings.width);}
if(settings.height!='none'){input.height(settings.height);}
input.attr('autocomplete','off');$(this).append(input);return(input);}},textarea:{element:function(settings,original){var textarea=$('<textarea />');if(settings.rows){textarea.attr('rows',settings.rows);}else if(settings.height!="none"){textarea.height(settings.height);}
if(settings.cols){textarea.attr('cols',settings.cols);}else if(settings.width!="none"){textarea.width(settings.width);}
$(this).append(textarea);return(textarea);}},select:{element:function(settings,original){var select=$('<select />');$(this).append(select);return(select);},content:function(data,settings,original){if(String==data.constructor){eval('var json = '+data);}else{var json=data;}
for(var key in json){if(!json.hasOwnProperty(key)){continue;}
if('selected'==key){continue;}
var option=$('<option />').val(key).append(json[key]);$('select',this).append(option);}
$('select',this).children().each(function(){if($(this).val()==json['selected']||$(this).text()==$.trim(original.revert)){$(this).attr('selected','selected');}});}}},addInputType:function(name,input){$.editable.types[name]=input;}};$.fn.editable.defaults={name:'value',id:'id',type:'text',width:'auto',height:'auto',event:'click.editable',onblur:'cancel',loadtype:'GET',loadtext:'Loading...',placeholder:'Click to edit',loaddata:{},submitdata:{},ajaxoptions:{}};})(jQuery);(function($){function toIntegersAtLease(n)
{return n<10?'0'+n:n;}
Date.prototype.toJSON=function(date)
{return this.getUTCFullYear()+'-'+
toIntegersAtLease(this.getUTCMonth())+'-'+
toIntegersAtLease(this.getUTCDate());};var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;var meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};$.quoteString=function(string)
{if(escapeable.test(string))
{return'"'+string.replace(escapeable,function(a)
{var c=meta[a];if(typeof c==='string'){return c;}
c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}
return'"'+string+'"';};$.toJSON=function(o,compact)
{var type=typeof(o);if(type=="undefined")
return"undefined";else if(type=="number"||type=="boolean")
return o+"";else if(o===null)
return"null";if(type=="string")
{return $.quoteString(o);}
if(type=="object"&&typeof o.toJSON=="function")
return o.toJSON(compact);if(type!="function"&&typeof(o.length)=="number")
{var ret=[];for(var i=0;i<o.length;i++){ret.push($.toJSON(o[i],compact));}
if(compact)
return"["+ret.join(",")+"]";else
return"["+ret.join(", ")+"]";}
if(type=="function"){throw new TypeError("Unable to convert object of type 'function' to json.");}
var ret=[];for(var k in o){var name;type=typeof(k);if(type=="number")
name='"'+k+'"';else if(type=="string")
name=$.quoteString(k);else
continue;var val=$.toJSON(o[k],compact);if(typeof(val)!="string"){continue;}
if(compact)
ret.push(name+":"+val);else
ret.push(name+": "+val);}
return"{"+ret.join(", ")+"}";};$.compactJSON=function(o)
{return $.toJSON(o,true);};$.evalJSON=function(src)
{return eval("("+src+")");};$.secureEvalJSON=function(src)
{var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,'@');filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']');filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered))
return eval("("+src+")");else
throw new SyntaxError("Error parsing JSON, source is not valid.");};})(jQuery);(function($){$.fn.lightBox=function(settings){settings=jQuery.extend({overlayBgColor:'#000',overlayOpacity:0.8,fixedNavigation:false,imageLoading:'/assets/base.v8/img/jquery.lightbox-0.5/lightbox-ico-loading.gif',imageBtnPrev:'/assets/base.v8/img/jquery.lightbox-0.5/lightbox-btn-prev.gif',imageBtnNext:'/assets/base.v8/img/jquery.lightbox-0.5/lightbox-btn-next.gif',imageBtnPause:'/assets/base.v8/img/jquery.lightbox-0.5/lightbox-btn-pause.png',imageBtnPlay:'/assets/base.v8/img/jquery.lightbox-0.5/lightbox-btn-play.png',imageBtnClose:'/assets/base.v8/img/jquery.lightbox-0.5/lightbox-btn-close.png',imageBlank:'/assets/base.v8/img/jquery.lightbox-0.5/lightbox-blank.gif',containerBorderSize:10,containerResizeSpeed:400,txtImage:'Image',txtOf:'of',keyToClose:'c',keyToPrev:'p',keyToNext:'n',imageArray:[],activeImage:0,slideShowEnabled:false,timeout:null,slideShowPaused:false},settings);var jQueryMatchedObj=this;function _initialize(){_start(this,jQueryMatchedObj);return false;}
function _start(objClicked,jQueryMatchedObj){$('embed, object, select').css({'visibility':'hidden'});_set_interface();settings.imageArray.length=0;settings.activeImage=0;if(jQueryMatchedObj.length==1){settings.imageArray.push(new Array(objClicked.getAttribute('href'),objClicked.getAttribute('title')));}else{for(var i=0;i<jQueryMatchedObj.length;i++){settings.imageArray.push(new Array(jQueryMatchedObj[i].getAttribute('href'),jQueryMatchedObj[i].getAttribute('title')));}
settings.slideShowEnabled=true;$('#lightbox-secNav-btnPause').show().bind('click',function(){_pause();return false;});}
while(settings.imageArray[settings.activeImage][0]!=objClicked.getAttribute('href')){settings.activeImage++;}
_set_image_to_view();}
function _set_interface(){$('body').append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-nav-btnPrev"></a><a href="#" id="lightbox-nav-btnNext"></a></div><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+settings.imageLoading+'"></a></div></div></div><div id="lightbox-container-image-data-box"><div id="lightbox-container-image-data"><div id="lightbox-image-details"><span id="lightbox-image-details-caption"></span><span id="lightbox-image-details-currentNumber"></span></div><div id="lightbox-secNav"><a href="#" id="lightbox-secNav-btnPause" style="display: none;"><img src="'+settings.imageBtnPause+'"></a><a href="#" id="lightbox-secNav-btnClose"><img src="'+settings.imageBtnClose+'"></a></div></div></div></div>');var arrPageSizes=___getPageSize();$('#jquery-overlay').css({backgroundColor:settings.overlayBgColor,opacity:settings.overlayOpacity,width:arrPageSizes[0],height:arrPageSizes[1]}).fadeIn();var arrPageScroll=___getPageScroll();$('#jquery-lightbox').css({top:arrPageScroll[1]+(arrPageSizes[3]/10),left:arrPageScroll[0]}).show();$('#jquery-overlay,#jquery-lightbox').click(function(){_finish();});$('#lightbox-loading-link,#lightbox-secNav-btnClose').click(function(){_finish();return false;});$(window).resize(function(){var arrPageSizes=___getPageSize();$('#jquery-overlay').css({width:arrPageSizes[0],height:arrPageSizes[1]});var arrPageScroll=___getPageScroll();$('#jquery-lightbox').css({top:arrPageScroll[1]+(arrPageSizes[3]/10),left:arrPageScroll[0]});});}
function _set_image_to_view(){_pause();$('#lightbox-loading').show();if(settings.fixedNavigation){$('#lightbox-image,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber').hide();}else{$('#lightbox-image,#lightbox-nav,#lightbox-nav-btnPrev,#lightbox-nav-btnNext,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber').hide();}
$('#lightbox-container-image-box').css('border-bottom','');var objImagePreloader=new Image();objImagePreloader.onload=function(){$('#lightbox-image').attr('src',settings.imageArray[settings.activeImage][0]);_resize_container_image_box(objImagePreloader.width,objImagePreloader.height);objImagePreloader.onload=function(){};};objImagePreloader.src=settings.imageArray[settings.activeImage][0];_pause();};function _pause(){if(settings.slideShowPaused==true){$('#lightbox-secNav-btnPause img').attr('src',settings.imageBtnPause);if(settings.slideShowEnabled&&settings.activeImage<(settings.imageArray.length-1))
{settings.timeout=setTimeout(function(){settings.activeImage++;_set_image_to_view();},4000);}}else{$('#lightbox-secNav-btnPause img').attr('src',settings.imageBtnPlay);if(settings.timeout!=null){clearTimeout(settings.timeout);}}
settings.slideShowPaused=!settings.slideShowPaused;}
function _resize_container_image_box(intImageWidth,intImageHeight){var intCurrentWidth=$('#lightbox-container-image-box').width();var intCurrentHeight=$('#lightbox-container-image-box').height();var intWidth=(intImageWidth+(settings.containerBorderSize*2));var intHeight=(intImageHeight+(settings.containerBorderSize*2));var intDiffW=intCurrentWidth-intWidth;var intDiffH=intCurrentHeight-intHeight;$('#lightbox-container-image-box').animate({width:intWidth,height:intHeight},settings.containerResizeSpeed,function(){_show_image();});if((intDiffW==0)&&(intDiffH==0)){if($.browser.msie){___pause(250);}else{___pause(100);}}
$('#lightbox-container-image-data-box').css({width:intImageWidth});$('#lightbox-nav-btnPrev,#lightbox-nav-btnNext').css({height:intImageHeight+(settings.containerBorderSize*2)});};function _show_image(){$('#lightbox-loading').hide();$('#lightbox-image').fadeIn(function(){_show_image_data();_set_navigation();});_preload_neighbor_images();};function _show_image_data(){$('#lightbox-container-image-box').css('border-bottom','none');$('#lightbox-container-image-data-box').slideDown('fast');$('#lightbox-image-details-caption').hide();if(settings.imageArray[settings.activeImage][1]){$('#lightbox-image-details-caption').html(settings.imageArray[settings.activeImage][1]).show();}
if(settings.imageArray.length>1){$('#lightbox-image-details-currentNumber').html(settings.txtImage+' '+(settings.activeImage+1)+' '+settings.txtOf+' '+settings.imageArray.length).show();}}
function _set_navigation(){$('#lightbox-nav').show();$('#lightbox-nav-btnPrev,#lightbox-nav-btnNext').css({'background':'transparent url('+settings.imageBlank+') no-repeat'});if(settings.activeImage!=0){if(settings.fixedNavigation){$('#lightbox-nav-btnPrev').css({'background':'url('+settings.imageBtnPrev+') left 15% no-repeat'}).unbind().bind('click',function(){settings.activeImage=settings.activeImage-1;_set_image_to_view();return false;});}else{$('#lightbox-nav-btnPrev').unbind().hover(function(){$(this).css({'background':'url('+settings.imageBtnPrev+') left 15% no-repeat'});},function(){$(this).css({'background':'transparent url('+settings.imageBlank+') no-repeat'});}).show().bind('click',function(){settings.activeImage=settings.activeImage-1;_set_image_to_view();return false;});}}
if(settings.activeImage!=(settings.imageArray.length-1)){if(settings.fixedNavigation){$('#lightbox-nav-btnNext').css({'background':'url('+settings.imageBtnNext+') right 15% no-repeat'}).unbind().bind('click',function(){settings.activeImage=settings.activeImage+1;_set_image_to_view();return false;});}else{$('#lightbox-nav-btnNext').unbind().hover(function(){$(this).css({'background':'url('+settings.imageBtnNext+') right 15% no-repeat'});},function(){$(this).css({'background':'transparent url('+settings.imageBlank+') no-repeat'});}).show().bind('click',function(){settings.activeImage=settings.activeImage+1;_set_image_to_view();return false;});}}
_enable_keyboard_navigation();}
function _enable_keyboard_navigation(){$(document).keydown(function(objEvent){_keyboard_action(objEvent);});}
function _disable_keyboard_navigation(){$(document).unbind();}
function _keyboard_action(objEvent){if(objEvent==null){keycode=event.keyCode;escapeKey=27;}else{keycode=objEvent.keyCode;escapeKey=objEvent.DOM_VK_ESCAPE;}
key=String.fromCharCode(keycode).toLowerCase();if((key==settings.keyToClose)||(key=='x')||(keycode==escapeKey)){_finish();}
if((key==settings.keyToPrev)||(keycode==37)){if(settings.activeImage!=0){settings.activeImage=settings.activeImage-1;_set_image_to_view();_disable_keyboard_navigation();}}
if((key==settings.keyToNext)||(keycode==39)){if(settings.activeImage!=(settings.imageArray.length-1)){settings.activeImage=settings.activeImage+1;_set_image_to_view();_disable_keyboard_navigation();}}}
function _preload_neighbor_images(){if((settings.imageArray.length-1)>settings.activeImage){objNext=new Image();objNext.src=settings.imageArray[settings.activeImage+1][0];}
if(settings.activeImage>0){objPrev=new Image();objPrev.src=settings.imageArray[settings.activeImage-1][0];}}
function _finish(){$('#jquery-lightbox').remove();$('#jquery-overlay').fadeOut(function(){$('#jquery-overlay').remove();});$('embed, object, select').css({'visibility':'visible'});}
function ___getPageSize(){var xScroll,yScroll;if(window.innerHeight&&window.scrollMaxY){xScroll=window.innerWidth+window.scrollMaxX;yScroll=window.innerHeight+window.scrollMaxY;}else if(document.body.scrollHeight>document.body.offsetHeight){xScroll=document.body.scrollWidth;yScroll=document.body.scrollHeight;}else{xScroll=document.body.offsetWidth;yScroll=document.body.offsetHeight;}
var windowWidth,windowHeight;if(self.innerHeight){if(document.documentElement.clientWidth){windowWidth=document.documentElement.clientWidth;}else{windowWidth=self.innerWidth;}
windowHeight=self.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){windowWidth=document.documentElement.clientWidth;windowHeight=document.documentElement.clientHeight;}else if(document.body){windowWidth=document.body.clientWidth;windowHeight=document.body.clientHeight;}
if(yScroll<windowHeight){pageHeight=windowHeight;}else{pageHeight=yScroll;}
if(xScroll<windowWidth){pageWidth=xScroll;}else{pageWidth=windowWidth;}
arrayPageSize=new Array(pageWidth,pageHeight,windowWidth,windowHeight);return arrayPageSize;};function ___getPageScroll(){var xScroll,yScroll;if(self.pageYOffset){yScroll=self.pageYOffset;xScroll=self.pageXOffset;}else if(document.documentElement&&document.documentElement.scrollTop){yScroll=document.documentElement.scrollTop;xScroll=document.documentElement.scrollLeft;}else if(document.body){yScroll=document.body.scrollTop;xScroll=document.body.scrollLeft;}
arrayPageScroll=new Array(xScroll,yScroll);return arrayPageScroll;};function ___pause(ms){var date=new Date();curDate=null;do{var curDate=new Date();}
while(curDate-date<ms);};return this.unbind('click').click(_initialize);};})(jQuery);;(function(d){var k=d.scrollTo=function(a,i,e){d(window).scrollTo(a,i,e)};k.defaults={axis:'xy',duration:parseFloat(d.fn.jquery)>=1.3?0:1};k.window=function(a){return d(window)._scrollable()};d.fn._scrollable=function(){return this.map(function(){var a=this,i=!a.nodeName||d.inArray(a.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!i)return a;var e=(a.contentWindow||a).document||a.ownerDocument||a;return d.browser.safari||e.compatMode=='BackCompat'?e.body:e.documentElement})};d.fn.scrollTo=function(n,j,b){if(typeof j=='object'){b=j;j=0}if(typeof b=='function')b={onAfter:b};if(n=='max')n=9e9;b=d.extend({},k.defaults,b);j=j||b.speed||b.duration;b.queue=b.queue&&b.axis.length>1;if(b.queue)j/=2;b.offset=p(b.offset);b.over=p(b.over);return this._scrollable().each(function(){var q=this,r=d(q),f=n,s,g={},u=r.is('html,body');switch(typeof f){case'number':case'string':if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(f)){f=p(f);break}f=d(f,this);case'object':if(f.is||f.style)s=(f=d(f)).offset()}d.each(b.axis.split(''),function(a,i){var e=i=='x'?'Left':'Top',h=e.toLowerCase(),c='scroll'+e,l=q[c],m=k.max(q,i);if(s){g[c]=s[h]+(u?0:l-r.offset()[h]);if(b.margin){g[c]-=parseInt(f.css('margin'+e))||0;g[c]-=parseInt(f.css('border'+e+'Width'))||0}g[c]+=b.offset[h]||0;if(b.over[h])g[c]+=f[i=='x'?'width':'height']()*b.over[h]}else{var o=f[h];g[c]=o.slice&&o.slice(-1)=='%'?parseFloat(o)/100*m:o}if(/^\d+$/.test(g[c]))g[c]=g[c]<=0?0:Math.min(g[c],m);if(!a&&b.queue){if(l!=g[c])t(b.onAfterFirst);delete g[c]}});t(b.onAfter);function t(a){r.animate(g,j,b.easing,a&&function(){a.call(this,n,b)})}}).end()};k.max=function(a,i){var e=i=='x'?'Width':'Height',h='scroll'+e;if(!d(a).is('html,body'))return a[h]-d(a)[e.toLowerCase()]();var c='client'+e,l=a.ownerDocument.documentElement,m=a.ownerDocument.body;return Math.max(l[h],m[h])-Math.min(l[c],m[c])};function p(a){return typeof a=='object'?a:{top:a,left:a}}})(jQuery);(function(){var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\b_super\b/:/.*/;this.gClass=function(){};gClass.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret;};})(name,prop[name]):prop[name];}
function gClass(){if(!initializing&&this.initialize)
this.initialize.apply(this,arguments);}
gClass.prototype=prototype;gClass.constructor=gClass;gClass.extend=arguments.callee;return gClass;};})();if(Function.prototype.bind==undefined){jQuery.extend(Function.prototype,{bind:function(){if(arguments.length<2&&(typeof arguments[0]=="undefined")){return this;}
var __method=this;var object=arguments[0];var args=new Array();for(var i=1,l=arguments.length;i<l;i++){args[(i-1)]=arguments[i];}
return function(){var nuArgs=new Array();for(var i=0,l=args.length;i<l;i++){nuArgs[(nuArgs.length)]=args[i];}
for(var i=0,l=arguments.length;i<l;i++){nuArgs[(nuArgs.length)]=arguments[i];}
return __method.apply(object,nuArgs);}}});}
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(item,i){i||(i=0);var length=this.length;if(i<0)i=length+i;for(;i<length;i++){if(this[i]===item)return i;}
return-1;};var Message={options:{duration:3000,stable:false,nextMessage:'',onShow:function(){},onComplete:function(){}},showMessage:function(message,container,options){var currentOptions=jQuery.extend({},this.options,options);this.renderMessage(message,container);if(currentOptions.stable!=true){setTimeout(function(){Message.renderMessage(currentOptions.nextMessage,container);if(currentOptions.onComplete){currentOptions.onComplete();}},currentOptions.duration);}
if(currentOptions.onShow){currentOptions.onShow();}},renderMessage:function(message,container){if(container.nodeName=='INPUT'){container.value=message;}
else
{container.innerHTML=message;}
return true;}};var GawkerBase=gClass.extend({initialize:function(){},setOptions:function(options){var baseOptions=this.options;this.options=options;for(optionName in baseOptions){if(!this.options[optionName])
{this.options[optionName]=baseOptions[optionName];}}}});var XHR=GawkerBase.extend({options:{type:'POST',dataType:'json',klass:null},initialize:function(options){this.setOptions(options);},send:function(url,queryString){this.options.url=url;this.options.data=queryString;this.xhr=jQuery.ajax(this.options);},abort:function(){if(this.xhr!=undefined){this.xhr.abort();}}});var gh={};jQuery.extend(jQuery.widget.prototype,function(){var EventDispatcher={listeners:{},event_history:{},subscribe:function(what,fn,last_n,which_object){if(this.listeners[what]){this.listeners[what].push({'fn':fn,'target':which_object});}else{this.listeners[what]=[{'fn':fn,'target':which_object}];}
if(this.event_history[what]){var l=this.event_history[what].length;if(last_n==undefined){last_n=1;}
if(last_n>=0){var i=l-last_n;}else{var i=0;}
for(;i<l;i++){try{if(this.event_history[what][i]['notifyOnly']){if(this.event_history[what][i]['notifyOnly']===which_object)fn(this.event_history[what][i]);}else{fn(this.event_history[what][i]);}}catch(ex){}}}},notify:function(ev){var name_parts=ev.name.split('.');var key='';for(var i=0,l=name_parts.length;i<l;i++){key+=name_parts[i];if(i<l-1){key+='.';}
if(this.listeners[key]){for(var ii=0,ll=this.listeners[key].length;ii<ll;ii++){try{if(ev['notifyOnly']){if(ev['notifyOnly']===this.listeners[key][ii]['target'])this.listeners[key][ii]['fn'](ev);}else{this.listeners[key][ii]['fn'](ev);}}catch(ex){Logger.debugLog(ex.message);}}}
if(this.event_history[key]){this.event_history[key].push(ev);}else{this.event_history[key]=[ev];}}}};var DOMEventDispatcher={'observing':[],'eventmap':{},registerEventDispatcher:function(myeventmap){return function(e){var target=jQuery(e.target);for(var control_name in myeventmap){if(myeventmap.hasOwnProperty(control_name)){var closest=target.closest('.'+control_name);if(closest.length>0){e.target=closest[0];myeventmap[control_name](e);}}}};},doRegisterHandler:function(el,event_type,fn,control_name){var ndx=this.observing.indexOf(el);if(ndx==-1){ndx=this.observing.push(el)-1;this.eventmap['n'+ndx]={};}
ndx='n'+ndx;if(!this.eventmap[ndx][event_type]){this.eventmap[ndx][event_type]={'control_types':{}};this.eventmap[ndx][event_type]['realhandler']=this.registerEventDispatcher(this.eventmap[ndx][event_type]['control_types']);jQuery(el)[event_type](this.eventmap[ndx][event_type]['realhandler']);}
this.eventmap[ndx][event_type]['control_types'][control_name]=fn;},doTearDownHandler:function(el,event_type,control_name){var ndx=this.observing.indexOf(el);if(ndx>-1){ndx='n'+ndx;if(this.eventmap[ndx]&&this.eventmap[ndx][event_type]){if(this.eventmap[ndx][event_type]['control_types'][control_name]){delete this.eventmap[ndx][event_type]['control_types'][control_name];var clearthis=true;for(var nm in this.eventmap[ndx][event_type]['control_types']){if(this.eventmap[ndx][event_type]['control_types'].hasOwnProperty(nm)){clearthis=false;break;}}
if(clearthis)jQuery(el).unbind(event_type,this.eventmap[ndx][event_type]['realhandler']);}}}}};var GawkerAuth={user:null,site:null,geoip:'',authenticated:false,action_url:'/?op=ajax_userstate',xhr:null,levels:['removedusers','pendingusers','maybeusers','users','commenters','starcommenters','commentadmins','authors','editors','superusers'],getUserState:function(){this.xhr=new XHR({klass:'auth','type':'GET',error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});var rev=jQuery.cookie('usrev');if(!rev){rev=this.resetRevision();}
this.xhr.send(this.action_url+'&r='+rev,{});},resetRevision:function(){var rev=Math.floor(Math.random()*100000);jQuery.cookie('usrev',rev,{path:'/',expires:30});return rev;},handleAjaxFail:function(xr,errorcode){switch(errorcode){case'timeout':default:EventDispatcher.notify({'name':'user.auth.failure','source':this});break;};},handleAjaxSuccess:function(data){this.authenticated=false;if(data['action']=='userstate'){this.site=data['site']?data['site']:null;this.geoip=data['geoip']?data['geoip']:'N/A';if(data['success']==true){this.authenticated=true;this.user=data['user'];EventDispatcher.notify({'name':'user.auth.success','source':this});}else{EventDispatcher.notify({'name':'user.auth.failure','source':this});}}else{EventDispatcher.notify({'name':'user.auth.failure','source':this});}},hasLevel:function(level,siteId){siteId=siteId?siteId:'current';return(jQuery.inArray(level,this.levels)==-1?false:(jQuery.inArray(this.user.level[siteId],this.levels)>=jQuery.inArray(level,this.levels)));},fbWhenReady:function(callback_function){FB.Facebook.get_sessionWaitable().waitUntilReady(function(){this.fb_sess=FB.Facebook.apiClient.get_session();FB.Facebook.apiClient.users_getInfo(this.fb_sess['uid'],['name'],function(result,ex){this.fb_user=result;try{this.fb_user=this.fb_user[0];if(this.fb_user.uid)callback_function();}catch(e){Logger.debugLog(e);}}.bind(this));}.bind(this));}};GawkerAuth.getUserState();var CommonDialogs={groups:{},initDialogs:function(params){if(!params['group'])params['group']='default';if(!this.groups[params['group']]){this.groups[params['group']]={'overlay':{'el':params['overlay']?params['overlay']:null,'show':params['showOverlay']?params['showOverlay']:function(args){var jwindow=jQuery(window);args.el.css({'height':jwindow.height(),'opacity':0.8}).fadeIn(500,args['callback']?args['callback']:null);},'hide':params['hideOverlay']?params['hideOverlay']:function(args){args.el.fadeOut(500,args['callback']?args['callback']:null);}},'state':'no_dialog','panels':{}};}
if(!params['panels'])params['panels']={};for(var pn in params['panels']){if(params['panels'].hasOwnProperty(pn)){this.groups[params['group']].panels[pn]={'el':params['panels'][pn]['el']['get']?params['panels'][pn]['el']:jQuery(params['panels'][pn]['el']),'focus':params['panels'][pn]['focus']?params['panels'][pn]['focus']:null,'show':params['panels'][pn]['show']?params['panels'][pn]['show']:function(args){var jwindow=jQuery(window);var lft=Math.ceil((jwindow.width()-args.el.width())/2);var tp=Math.ceil((jwindow.height()-args.el.height())/2);args.el.css({'left':lft,'top':'100px'}).fadeIn(500,args['callback']?args['callback']:null);},'hide':params['panels'][pn]['hide']?params['panels'][pn]['hide']:function(args){args.el.fadeOut(500,args['callback']?args['callback']:null);}};}}},toggleDialog:function(params){if(!params)params={};var jwindow=jQuery(window);if(!params['group'])params['group']='default';if(this.groups[params['group']]){var whichpanel=this.groups[params['group']].panels[params['which']];if(this.groups[params['group']].state=='no_dialog'){if(this.groups[params['group']].panels[params['which']]){this.groups[params['group']].panels[params['which']].show({'el':this.groups[params['group']].panels[params['which']].el,'callback':function(){if(whichpanel['focus'])whichpanel.focus.focus();if(params['sync_this'])params['sync_this']();}});this.groups[params['group']].overlay.show({'el':this.groups[params['group']].overlay.el});this.groups[params['group']].state='active:'+params['which'];}}else{var oldpanel=this.groups[params['group']].state.split(':').pop();if(oldpanel==params['which']||!params['which']){this.groups[params['group']].panels[oldpanel].hide({'el':this.groups[params['group']].panels[oldpanel].el,'callback':params['sync_this']});this.groups[params['group']].overlay.hide({'el':this.groups[params['group']].overlay.el});this.groups[params['group']].state='no_dialog';}else{this.groups[params['group']].panels[oldpanel].hide({'el':this.groups[params['group']].panels[oldpanel].el,'callback':function(){whichpanel.show({'el':whichpanel.el,'callback':function(){if(whichpanel['focus'])whichpanel.focus.focus();if(params['sync_this'])params['sync_this']();}});}});this.groups[params['group']].state='active:'+params['which'];}}}
return'will_sync';}};return{options:{'effectsSlideSpeed':300},auth:GawkerAuth,commondialogs:CommonDialogs,mystate:'init',_init:function(){if(this.options.externalElement){var exts=jQuery(this.options.externalElement);for(var i=0,l=exts.length;i<l;i++)
{this.element.push(exts.get(i));}}
this._effect_queue=[];this._effect_busy=false;this.setControls();this.initialize();Logger.debugLog(this.widgetName+' init done');},inState:function(whichstate){return(0==this.mystate.indexOf(whichstate));},registerEventHandler:function(for_element,eventType,fn){if(!for_element.get)
{for_element=[for_element];}
for(var i=0,l=for_element.length;i<l;i++)
{DOMEventDispatcher.doRegisterHandler(for_element[i],eventType,fn,this.getControlClass());}},tearDownEventHandler:function(for_element,eventType){if(!for_element.get)
{for_element=[for_element];}
for(var i=0,l=for_element.length;i<l;i++)
{DOMEventDispatcher.doTearDownHandler(for_element[i],eventType,this.getControlClass());}},getControlClass:function(){return this.options.controlClass?this.options.controlClass:'control';},fireEvent:function(event,attributes,synced){if(!synced)synced=false;if(this.options[event]){try{if(synced)this.syncEffect({'el':this.options,'fn':event,'params':attributes});else return this.options[event](attributes);}catch(e){return null;}}else return null;},syncEffect:function(synced_effect){if(synced_effect){this._effect_queue.push(synced_effect);}else this._effect_busy=false;if(!this._effect_busy&&this._effect_queue.length>0){var first_in_row=this._effect_queue.shift();this._effect_busy=true;var will_sync=false;if(first_in_row['params']){will_sync=(first_in_row.el[first_in_row['fn']](first_in_row['params'])=='will_sync');}else{first_in_row.el[first_in_row['fn']]();}
if(!will_sync)this.syncEffect();}},raiseEvent:function(name,params){var ev={'name':name,'source':this,'params':params};if(this.notifyOnly)ev['notifyOnly']=this.notifyOnly;EventDispatcher.notify(ev);},subscribeForEvent:function(what,fn,last_n){return EventDispatcher.subscribe(what,fn,last_n,this);},setControls:function(){this.controls={};var controlElements=jQuery('.'+this.getControlClass(),this.element);var controlNames={};for(var i=0,l=controlElements.length;i<l;i++){controlNames[this.getParam('cn',controlElements.eq(i))]=1;}
for(var controlName in controlNames){if(controlNames.hasOwnProperty(controlName)){this.controls[controlName]=jQuery('.cn_'+controlName,this.element);}}},getParam:function(paramName,element){if(element==undefined){element=this.element;}
element=jQuery(element);var classNames=element.attr('class').split(' ');for(var i=0,l=classNames.length;i<l;i++){if(classNames[i].indexOf(paramName+'_')==0){return classNames[i].split('_').slice(1).join('_');}}
return null;},setParam:function(paramName,value,element){if(element==undefined){element=this.element;}
var actualValue=this.getParam(paramName,element);if(actualValue!=null){element.removeClass(paramName+'_'+actualValue);}
element.addClass(paramName+'_'+value);},hideWidget:function(){this.element.hide();},showWidget:function(){this.element.show();},toggleIndicator:function(){if(this.controls&&this.controls.indicator)
{this.controls.indicator.toggle();}},isEnabled:function(){return(!this.option('disabled'));}};}());var GawkerClientside={version:'0.4_jQuery',widgets:{},pushWidget:function(wtype,winstance){if(winstance){if(this.widgets[wtype])this.widgets[wtype].push(winstance);else this.widgets[wtype]=[winstance];}}};var GanjaDate={refineDate:function(date)
{if(date==undefined)
{date=new Date();}
var retval={hours:this.zeroPad(date.getHours(),2),minutes:this.zeroPad(date.getMinutes(),2),seconds:this.zeroPad(date.getSeconds(),2),milliseconds:this.zeroPad(date.getMilliseconds(),3),time:date.getTime()};retval.MSm=retval.minutes+':'+retval.seconds+'.'+retval.milliseconds;retval.HMSm=retval.hours+':'+retval.MSm;return retval;},zeroPad:function(value,digits){value=value.toString();while(value.length<digits){value='0'+value;}
return value;}};var Logger={enabled:false,buffer:[],previousDate:GanjaDate.refineDate(),debugLog:function(msg)
{if(this.enabled||jQuery.cookie('GanjaDebug')=='on')
{try
{var date=GanjaDate.refineDate();var delta=GanjaDate.refineDate(new Date(date.time-this.previousDate.time));this.previousDate=date;if(typeof(msg)=='object')
{this.writeLog(date.HMSm+' [+'+delta.MSm+'] =>');this.writeLog(msg);}
else
{this.writeLog(date.HMSm+' [+'+delta.MSm+'] '+msg);}}
catch(e){};}},writeLog:function(msg){if(console&&console.log)
{console.log(msg);}
else
{var consoleText=jQuery('#console');if(consoleText.length>0)
{consoleText.show();if(this.buffer.length>0)
{var buffer=this.buffer;this.buffer=[];for(var i=0,l=buffer.length;i<l;i++)
{consoleText.append(buffer[i]+'<br />');}}
consoleText.append(msg+'<br />');}
else
{this.buffer.push(msg);}}}};var settings={scan_interval:1500,widgets:{}};var Validator=GawkerBase.extend({options:{scope:null,validators:{'valid_minlen':function(value,len){return value.length>=parseInt(len,10);},'valid_maxlen':function(value,len){return value.length<=parseInt(len,10);},'valid_nonempty':function(value){var regex=/^[\s\S]+$/;return regex.test(value);},'valid_alpha':function(value){return(value==''||/^[a-zA-Z]+$/.test(value));},'valid_alphanum':function(value){return(value==''||/^\W+$/.test(value));},'valid_number':function(value){return(value==''||/^\d+$/.test(value));},'valid_email':function(value){return(value==''||/\w{1,}[@](([\w\-]{1,}[.])){1,}([\w\-]{2,})$/.test(value));},'valid_emails_comma':function(value){if(value=='')return true;else{var parts=value.split(',');var ret=true;for(var i=0,l=parts.length;i<l;i++){var trimmed=parts[i].trim();ret=ret&&(trimmed==''||/\w{1,}[@](([\w\-]{1,}[.])){1,}([\w\-]{2,})[,]?$/.test(trimmed));}
return ret;}},'valid_unique_comma':function(value){if(value=='')return true;else{var parts=value.split(',');var ret=true;var unique={};for(var i=0,l=parts.length;i<l;i++){var trimmed=parts[i].trim();if(unique['u'+trimmed]){ret=false;break;}else unique['u'+trimmed]=true;}
return ret;}},'valid_limit_comma':function(value,limit){if(value=='')return true;else{limit=parseInt(limit,10);var parts=value.split(',');if(parts.length<=limit)return true;else return false;}},'valid_url':function(value){return(value==''||/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i.test(value));},'valid_date':function(value){var regex=/^(\d{2})\/(\d{2})\/(\d{4})$/;if(!regex.test(value))return false;var d=new Date(value.replace(regex,'$1/$2/$3'));return(parseInt(RegExp.$1,10)==(1+d.getMonth()))&&(parseInt(RegExp.$2,10)==d.getDate())&&(parseInt(RegExp.$3,10)==d.getFullYear());},'valid_sameas':function(value,other_input_id){return value==this.options.scope[0][other_input_id].value;}},effects:{},infields:[],defaultEffects:function(el){return[function(){jQuery(el).show();},function(){jQuery(el).hide();}];}},initialize:function(options){this.errorlist={};this.errorlist_visible={};this.input_fields={};this.setOptions(options);this.options.infields=jQuery('.validate',this.options.scope[0]);for(var i=0,l=this.options.infields.length;i<l;i++){this.setupInfield(this.options.infields[i]);}},setupInfield:function(el){this.input_fields[el.name]={};var errClassPart=el.name.replace(/\[/,'_').replace(/\]/,'');var errdivs=jQuery('.'+errClassPart+'_validmsg',this.options.scope[0]);for(var i=0,l=errdivs.length;i<l;i++){this.setupErrorDiv(errdivs[i],el);}},setupErrorEffects:function(el,key,validator){var getFn=this.options.defaultEffects;if(this.options.effects[key]){switch($type(this.options.effects[key])){case'function':getFn=this.options.effects[key];break;case'object':if(this.options.effects[key][validator])getFn=this.options.effects[key][validator];break;}}
var functions=getFn(el);return{show:functions[0],hide:functions[1]};},setupErrorDiv:function(el,parentinput){for(var validator_name in this.options.validators){if(this.options.validators.hasOwnProperty(validator_name)){if(el.className.indexOf('msg_'+validator_name)>-1){this.input_fields[parentinput.name][validator_name]=this.setupErrorEffects(el,parentinput.name,validator_name);}}}},testRule:function(params,value){var bindfn=this.options.validators[params[0]].bind(this);return bindfn(value,params[1]);},validate:function(){var success=true;this.errorlist={};for(var i=0,l=this.options.infields.length;i<l;i++){var rules=this.options.infields[i].className.split(' ');inner_cycle:for(var j=0,k=rules.length;j<k;j++){var params=rules[j].split('-');if(this.options.validators.hasOwnProperty(params[0])){var result=this.testRule(params,this.options.infields[i].value);success=success&&result;if(!result){this.errorlist[this.options.infields[i].name]={input_el:this.options.infields[i],failed_validator:params[0]};break inner_cycle;}}}}
return success;},hideErrors:function(){for(var name in this.errorlist_visible){if(this.errorlist_visible.hasOwnProperty(name)&&this.errorlist_visible[name]){this.input_fields[this.errorlist_visible[name].input_el.name][this.errorlist_visible[name].failed_validator].hide();}}
this.errorlist_visible={};return this;},showErrors:function(){var merged=jQuery.extend(this.errorlist,this.errorlist_visible);var focus_set=false;for(var name in merged){if(this.errorlist.hasOwnProperty(name)){if(this.errorlist_visible[name])
{var res=this.input_fields[this.errorlist_visible[name].input_el.name][this.errorlist_visible[name].failed_validator].hide();if(res&&res.chain)res.chain(this.input_fields[this.errorlist[name].input_el.name][this.errorlist[name].failed_validator].show);else this.input_fields[this.errorlist[name].input_el.name][this.errorlist[name].failed_validator].show();}
else
{this.input_fields[this.errorlist[name].input_el.name][this.errorlist[name].failed_validator].show();}
this.errorlist_visible[name]=this.errorlist[name];if(!focus_set){try{this.errorlist[name]['input_el'].focus();focus_set=true;}catch(e){}}}else{if(this.errorlist_visible[name])this.input_fields[this.errorlist_visible[name].input_el.name][this.errorlist_visible[name].failed_validator].hide();this.errorlist_visible[name]=undefined;}}
return this;},clearErrors:function(){this.hideErrors();this.errorlist={};return this;}});(function($){$.widget('ui.AdRobot',{initialize:function(){this.pageparams=this.options['pageparams'];this.userlocation=this.options['userlocation'];this.ad_kw=this.parseReferrer(document.referrer);if(window.location.search.length>0){var pts=window.location.search.split('country=');if(pts.length>1)this.userlocation.country=pts[1].split('&')[0].toLowerCase();pts=window.location.search.split('dma=');if(pts.length>1)this.userlocation.dma_code=pts[1].split('&')[0];pts=window.location.search.split('adzonesdebug=');if(pts.length>1)this.debug_mode=(pts[1].split('&')[0]==='true'?true:false);pts=window.location.search.split('kw=');if(pts.length>1)this.ad_kw=pts[1].split('&')[0];}
this.ad_kw_dbl=this.ad_kw?(';kw='+this.ad_kw):'';this.greychecklist=[];this.evalSkin();this.evalTagTargeting();jQuery('document').ready(this.changeDocWrite.bind(this));},evalSkin:function(){var skin_id=0;var fromset=[];var prefer_skins=jQuery.cookie('prefer_skins');prefer_skins=prefer_skins?prefer_skins.split(','):[];for(var i=0,l=this.pageparams.skins.map.length;i<l;i++){if(this.pageparams.skins.map[i]['data'][this.userlocation.country]){if(this.pageparams.skins.map[i]['data'][this.userlocation.country]['d'+this.userlocation.dma_code]){fromset.push({'data':this.pageparams.skins.map[i]['data'][this.userlocation.country]['d'+this.userlocation.dma_code],'clustername':this.pageparams.skins.map[i]['clustername']});}else{fromset.push({'data':this.pageparams.skins.map[i]['data'][this.userlocation.country]['any'],'clustername':this.pageparams.skins.map[i]['clustername']});}}
fromset.push({'data':this.pageparams.skins.map[i]['data']['any']['any'],'clustername':this.pageparams.skins.map[i]['clustername']});}
for(var i=0,l=fromset.length;i<l;i++){var last_shape={};for(var tm in fromset[i]['data']){if(fromset[i]['data'].hasOwnProperty(tm)){var tm_int=parseInt(tm.split('t')[1],10);if(tm_int<this.userlocation.t)last_shape=fromset[i]['data'][tm];else break;}}
for(var skid in last_shape){if(last_shape.hasOwnProperty(skid)&&prefer_skins.indexOf(skid)>=0){skin_id=skid;break;}}
if(!skin_id)skin_id=this.evalProbs(last_shape);if(skin_id)break;}
this.myskin=skin_id?this.pageparams.skins.items[skin_id]:false;if(this.myskin&&prefer_skins.indexOf(skin_id)<0){prefer_skins.push(skin_id);jQuery.cookie('prefer_skins',prefer_skins.toString(),{'expires':new Date((this.userlocation.t+1800)*1000),'path':'/'});}
if(this.debug_mode)Logger.debugLog(this.myskin);return this.myskin;},evalTagTargeting:function(){this.mytt=false;outer:for(var i=0,l=this.pageparams.tts.override.length;i<l;i++){for(var n in this.pageparams.tts.override[i]['data']){if(this.pageparams.tts.override[i]['data'].hasOwnProperty(n)){if(this.pageparams.tts.override[i]['data'][n].s<this.userlocation.t&&this.pageparams.tts.override[i]['data'][n].e>this.userlocation.t){this.mytt=this.pageparams.tts.items[n];this.mytt['id']=n;break outer;}}}}
if(this.debug_mode)Logger.debugLog(this.mytt);return this.mytt;},evalProbs:function(shape){var rnd=Math.random();var sum=0;for(var n in shape){sum=sum+shape[n];if(sum>rnd)return n;}
return false;},setCSS:function(){if(this.myskin){if(this.myskin['dir']){try{var link_el=document.createElement("link");jQuery(link_el).attr({'type':'text/css','href':this.pageparams.assets_host+'/assets/'+this.myskin['dir']+'/css/style.css','rel':'stylesheet'}).appendTo('head');}catch(e){}}}},getParentFromMarkup:function(upper){upper=upper?upper:0;var allscript=jQuery('script');return allscript.eq(allscript.length-1).parents().eq(upper);},writeHTML:function(key,upper){upper=upper?upper:0;if(this.myskin&&this.myskin.templates[key]){var havecontent=this.myskin.templates[key].length?true:false;document.write(this.myskin.templates[key]);if(this.myskin.templates[key+'_script']&&this.myskin.templates[key+'_script'].length){havecontent=true;try{eval('function(){'+this.myskin.templates[key+'_script']+'}();');}catch(e){}}
if(havecontent)this.getParentFromMarkup(upper+1).removeClass('no-'+key);}},renderAd:function(key,upper){upper=upper?upper:0;if(this.pageparams.adzones.adzones[key]){if(this.myskin){if(this.myskin.zones[key])this.pageparams.adzones.adzones[key]=jQuery.extend(this.pageparams.adzones.adzones[key],this.myskin.zones[key]);}else{if(this.mytt&&this.mytt.zones[key])this.pageparams.adzones.adzones[key]=jQuery.extend(this.pageparams.adzones.adzones[key],{'state':this.mytt.zones[key],'zone':this.mytt.override});}
this.writeAdUnit(this.pageparams.adzones.adzones[key],key,upper);}},renderPostmetaAd:function(key,postid,upper,force_zone){upper=upper?upper:0;force_zone=force_zone?force_zone:false;if(force_zone){this.writeAdUnit({'state':'on','zone':force_zone,'size':'300x40','postid':postid},key,upper);}else{if(this.pageparams.tts.postmetamap['p'+postid]){for(var n in this.pageparams.tts.postmetamap['p'+postid]){if(this.pageparams.tts.postmetamap['p'+postid].hasOwnProperty(n)){if(!(this.mytt&&this.mytt.id==n)){if(this.pageparams.tts.postmetamap['p'+postid][n]['s']<this.userlocation.t&&this.pageparams.tts.postmetamap['p'+postid][n]['e']>this.userlocation.t){if(this.pageparams.tts.items[n].zones[key]){this.writeAdUnit(jQuery.extend({},this.pageparams.adzones.adzones[key],{'state':this.pageparams.tts.items[n].zones[key],'zone':this.pageparams.tts.items[n]['override'],'postid':postid}),key,upper);return true;}}}}}}}},writeAdUnit:function(params,key,upper){var stuffthis='';if(this.auth.authenticated){stuffthis+=';commenter=yes';if(this.auth.hasLevel('starcommenters'))stuffthis+=';star=yes';}
if(!this.ad_ptile)this.ad_ptile=1;if(!this.ad_random)this.ad_random=Math.ceil(Math.random()*100000000);var cont={};if(this.canvas)cont=jQuery('#postmeta_ad_'+params['postid']);else cont=this.getParentFromMarkup();var adcontext={'cont':cont,'parent':cont.parents().eq(upper),'key':key};var myclass='no-'+key;if(key=='postmeta')myclass='no_ad';if(params['state']==='on'){this.greychecklist.push(adcontext);if(this.debug_mode){document.write('<pre>site:'+this.pageparams.adzones.site+'\nzone:'+params['zone']+stuffthis+'\nsize:'+params['size']+'\nkw:'+this.ad_kw+'</pre>');}else{var src='http://ad.doubleclick.net/adj/'+this.pageparams.adzones.site+'/'+params['zone']+stuffthis+';ptile='+this.ad_ptile+';sz='+params['size']+';ord='+this.ad_random+this.ad_kw_dbl+'?';document.write('<script type="text/javascript" src="'+src+'"></script>');}
if(this.canvas)document.write('<script type="text/javascript">adRobot.sureWrite("#postmeta_ad_'+params['postid']+'");</script>');adcontext.parent.removeClass(myclass);return true;}else{adcontext.parent.addClass(myclass);return false;}},renderAdOrAdsense:function(key,upper,params){if(!this.ad_kw)this.renderAd(key,upper);else this.renderGoogleAdsense(params);},renderGoogleAdsense:function(params){var go_render=true;params['withreferrer']=params['withreferrer']?params['withreferrer']:false;if(params['withreferrer'])go_render=(this.ad_kw&&this.ad_kw!=='');if(go_render){if(typeof google_adnum=='undefined')google_adnum=0;var myadrobot=this;google_ad_client=params['ad_client']?params['ad_client']:'pub-0457527031304647';google_ad_channel=params['ad_channel']?params['ad_channel']:'2723851389';google_ad_output='js';google_max_num_ads=params['max_num_ads']?params['max_num_ads']:3;google_hints=params['kw']?params['kw']:this.ad_kw;google_kw=params['kw']?params['kw']:this.ad_kw;google_ad_type=params['ad_type']?params['ad_type']:'text';google_image_size=params['size'];google_feedback='on';google_kw_type='broad';google_language='en';google_skip=google_adnum;this.google_ad_render_mode=params['render_mode']?params['render_mode']:'perma300';google_ad_request_done=function(google_ads){myadrobot.finishGoogleAds(google_ads);};document.write('<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>');}else{if(params['hidethis'])jQuery(params['hidethis']).hide();}},finishGoogleAds:function(google_ads){if(google_ads.length){var s='';if(this.google_ad_render_mode=='perma300')s+='<h3>Ads by Google</h3>';else s+='<span class="sponsored-link"><a href=\"'+google_info.feedback_url+'\" style="color:000000">Ads by Google</a></span><br/>';for(var i=0,l=google_ads.length;i<l;i++){if(this.google_ad_render_mode=='commentsinterruptor')s+='<div style="float:left;width:240px;margin-bottom:15px">';else s+='<div style="margin-bottom: 8px; line-height:1.3em">';s+='<a style="text-decoration:';if(this.google_ad_render_mode=='perma300')s+='underline;';else s+='none;';s+='" href="'+
google_ads[i].url+'" onmouseout="window.status=\'\'" onmouseover="window.status=\'go to '+
google_ads[i].visible_url+'\';return true"> <span> <b>'+
google_ads[i].line1+'</b></span></a>';if(this.google_ad_render_mode=='perma300')s+='<br />';s+='<span';if(this.google_ad_render_mode=='commentsinterruptor'){s+=' style="line-height:1.4em;">'+google_ads[i].line2+'<br />';}else{s+='>';if(this.google_ad_render_mode=='post_gallery')s+=google_ads[i].line2+' ';}
s+=google_ads[i].line3+'</span>';if(this.google_ad_render_mode=='commentsinterruptor'||this.google_ad_render_mode=='perma300')s+='<br />';s+='<span><a style="color:#666;" href="'+
google_ads[i].url+'" onmouseout="window.status=\'\'" onmouseover="window.status=\'go to '+
google_ads[i].visible_url+'\';return true">'+
google_ads[i].visible_url+'</span></a>';if(this.google_ad_render_mode=='commentsinterruptor')s+='<br />';s+='</div>';}
if(google_ads[0].bidtype=="CPC")google_adnum=google_adnum+google_ads.length;document.write(s);}},filterGrays:function(){for(var i=0,l=this.greychecklist.length;i<l;i++){if(this.greychecklist[i]['key'].split('tracker').length<2){if(this.testForGrey(this.greychecklist[i]['cont'])){var myclass='no-'+this.greychecklist[i]['key'];if(this.greychecklist[i]['key']=='postmeta')myclass='no_ad';this.greychecklist[i]['parent'].addClass(myclass);Logger.debugLog(this.greychecklist[i]['cont']);}}}
this.greychecklist=[];this.dropInterruptor();},testForGrey:function(dv){var images_under=jQuery('img',dv);for(var i=0,l=images_under.length;i<l;i++){if(images_under[i].src&&images_under[i].src.match(/817-grey.gif/))return true;}
return false;},dropInterruptor:function(){var lst=jQuery(this.options.postlist_class);var ref_el=jQuery('#'+this.options.reference_id)
var interruptor_el=jQuery('#'+this.options.interruptor_id);if(ref_el.length&&interruptor_el.length){var ref_h=ref_el.offset().top+ref_el.height();var ref_post=null;for(var i=0,l=lst.length;i<l;i++){if(ref_h<jQuery(lst[i]).offset().top&&!(jQuery(lst[i]).prev().hasClass('dateHeadline')||jQuery(lst[i]).prev().hasClass('highlite'))){lst[i].parentNode.insertBefore(interruptor_el[0].parentNode.removeChild(interruptor_el[0]),lst[i]);break;}}}},changeDocWrite:function(){if(jQuery('#canvas').length==0){jQuery(document.createElement('div')).attr('id','canvas').hide().appendTo('body');}
this.canvas=jQuery('#canvas');var canvas=this.canvas;document.write=function(t){var parts=t.split('<script');var id=0;for(var i=0,l=parts.length;i<l;i++){if(i%2==1)parts[i]='<script'+parts[i];canvas.append(parts[i]);}}},sureWrite:function(where){if(this.canvas&&where){where=jQuery(where);where.append(this.canvas.html());this.canvas.html('');this.filterGrays();}},more:function(settings){if(settings&&settings['tts']){this.pageparams.tts['items']=jQuery.extend(this.pageparams.tts['items'],settings.tts['items']);this.pageparams.tts['postmetamap']=jQuery.extend(this.pageparams.tts['postmetamap'],settings.tts['postmetamap']);}},parseReferrer:function(str){var kw=false;var r=/google\.\w{2,3}(?:\.\w{2,3})*/;if(r.test(str)||str.split(window.location.hostname).length>1){var parts=str.split('q=');if(parts.length>1)kw=parts[1].split('&')[0];else{parts=str.split('search/');if(parts.length>1)kw=parts[1].split('/')[0];}}else{r=/search\.yahoo\.\w{2,3}(?:\.\w{2,3})*/;if(r.test(str)){var parts=str.split('p=');if(parts.length>1)kw=parts[1].split('&')[0];}}
return kw;}});$.extend($.ui.AdRobot,{'version':'1.0','defaults':{'interruptor_id':'interruptor','postlist_class':'li.post','reference_id':'siteInfo','have_to_drop':false}});})(jQuery);(function($){$.widget('ui.BuddyToggleWidget',{xhr:null,initialize:function(){this.xhr=new XHR({klass:'buddytoggle',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));this.subscribeForEvent('comment.commentlistupdated',this.commentListEventHandler.bind(this));},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':this.showWidget();break;case'user.auth.failure':this.hideWidget();break;}},commentListEventHandler:function(ev){if(ev.name=='comment.commentlistupdated'&&this.auth.authenticated)this.showWidget();},handleClick:function(e){var target=jQuery(e.target);if(target.hasClass('user-friend-remove'))
{this.toggleBuddyStatus(this.getParam('buddyid',target),'remove');e.stopPropagation();e.preventDefault();}
else if(target.hasClass('user-friend-follow')){this.toggleBuddyStatus(this.getParam('buddyid',target),'follow');e.stopPropagation();e.preventDefault();}},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){jQuery('.buddyid_'+data.objectId).removeClass('user-friend-progress');this.toggleIcons('.buddyid_'+data.objectId);this.auth.resetRevision();},handleAjaxFail:function(){jQuery('.user-friend-progress').removeClass('user-friend-progress');},toggleBuddyStatus:function(buddyId,status){var params={'op':'saveusertag','objectType':'USER','objectId':buddyId};if(status=='follow'){params.tagName='buddy';}
else if(status=='remove'){params.unTagName='buddy';}
jQuery('.buddyid_'+buddyId).addClass('user-friend-progress');this.xhr.send('/index.php',params);},hideWidget:function(){jQuery('.user-friend-follow').hide();},showWidget:function(){if(this.auth.authenticated){jQuery('.user-friend-follow').not('.buddyid_'+this.auth.user.id).show();if(this.auth.user.buddies){for(var i=0,l=this.auth.user.buddies.length;i<l;i++)
{var selection=jQuery('.buddyid_'+this.auth.user.buddies[i]);for(var ii=0,ll=selection.length;ii<ll;ii++)
{selection[ii].style.display=(0==ii%2)?'':'none';}}}}},toggleIcons:function(selector)
{icons=jQuery(selector);for(var i=0,l=icons.length;i<l;i++)
{icons[i].style.display=('none'==icons[i].style.display)?'':'none';}},resetWidget:function(){}});$.extend($.ui.BuddyToggleWidget,{'version':'1.0','defaults':{'action_url':'/index.php','controlClass':'buddycontrol'}});})(jQuery);jQuery.extend(settings.widgets,{commentadmin:{klass:'CommentAdminWidget',byselector:{'.commenter_admin':{'options':{onInit:function(args){args.widget.subscribeForEvent('user.auth.',args.widget.handleAuth.bind(args.widget));args.widget.subscribeForEvent('comment.commentlistloaded',args.widget.showWidget.bind(args.widget));args.widget.subscribeForEvent('comment.commentlistupdated',args.widget.refreshWidget.bind(args.widget));},onClick:function(args){var target=jQuery(args.e.target);args.widget.commentParams.toolContainer=target.parent();args.widget.commentParams.paramsContainer=target.closest('.comment');if(args.widget.commentParams.paramsContainer.length==0){args.widget.commentParams.messageContainer=args.widget.controls.message;args.widget.commentParams.commentId='';args.widget.commentParams.commenterId=args.widget.getParam('uId');}
else
{args.widget.commentParams.messageContainer=jQuery('.please_leave_a_message',args.widget.commentParams.paramsContainer);args.widget.commentParams.siteId=args.widget.auth.site.siteId;args.widget.commentParams.commentId=args.widget.getParam('commentid',args.widget.commentParams.paramsContainer);args.widget.commentParams.commenterId=args.widget.getParam('authorid',args.widget.commentParams.paramsContainer);args.widget.commentParams.rootCommentId=args.widget.getParam('rootcommentid',args.widget.commentParams.paramsContainer);args.widget.commentParams.postId=args.widget.getParam('postid',args.widget.commentParams.paramsContainer);}
var controlName=args.widget.getParam('cn',target);switch(controlName){case'comment_admin_disemvowelcomment':args.widget.disemvowelComment();args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_promotecomment':args.widget.promoteComment();args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_changecommentstatus':args.widget.changeCommentStatus(args.widget.getParam('status',target));args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_userlist':document.location='/index.php?op=userlist_search&id='+args.widget.commentParams.commenterId+'&siteId='+args.widget.auth.site.siteId;args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_setstarcommenter':args.widget.setStarCommenter(args.widget.getParam('star',target));args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_toggleadminlinks':args.widget.toggleAdminLinks(target);args.e.stopPropagation();args.e.preventDefault();break;case'approvecommenter':args.widget.changeUserStatus('approve');args.e.stopPropagation();args.e.preventDefault();break;case'promotemoderator':args.widget.changeUserStatus('commenteradmin');args.e.stopPropagation();args.e.preventDefault();break;case'bancommenter':args.widget.changeUserStatus('remove');args.e.stopPropagation();args.e.preventDefault();break;case'promotethread':args.widget.changeCommentPriority(1);args.e.stopPropagation();args.e.preventDefault();break;case'demotethread':args.widget.changeCommentPriority(0);args.e.stopPropagation();args.e.preventDefault();break;}},onMouseOver:function(args){},onChange:function(args){},onChangeCommentStatus:function(args){Message.showMessage(args.messageText,args.widget.commentParams.messageContainer[0],{stable:true});args.widget.xhr.send('/index.php',{'op':'changecommentstatus','id':args.widget.commentParams.commentId,'entry_id':args.widget.commentParams.postId,'publishStatus':args.publishStatus,'user_id':args.widget.commentParams.commenterId});},onChangeCommentPriority:function(args){Message.showMessage(args.messageText,args.widget.commentParams.messageContainer[0],{stable:false});args.widget.xhr.send('/index.php',{'op':'ajax_promotethread','comment_id':args.widget.commentParams.commentId,'priority':args.priority});},onChangeUserStatus:function(args){jQuery('#admin-links-'+args.widget.commentParams.commentId).hide();Message.showMessage(args.messageText,args.widget.commentParams.messageContainer[0],{stable:true});args.widget.xhr.send('/index.php',{'op':'changeuserstatus','action':args.action,'siteId':args.widget.commentParams.siteId,'postId':args.widget.commentParams.postId,'commentId':args.widget.commentParams.commentId,'id':args.widget.commentParams.commenterId});},onAjaxSuccess:function(args){var control={};var message='';switch(args.data.action)
{case'disemvowelcomment':if(args.data.success==true){if(args.data.commentText){jQuery('#comments .commentid_'+args.data.commentId+' .commenttexteditable').html(args.data.commentText);}
message='Success';}else{message='Disemvowel failed';}
break;case'changecommentstatus':if(args.data.success==true){switch(args.data.publishStatus){case'DELETED':jQuery('.commentid_'+args.data.commentId).hide();if(jQuery('.commentid_'+args.data.commentId).closest('.threadwrapper_invisible').prev().eq(0)[0].tagName=='H2')
{jQuery('.commentid_'+args.data.commentId).closest('.threadwrapper_invisible').prev().hide();}
break;case'PUBLISHED':jQuery('.commentid_'+args.data.commentId).removeClass('commentstate_draft');jQuery('.commentid_'+args.data.commentId+' .approvedBy').html('<a href="/people/'+args.widget.auth.user.username+'">'+args.widget.auth.user.smartName+'</a> approved this comment');jQuery('.commentid_'+args.data.commentId+' .metatext').show();if(args.data.userapproved==true){args.widget.raiseEvent('comment.userapproved',{'commenterId':args.data.commenterId,'commentId':args.data.commentId});}
break;}
message=args.data.message;}else{message='Failed setting comment status';}
break;case'promotethread':if(args.data.success==true){if(args.data.priority==0){args.widget.markCommentAsDemoted(args.data.commentId);}else{args.widget.markCommentAsPromoted(args.data.commentId);}
message=args.data.message;}else{message='Thread promotion failed';if(args.data.message){message+=': '+args.data.message;}}
break;case'removeuser':if(args.data.success==true){jQuery('#comments .authorid_'+args.data.commenterId).addClass('commenterstate_banned').removeClass('commenterstate_approved').hide();message='User banned';}else{message='Ban failed';}
break;case'approveuser':if(args.data.success==true){jQuery('#comments .authorid_'+args.data.commenterId).addClass('commenterstate_approved').removeClass('commenterstate_pending').removeClass('commentstate_draft');message='User approved';}else{message='Approve failed';}
break;case'setstarcommenter':if(args.data.success==true){jQuery('#headerData .cn_comment_admin_setstarcommenter',args.widget.element).toggleClass('star_true').toggleClass('star_false');jQuery('#comments .authorid_'+args.data.commenterId+' .cn_comment_admin_setstarcommenter').toggleClass('star_true').toggleClass('star_false');jQuery('#comments .commentid_'+args.data.commentId+' .metatext').show();if(args.data.starcommenter==true){jQuery('#comments .authorid_'+args.data.commenterId+'.commentpriority_0').removeClass('commentpriority_0').addClass('commentpriority_1');jQuery('#comments .commentid_'+args.data.commentId+' .metatext .starredBy').show();jQuery('#comments .commentid_'+args.data.commentId+' .metatext .unstarredBy').hide();}else{jQuery('#comments .authorid_'+args.data.commenterId+'.commentpriority_1').removeClass('commentpriority_1').addClass('commentpriority_0');jQuery('#comments .commentid_'+args.data.commentId+' .metatext .unstarredBy').show();jQuery('#comments .commentid_'+args.data.commentId+' .metatext .starredBy').hide();}
message=args.data.message;}else{message='Failed setting starcommenter status';}
break;}
if(message!=''&&(args.data.commentId||args.data.action=='setstarcommenter')){Message.showMessage(message,args.widget.commentParams.messageContainer[0],{stable:false,onComplete:function(){}});}},onAjaxFailure:function(args){var container=jQuery('.commentid_'+args.data.commentId);jQuery('.control',container).hide();var messageText=(args.data.message)?args.data.message:'Operation failed';Message.showMessage(messageText,args.widget.commentParams.messageContainer[0],{stable:false,onComplete:function(){jQuery('.control',container).show();}});}}},'.commenteradmin_container':{'options':{onInit:function(args){args.widget.registerEventHandler(args.widget.element,'mouseover',args.widget.handleMouseOver.bind(args.widget));args.widget.registerEventHandler(args.widget.element,'change',args.widget.handleChange.bind(args.widget));if(args.widget.controls.status_toggle)
{for(var i=0,l=args.widget.controls.status_toggle.length;i<l;i++){var userId=args.widget.getParam('uId',args.widget.controls.status_toggle[i]);args.widget.loadUserComments(userId);}}},onClick:function(args){var target=jQuery(args.e.target);args.widget.commentParams.commenterId=args.widget.getParam('uId',target);var controlName=args.widget.getParam('cn',target);switch(controlName){case'status_toggle':var userId=args.widget.getParam('uId',target);args.widget.toggleStatus(userId);args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_changecommentstatus':args.widget.commentParams.commentId=args.widget.getParam('cId',target);args.widget.commentParams.commenterId=args.widget.getParam('uId',target);args.widget.commentParams.postId=args.widget.getParam('pId',target);args.widget.changeCommentStatus(args.widget.getParam('status',target));args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_pendinguser':args.widget.changeUserStatus('pending');args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_approveuser':args.widget.changeUserStatus('approve');args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_maybeuser':args.widget.changeUserStatus('maybe');args.e.stopPropagation();args.e.preventDefault();break;case'comment_admin_removeuser':args.widget.changeUserStatus('remove');args.e.stopPropagation();args.e.preventDefault();break;case'paging':args.widget.paging(args.widget.getParam('refId',target));args.e.stopPropagation();args.e.preventDefault();break;case'search':args.widget.submitForm('searchForm');args.e.stopPropagation();args.e.preventDefault();break;}},onMouseOver:function(args){var target=jQuery(args.e.target);userId=args.widget.getParam('uId',target);var controlName=args.widget.getParam('cn',target);switch(controlName){case'userline':for(var i=0,l=args.widget.controls.userline.length;i<l;i++){var currentUserId=args.widget.getParam('uId',args.widget.controls.userline[i]);jQuery('#comments_'+currentUserId).hide();jQuery('#user_'+currentUserId)[0].style.backgroundColor='';}
jQuery('#comments_'+userId).show();jQuery('#user_'+userId)[0].style.backgroundColor='#eee';args.e.stopPropagation();args.e.preventDefault();break;}},onChange:function(args){var target=jQuery(args.e.target);var controlName=args.widget.getParam('cn',target);switch(controlName){case'includeGroup':case'siteId':case'limit':args.widget.submitForm('filterForm');break;}},onChangeCommentStatus:function(args){if(args.publishStatus=='PUBLISHED')
{jQuery('#approve_'+args.widget.commentParams.commentId)[0].innerHTML='Approving comment';}
if(args.publishStatus=='DELETED')
{jQuery('#delete_'+args.widget.commentParams.commentId)[0].innerHTML='Deleting comment';}
args.widget.xhr.send('/index.php',{'op':'changecommentstatus','id':args.widget.commentParams.commentId,'entry_id':args.widget.commentParams.postId,'user_id':args.widget.commentParams.commenterId,'publishStatus':args.publishStatus});},onChangeUserStatus:function(args){var userId=args.widget.commentParams.commenterId;jQuery('#action_indicator_'+userId).show();var params={'op':'changeuserstatus','reloadGroups':true,'action':args.action,'id':userId};if(args.widget.controls.affectedSiteId[0].value!=-1){params['siteId']=args.widget.controls.affectedSiteId[0].value;}
args.widget.xhr.send('/index.php',params);},onAjaxSuccess:function(args){var control={};switch(args.data.action)
{case'pendinguser':case'maybeuser':case'approveuser':case'removeuser':jQuery('#action_indicator_'+args.data.commenterId).hide();jQuery('#user_'+args.data.commenterId).addClass('lined');jQuery('#marker_'+args.data.commenterId).attr('class',args.data.action);jQuery('.cn_status_toggle').filter('.uId_'+args.data.commenterId)[0].innerHTML=args.data.group_label;args.widget.loadStatus(args.data.commenterId);break;case'changecommentstatus':if(args.data.publishStatus=='PUBLISHED')
{jQuery('#approve_'+args.data.commentId)[0].innerHTML=args.data.message;}
if(args.publishStatus=='DELETED')
{jQuery('#delete_'+args.data.commentId)[0].innerHTML=args.data.message;}
args.widget.loadUserComments(args.data.userId);break;}},onAjaxFailure:function(args){jQuery('#action_indicator_'+args.data.commenterId).hide();}}}}}});(function($){$.widget('ui.CommentAdminWidget',{controls:{},params:{},xhr:null,commentParams:{},initialize:function(){this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.xhr=new XHR({klass:'commentadmin',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});this.subscribeForEvent('comment.commentpromoted',this.markThreadAsPromoted.bind(this));this.subscribeForEvent('comment.userapproved',this.userApproved.bind(this));this.fireEvent('onInit',{'widget':this});},handleAuth:function(ev){switch(ev.name){case'user.auth.success':if(this.auth.hasLevel('commentadmins')){this.showWidget();}
break;case'user.auth.failure':this.hideWidget();break;}},handleClick:function(e){this.fireEvent('onClick',{'e':e,'widget':this});},handleMouseOver:function(e){this.fireEvent('onMouseOver',{'e':e,'widget':this});},handleChange:function(e){this.fireEvent('onChange',{'e':e,'widget':this});},showWidget:function(){this.setControls();if(!this.auth.authenticated){return false;}
if(this.auth.hasLevel('commentadmins')){if(this.controls.comment_admin_setstarcommenter)this.controls.comment_admin_setstarcommenter.addClass('enabled');if(this.controls.comment_admin_toggleadminlinks)this.controls.comment_admin_toggleadminlinks.show();}},hideWidget:function(){if(this.controls.comment_admin_setstarcommenter)this.controls.comment_admin_setstarcommenter.removeClass('enabled');if(this.controls.comment_admin_toggleadminlinks)this.controls.comment_admin_toggleadminlinks.hide();},refreshWidget:function(){this.setControls();this.showWidget();},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){this.fireEvent('onAjaxSuccess',{'data':data,'widget':this});},handleAjaxFail:function(data){this.fireEvent('onAjaxFailure',{'data':data,'widget':this});},promoteComment:function(){if(window.confirm('Do you really want to promote this comment to frontpage?'))
{jQuery('.control',this.commentParams.toolContainer).hide();Message.showMessage('Promoting comment',this.commentParams.messageContainer[0],{stable:true});this.xhr.send('/index.php',{'op':'promotecomment','comment_id':this.commentParams.commentId});}},markThreadAsPromoted:function(ev){this.markCommentAsPromoted(ev.params.commentId);},markCommentAsPromoted:function(commentId){var promotedComment=jQuery('#comments .commentid_'+commentId);if(promotedComment.length!=0){promotedComment.removeClass('commentpriority_0').addClass('commentpriority_1');jQuery('.promotedBy',promotedComment).html('<a href="/people/'+this.auth.user.username+'">'+this.auth.user.smartName+'</a> promoted this comment').show();jQuery('.metatext',promotedComment).show();var promotedParentId=this.getParam('parentid',promotedComment);if(promotedParentId){this.markCommentAsPromoted(promotedParentId);}}},markCommentAsDemoted:function(commentId){var demotedComment=jQuery('#comments .commentid_'+commentId);demotedComment.removeClass('commentpriority_1').addClass('commentpriority_0');jQuery('.promotedBy',demotedComment).hide();jQuery('.parentid_'+commentId).each(function(iterator,demoteComment){var demoteChildId=this.getParam('commentid',demoteComment);this.markCommentAsDemoted(demoteChildId);}.bind(this));},disemvowelComment:function(){if(window.confirm('Do you really want to disemvowel this comment?'))
{jQuery('.control',this.commentParams.toolContainer).hide();Message.showMessage('Disemvoweling comment',this.commentParams.messageContainer[0],{stable:true});this.xhr.send('/index.php',{'op':'disemvowelcomment','comment_id':this.commentParams.commentId,'root_comment_id':this.commentParams.rootCommentId,'entry_id':this.commentParams.postId});}},changeCommentStatus:function(publishStatus){if(!publishStatus||jQuery.inArray(publishStatus,['DELETED','PUBLISHED','FRONTPAGE'])==-1){return false;}
switch(publishStatus){case'DELETED':var msg='Comment removed';break;case'PUBLISHED':case'FRONTPAGE':default:var msg='Setting comment status';break;}
this.fireEvent('onChangeCommentStatus',{'messageText':msg,'publishStatus':publishStatus,'widget':this});},changeCommentPriority:function(priority){var messageText='Promoting thread';if(priority!=1){priority=0;messageText='Demoting thread';}
this.fireEvent('onChangeCommentPriority',{'messageText':messageText,'priority':priority,'widget':this});},userApproved:function(ev){jQuery('#comments .authorid_'+ev.params.commenterId).addClass('commenterstate_approved').removeClass('commenterstate_pending').removeClass('commentstate_draft');if(ev.params.commentId){jQuery('#comments .commentid_'+ev.params.commentId+' .approvedBy').html('<a href="/people/'+this.auth.user.username+'">'+this.auth.user.smartName+'</a> approved this comment');}},changeUserStatus:function(status){if(!status||jQuery.inArray(status,['pending','maybe','approve','remove'])==-1){return false;}
var action='';var messageText='';switch(status){case'pending':action='pending';messageText='Setting status to pending';break;case'maybe':action='maybe';messageText='Setting status to maybe';break;case'approve':action='approve';messageText='Approving user';break;case'remove':action='remove';messageText='Banning user';break;}
this.fireEvent('onChangeUserStatus',{'action':action,'messageText':messageText,'widget':this});},setStarCommenter:function(status){if(!status||jQuery.inArray(status,['true','false'])==-1){return false;}
if(this.auth.authenticated){if(this.auth.hasLevel('commentadmins')){var params={'op':'setstarcommenter','id':this.commentParams.commenterId,'cid':this.commentParams.commentId,'siteId':this.auth.site.siteId,'starcommenter':status};this.xhr.send('/index.php',params);}}},toggleAdminLinks:function(targetNode){targetNode.after(jQuery('.admin_links').show());},toggleStatus:function(userId){var status_container=jQuery('#status_container_'+userId);status_container.toggle();this.loadStatus(userId);},loadStatus:function(userId,force){var status_container=jQuery('#status_container_'+userId);if(status_container[0].style.display!='none'){var params={'op':'userlist_status','userId':userId};jQuery('#status_openable_indicator_'+userId).show();jQuery('#status_'+userId).hide();jQuery('#status_'+userId).load(this.options.action_url,params,function(){jQuery('#status_openable_indicator_'+userId).hide();jQuery('#status_'+userId).show();});}},loadUserComments:function(userId){params={'op':'userlist_comments','id':userId,'withPosts':'true','maxReturned':20,'refId':-1,'pubStatus[]':['DELETED','PENDING_APPROVAL','PUBLISHED']};jQuery('#commenticon_'+userId)[0].src='/assets/base/img/comments.gif';jQuery('#comments_'+userId).load(this.options.action_url,params,function(userId){jQuery('#commenticon_'+userId)[0].src='/assets/base/img/comments_loaded.gif';}.bind(this,userId));},paging:function(refId){this.controls.refId[0].value=refId;this.submitForm('filterForm');},submitForm:function(form){var params=this.controls[form].serialize();window.location='?'+params;}});$.extend($.ui.CommentAdminWidget,{'version':'1.0','defaults':{'action_url':'/index.php','onHide':function(args){},'onShow':function(args){},'onReset':function(args){},'controlClass':'commentadmin_control'}});})(jQuery);(function($){$.widget('ui.CommentBoxWidget',{controls:{},comment_placeholder:'comment_result_placeholder',comment_placeholder_text:'comment_result_placeholder_text',commentbox_opened:false,autogrow_on:false,colClickHandler:null,guest_email:null,inreply:false,textareaOriginalValue:null,textareaOpenedValue:null,initialize:function(){this.widgettype=this.getParam('widgettype',this.element);var panels={};this.registerEventHandler(this.element,'click',this.handleClick.bind(this));if(this.controls.textarea){this.registerEventHandler(this.controls.textarea,'focus',this.openWidget.bind(this));}
if(this.controls['guestpanel_form']){panels['guestpanel']={'el':this.controls.guestpanel_dialog,'focus':this.controls.guestpanelemail};this.guestpanel_validator=new Validator(jQuery.extend({},{'scope':this.controls['guestpanel_form']}));this.registerEventHandler(this.controls.guestpanel_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.guestpanel_form,'submit',this.handleGuestPanelSubmit.bind(this));}
this.commondialogs.initDialogs({'overlay':this.controls.overlay,'panels':panels,'group':this.options['dialoggroup']?this.options['dialoggroup']:false});this.registerEventHandler(jQuery('#uploadedfile'),'change',this.uploadFileDone.bind(this));this.subscribeForEvent('user.',this.authEventHandler.bind(this));this.subscribeForEvent('comment.commentlistupdated',function(){this.setControls();}.bind(this));this.subscribeForEvent('comment.reply',this.setReplyTo.bind(this));this.subscribeForEvent('commentbox.moveform',this.moveForm.bind(this));this.subscribeForEvent('comment.edit',this.setEdit.bind(this));this.subscribeForEvent('comment.newdiscussion',this.startNewDiscussion.bind(this));this.subscribeForEvent('comment.submitcomment',this.submitForm.bind(this));this.xhr=new XHR({klass:'commentbox',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});this.textareaOriginalValue=this.controls.textarea.val();},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':if(this.inState('init')){this.refreshWidget();}else if(this.inState('loggedout:waiting_for_authorization')){this.submitForm();}else{this.justLoggedIn=true;}
this.mystate='loggedin';break;case'user.auth.failure':this.refreshWidget();this.mystate='loggedout';break;}},handleGuestPanelSubmit:function(e){e.stopPropagation();e.preventDefault();this.guestpanel_validator.hideErrors();if(this.guestpanel_validator.validate()){this.mystate='loggedout:guestcommenter';this.guest_email=this.controls.guestpanelemail.val();this.commondialogs.toggleDialog({});this.submitForm();}else{if(this.options.show_validation_errors){this.guestpanel_validator.showErrors();this.controls.guestpanelemail.focus();}}},handleKeyUp:function(e){switch(e.keyCode){case jQuery.ui.keyCode.ESCAPE:this.commondialogs.toggleDialog({});break;}},handleClick:function(e){var controlType=this.getParam('cn',jQuery(e.target));switch(controlType){case'request_fb_login':this.commondialogs.toggleDialog({'which':'guestpanel'});this.syncEffect({'el':this,'fn':'raiseEvent','params':'presence.requiresequence.fblogin'});e.stopPropagation();e.preventDefault();break;case'requestlogin':this.commondialogs.toggleDialog({'which':'login'});e.stopPropagation();e.preventDefault();break;case'requestregister':this.commondialogs.toggleDialog({'which':'register'});e.stopPropagation();e.preventDefault();break;case'requestresetpw':this.commondialogs.toggleDialog({'which':'resetpw'});e.stopPropagation();e.preventDefault();break;case'guestpanel_cancel':this.commondialogs.toggleDialog({});break;case'expandform':case'textarea':this.openWidget();e.stopPropagation();e.preventDefault();break;case'collapseform':if(!this.controls.collapseform.hasClass('inprogress'))this.resetWidget();e.stopPropagation();e.preventDefault();break;case'submitform':this.submitForm();e.stopPropagation();e.preventDefault();break;case'showimage':this.controls.showimage.show();this.controls.showvideo.hide();this.controls.videoupload.hide();this.controls.imageoptions.show();this.controls.closeextensions.show();e.stopPropagation();e.preventDefault();break;case'showimageupload':this.controls.imageupload.show();this.controls.imageuploadform.show();this.controls.imageurlform.hide();e.stopPropagation();e.preventDefault();break;case'showimageurl':this.controls.imageupload.hide();this.controls.imageuploadform.hide();this.controls.imageurlform.show();this.controls.imageoptions.hide();this.controls.photourl.get(0).focus();e.stopPropagation();e.preventDefault();break;case'showvideo':this.controls.showvideo.show();this.controls.videoupload.show();this.controls.showimage.hide();this.controls.imageoptions.hide();this.controls.closeextensions.show();this.controls.videourl.get(0).focus();e.stopPropagation();e.preventDefault();break;case'closeextensions':this.resetExtensions();e.stopPropagation();e.preventDefault();break;case'fbcomment':case'fbcommentlabel':break;case'notify':case'notifylabel':e.stopPropagation();e.preventDefault();break;}},refreshWidget:function(){this.setControls();if(this.auth.authenticated&&this.auth.user.fb_uid)
{jQuery('.fbuser').show();}
else
{jQuery('.fbuser').hide();}},openWidget:function(){if(typeof this.controls.textarea!='undefined'&&this.controls.textarea.length>0&&this.controls.expandform.hasClass('collapsed')){this.controls.expandform.removeClass('collapsed');this.setDefaultTextvalue();if(!this.autogrow_on){this.controls.textarea.autogrow();this.autogrow_on=true;}
this.setCursorPosition(this.controls.textarea,0);this.controls.textarea.get(0).focus();this.commentbox_opened=true;this.colClickHandler=this.autoCollapseWidget.bind(this);jQuery(document).bind("click",this.colClickHandler);}},autoCollapseWidget:function(e){if(this.commentbox_opened&&(this.controls.textarea.val()==this.textareaOpenedValue||this.controls.textarea.val()=='')&&jQuery(e.target).closest('.entryContainer').length==0&&!this.controls.expandform.hasClass('inedit')&&!jQuery(e.target).hasClass('cn_commentreply')){this.resetWidget();jQuery(document).unbind("click",this.colClickHandler);}},moveForm:function(ev){if(typeof ev!='undefined'&&ev.params.targetNode){var targetNode=ev.params.targetNode;}else{var targetNode=jQuery('.input_box_place');}
targetNode.after(this.element[0]);},resetWidget:function(){this.clearFormValues();this.controls.expandform.addClass('collapsed');this.controls.textarea.css('height','');this.controls.textarea.val(this.textareaOriginalValue);this.resetExtensions();jQuery('.inreply').removeClass('inreply');jQuery('.inprogress').removeClass('inprogress');jQuery('.inedit').removeClass('inedit');jQuery('.extensions .selected').removeClass('selected');this.controls.indicator.hide();jQuery('#uploadLabel').show();this.commentbox_opened=false;this.inreply=false;this.mystate='collapsed';this.raiseEvent('commentbox.collapse',{});this.raiseEvent('commentbox.moveform',{});},clearFormValues:function(){if(typeof this.controls.textarea!='undefined'&&this.controls.textarea.length>0){this.controls.commentop.val('postcomment');jQuery('[name="parentType"]',this.controls.commentform).val(jQuery('[name="rootType"]',this.controls.commentform).val());this.controls.entryid_input.val(this.controls.rootid_input.val());jQuery('[name="uploadedfile"]',this.controls.commentform).val('');jQuery('[name="uploadedfileformat"]',this.controls.commentform).val('');jQuery('[name="addphotourl"]',this.controls.commentform).val('');jQuery('[name="addvideourl"]',this.controls.commentform).val('');jQuery('[name="commentId"]',this.controls.commentform).val('');jQuery('#imagePreview',this.controls.commentform).attr('src','').hide();jQuery('#upload_frame').show();this.controls.anonemailinput.val('');this.textareaOpenedValue='';}},setDefaultTextvalue:function(){this.controls.textarea.val('');if(typeof this.controls.hashtag!='undefined'&&this.controls.hashtag.length>0){this.controls.textarea.val("\n\n"+this.controls.hashtag.val());}
if(typeof this.controls.seohashtag!='undefined'&&this.controls.seohashtag.length>0){}
this.textareaOpenedValue=this.trimWhiteSpace(this.controls.textarea.val());},trimWhiteSpace:function(value)
{var lines=value.split("\n");lines[0]=jQuery.trim(lines[0]);lines[lines.length-1]=jQuery.trim(lines[lines.length-1]);return lines.join("\n");},submitForm:function(){this.controls.textarea.val(this.trimWhiteSpace(this.controls.textarea.val()));if(!this.commentbox_opened||((this.controls.textarea.val()==this.textareaOpenedValue||this.controls.textarea.val()=='')&&(this.controls.videourl.val()==''&&this.controls.photourl.val()==''&&this.controls.uploadedfile.val()==''))){return false;}
if(this.inState('loggedout:guestcommenter')){this.controls.commentop.val('guestcomment');this.controls.anonemailinput.val(this.guest_email);}
else if(!this.auth.authenticated){this.mystate='loggedout:waiting_for_authorization';this.commondialogs.toggleDialog({'which':'guestpanel'});return;}
var commentText=this.controls.textarea.val();this.controls.textarea.val(this.autoLinkText(commentText));var parameters=this.controls.commentform.serialize();if(!this.controls.submitform.hasClass('inprogress')){this.controls.submitform.addClass('inprogress');this.controls.collapseform.addClass('inprogress');this.controls.indicator.show();this.mystate='sendingcomment';this.xhr.send('/index.php',parameters);}},setReplyTo:function(ev){jQuery('[name="entry_id"]',this.controls.commentform).val(ev.params.parentId);jQuery('[name="parentType"]',this.controls.commentform).val('COMMENT');jQuery('[name="commentId"]',this.controls.commentform).val('');var preString='@'+ev.params.replyTo+': ';this.inreply=true;this.openWidget();if(this.controls.textarea)this.controls.textarea.val(preString+' '+this.controls.textarea.val());this.setCursorPosition(this.controls.textarea,preString.length);this.controls.textarea.get(0).focus();},setEdit:function(ev){jQuery('[name="op"]',this.controls.commentform).val('editcomment');jQuery('[name="entry_id"]',this.controls.commentform).val(ev.params.parentId);jQuery('[name="commentId"]',this.controls.commentform).val(ev.params.commentId);var cText=commentText=ev.params.commentText.html().replace(/<br>/gi,"").trim();var commenterReplacer=/@<a href="(.*?)">(.*?)<\/a>\:\s+/gi;while(crep=commenterReplacer.exec(commentText)){var cText=cText.replace(crep[0],'@'+crep[2]+': ');}
var phashtagReplacer=/ <span class=\"post_hashtag\">(.*?)<\/span>/gi;while(phtrep=phashtagReplacer.exec(cText)){var cText=cText.replace(phtrep[0],'');}
var hashtagReplacer=/<a href="(.*?)">\#(.*?)<\/a>/gi;while(htrep=hashtagReplacer.exec(cText)){var cText=cText.replace(htrep[0],'#'+htrep[2]);}
cText=cText.replace(/<a href="http:\/\/cache.gawker.com(.*?)">(.*?)<\/a>/gi,'');cText=cText.replace(/<object(.*?)">(.*?)<\/object>/gi,'');var linkReplacer=/<a href="(.*?)">(.*?)<\/a>/gi;while(rep=linkReplacer.exec(cText)){var cText=cText.replace(rep[0],rep[1]);}
this.openWidget();this.controls.textarea.val(cText);this.controls.expandform.addClass('inedit');},startNewDiscussion:function(ev){this.resetWidget();document.location.hash='#commentform';this.openWidget();},uploadFileDone:function(){if(jQuery('#uploadedfile').val()!='')
{this.controls.imagepreview.attr({src:jQuery('#uploadedfile').val()}).show();jQuery('#upload_frame').hide();}},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){this.raiseEvent('commentbox.newComment',{'data':data});if(data.success==true){this.resetWidget();var placeholder=jQuery('#postStatusResponse');if(placeholder.length>0){var newcomment='<li class="post postHeadline"><div class="excerpt"><a title="Notification" href="/tag/'+data.hashtag+'/" class="topTag condensedTag">notification</a><h1>';newcomment+='<img src="/assets/base.v8/img/ui/alert.orange.png" style="float: none; clear: none; margin: 0px 4px 0px 0px; border: 0;" />';newcomment+='"'+data.commentTextShort.replace(/<br \/>/ig,' ').replace(/\n/gi,' ')+'"';newcomment+='<br />Your comment ';if(data.commentImage)newcomment+='and image ';if(data.commentVideo)newcomment+='and video ';newcomment+='has been published here: <a href="/tag/'+data.hashtag+'/">#'+data.hashtag+'</a>';newcomment+='</h1></div></li>';placeholder.eq(0).after(newcomment);}else{Message.showMessage(data.message,this.controls.message[0],{stable:false,duration:3000});}}else{Message.showMessage(data.message,this.controls.message[0],{stable:false});}
if(this.controls.submitform.hasClass('inprogress')){this.controls.submitform.removeClass('inprogress');this.controls.collapseform.removeClass('inprogress');this.controls.indicator.hide();}},handleAjaxFail:function(){if(this.controls.submitform.hasClass('inprogress')){this.controls.submitform.removeClass('inprogress');this.controls.collapseform.removeClass('inprogress');this.controls.indicator.hide();}},resetExtensions:function(){this.controls.showimage.show();this.controls.showvideo.show();this.controls.imageoptions.hide();this.controls.imageupload.hide();this.controls.videoupload.hide();this.controls.imageuploadform.hide();this.controls.imageurlform.hide();this.controls.closeextensions.hide();},autoLinkText:function(text){text=' '+text;text=text.replace(/([^"=])(https?\:\/\/)([^,'"\s\<\>\)\]\!\/]*)((\/)(([^,'"\s\<\>\)\]\!]|[,])*))?/igm,'$1<a href="$2$3$4">[$3]</a>');text=text.substring(1,text.length);var re=new RegExp(/href.+>(.*?)<\/a>/g);var amatches=re.exec(text);if(amatches){for(var i=1,l=amatches.length;i<l;i+=2){var href=amatches[i];if(href.length>60){var nhref=href.substr(0,59);var index=text.indexOf(href);var stext=text.substr(0,index);var etext=text.substr(index+href.length,text.length);text=stext+nhref+"...</a>"+etext;}}}
return text;},setCursorPosition:function(textareaElement,position){var textElement=jQuery(textareaElement);if(textElement.get(0).setSelectionRange){textElement.get(0).setSelectionRange(position,position);}
else if(textElement.get(0).createTextRange){var range=textElement.get(0).createTextRange();range.collapse(true);range.moveEnd('character',position);range.moveStart('character',position);range.select();}}});$.extend($.ui.CommentBoxWidget,{version:'1.0',defaults:{'onHide':{},'onShow':{},'onReset':{},'controlClass':'inputcontrol','externalElement':'.presence_control_external','show_validation_errors':true}});})(jQuery);(function($){$.widget('ui.CommentWidget',{controls:{},params:{},firstRun:true,initialize:function(){this.xhr=new XHR({klass:'comment','type':'GET',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.subscribeForEvent('comment.commentlistloaded',this.handleCommentlistLoad.bind(this));this.subscribeForEvent('commentbox.newComment',this.insertNewComment.bind(this));this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':case'user.auth.failure':this.setUserRights();if(this.firstRun){this.setCommentParameters();this.showWidget();}
break;}},handleClick:function(e){var target=jQuery(e.target);var controlType=this.getParam('cn',target);switch(controlType)
{case'commentopenbutton':this.collapseComment(this.getParam('comment',target));e.stopPropagation();e.preventDefault();break;case'loadallcomments':this.loadAllComments();e.stopPropagation();e.preventDefault();break;case'loadfeaturedcomments':this.loadFeaturedComments();e.stopPropagation();e.preventDefault();break;case'showthreadcomments':this.loadThreadComments(target);e.stopPropagation();e.preventDefault();break;case'setcommentorder':this.setCommentOrder(this.getParam('commentorder',target));e.stopPropagation();e.preventDefault();break;case'commentpager':this.pageComments(this.getParam('page',target));e.stopPropagation();e.preventDefault();break;case'commentreply':this.replyToComment(target);e.stopPropagation();e.preventDefault();break;case'commentedit':this.editComment(target);e.stopPropagation();e.preventDefault();break;case'newdiscussion':this.startNewDiscussion();e.stopPropagation();e.preventDefault();break;case'showmorecomments':this.showMoreComments();e.stopPropagation();e.preventDefault();break;case'showallcomments':this.showAllComments();e.stopPropagation();e.preventDefault();break;case'commentcollapse':this.collapseComments(true);e.stopPropagation();e.preventDefault();break;case'commentexpand':this.collapseComments(false);e.stopPropagation();e.preventDefault();break;case'threadexpand':this.collapseThread(jQuery(e.target),false);e.stopPropagation();e.preventDefault();break;case'threadcollapse':this.collapseThread(jQuery(e.target),true);e.stopPropagation();e.preventDefault();break;}},setCommentParameters:function(){var threadId=this.getParam('threadid',this.element);if(threadId){this.params.commentId=threadId;}else if(document.location.hash.substr(0,2)=='#c')
{this.params.commentId=parseInt(document.location.hash.substr(2));}
this.params.commentPage=1;if(this.params.commentId>0){this.params.commentPage=1;}else{this.params.commentId='';}
var overrideSort=this.getParam('sortby',this.element);this.params.commentSortOrder=(overrideSort)?overrideSort:(this.auth.authenticated&&this.auth.user.commentOrder=='asc')?'asc':'desc';this.params.commentType=this.getParam('commenttype',this.element);this.params.commentRootId=this.getParam('rootid',this.element);switch(this.params.commentType)
{case'post':case'tag':this.params.commentLoadType=this.options.action_name;this.params.commentRootTitle='';this.params.tagData=this.options.tagData;this.params.mode=(this.options.loadMode?this.options.loadMode:'postComments');break;default:this.params.commentLoadType='imagecomments';this.params.commentRootTitle='';break;}
this.params.commentsAllowed=(this.element.hasClass('commentsDisabled'))?false:true;this.params.acceptratings=(this.element.hasClass('acceptRatings'))?true:false;this.params.classicComments=this.getParam('commentview',this.element);this.params.commentThread=this.getParam('threadid',this.element);if(this.options.action_name=='commentlist'){if(this.auth.authenticated){this.params.priority=(this.auth.user.commentViewMode=='hidden')?0:1;}else{this.params.priority=(jQuery.cookie('commentViewMode')=='hidden')?0:1;}}else{this.params.priority=0;}
this.params.saveCommentPreferences=false;},showWidget:function(){if(this.firstRun&&this.options.serverSideCommentList)
{var data=this.options.defaultData;data.domAlreadyLoaded=true;this.raiseEvent('comment.commentlistloaded',{'data':data});this.firstRun=false;}
else
{var params=new Array();params.push('op='+this.params.commentLoadType);params.push('title='+this.params.commentRootTitle);params.push((this.params.commentType=='image')?'imageId='+this.params.commentRootId:'postId='+this.params.commentRootId);params.push('cId='+this.params.commentId);params.push('cpage='+this.params.commentPage);params.push('commentsAllowed='+this.params.commentsAllowed);params.push('acceptratings='+this.params.acceptratings);params.push('priority='+this.params.priority);params.push('mode='+this.params.mode);params.push('tagData='+this.params.tagData);if(this.params.commentThread)params.push('t='+this.params.commentThread);if(this.params.commentSortOrder)params.push('sort='+this.params.commentSortOrder);if(this.params.appendComments)params.push('append=true');if(this.params.saveCommentPreferences==true){params.push('saveCommentPreferences=true');this.params.saveCommentPreferences=false;this.auth.resetRevision();}
this.xhr.send('/index.php',params.join('&'));if(this.firstRun)this.firstRun=false;}},setUserRights:function(){var element=jQuery('#comments').removeClass('ul_e').removeClass('ul_m').removeClass('ul_sc');var site_id=this.getParam('siteid',this.element);Logger.debugLog(site_id);if(this.auth.authenticated){if(this.auth.hasLevel('authors',site_id)){element.addClass('ul_e');}
else if(this.auth.hasLevel('commentadmins',site_id)){element.addClass('ul_m');}
else if(this.auth.hasLevel('starcommenters',site_id)){element.addClass('ul_sc');}}
this.toggleEditIcons();},toggleEditIcons:function(){if(this.auth.authenticated){if(this.auth.hasLevel('commentadmins')){jQuery('#comments .comment .cn_commentedit').css({'display':'block'});}else{jQuery('#comments .comment.authorid_'+this.auth.user.id+':not(.disemvoweled)').each(function(iteration,currentComment){var delta=(myUserLocation['t']?myUserLocation['t']:Math.floor(new Date().getTime()/1000))-parseInt(this.getParam('issued',currentComment),10);if(delta<900){jQuery('.cn_commentedit',currentComment).css({'display':'block'});}}.bind(this));}}
else
{jQuery('.cn_commentedit').css({'display':'none'});}},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){this.raiseEvent('comment.commentlistloaded',{'data':data});},handleAjaxFail:function(data){this.controls.comments_placeholder.html('<span class="error">Failed to load comments, please try again later</span>');},setCommentOrder:function(commentOrder){this.params.commentPage=1;this.params.commentSortOrder=commentOrder;this.showWidget();},loadAllComments:function(){jQuery('#comments').addClass('showall').removeClass('showfeatured');document.location.hash='#comments';this.params.appendComments=false;this.params.commentPage=1;this.params.priority=0;if(!this.auth.authenticated)jQuery.cookie('commentViewMode','hidden',{path:'/',expires:365});this.showWidget();},loadFeaturedComments:function(){jQuery('#comments').addClass('showfeatured').removeClass('showall');document.location.hash='#comments';this.params.appendComments=false;this.params.commentPage=1;this.params.priority=1;if(!this.auth.authenticated)jQuery.cookie('commentViewMode','featured',{path:'/',expires:365});this.showWidget();},loadThreadComments:function(targetNode){var threadNode=targetNode.closest('.threadWrapper');if(targetNode.hasClass('allcomments')){threadNode.removeClass('showfeatured').addClass('showall');}
else if(targetNode.hasClass('featuredcomments')){threadNode.addClass('showfeatured').removeClass('showall');}},pageComments:function(pageNumber){this.params.commentPage=pageNumber;this.params.pagingInProgress=true;this.showWidget();document.location.hash='#pager';},showMoreComments:function(){this.params.commentPage=this.params.commentPage+1;this.params.appendComments=true;jQuery('.pagingIndicator').show();this.showWidget();},showAllComments:function(){this.params.commentPage=1;this.params.commentId=false;this.params.appendComments=false;jQuery('.allComments').hide();jQuery('.commentPager').show();jQuery('.pagingIndicator').show();document.location.hash='comments';this.showWidget();},collapseComments:function(collapse)
{var display='';this.params.commentsCollapsed=collapse;if(collapse)
{display='none';}
jQuery('.threadWrapper').css('display',display);this.setVisibilityControls();},collapseThread:function(lnk,collapse)
{var thread=lnk.parents('div.threadWrapper');var see=jQuery('.commentcontrol.cn_threadexpand',thread);var hide=jQuery('.commentcontrol.cn_threadcollapse',thread);var replies=jQuery('.replylevel_comment',thread);if(collapse)
{replies.hide();see.show();hide.hide();}
else
{replies.show();see.hide();hide.show();}},setVisibilityControls:function()
{if(this.params.commentsCollapsed)
{jQuery('.showFeaturedOrHiddenComments').show();jQuery('.showHiddenComments').hide();jQuery('.showFeaturedComments').hide();}
else if(this.params.hasHiddenItems==true)
{jQuery('.showFeaturedOrHiddenComments').hide();jQuery('.showHiddenComments').show();jQuery('.showFeaturedComments').hide();}
else
{jQuery('.showFeaturedOrHiddenComments').hide();jQuery('.showFeaturedComments').show();jQuery('.showHiddenComments').hide();}
this.setPipes();},setPipes:function(){var visibleCounter=-1;jQuery('.comment_footer .tools.intelligentPipes span').each(function(){var jObj=jQuery(this);var hasPipe=(jObj.html().indexOf(' | ')==0);if(!jObj.is(':visible'))
{if(hasPipe)jObj.html(jObj.html().substr(3));return true;}
visibleCounter++;if(visibleCounter==0)
{if(!hasPipe)return true;jObj.html(jObj.html().substr(3));return true;}
if(!hasPipe)jObj.html(' | '+jObj.html());});},replyToComment:function(targetNode){if(this.options.hiddenReplies)
{this.collapseThread(targetNode,false);}
var replyComment=targetNode.closest('.comment');replyComment.addClass('inreply');var lastElement=replyComment;this.raiseEvent('commentbox.moveform',{'targetNode':lastElement});commentid=this.getParam('commentid',jQuery(replyComment));this.raiseEvent('comment.reply',{'parentId':commentid,'replyTo':jQuery('#c'+commentid+'_author',replyComment).text()});},editComment:function(targetNode){var editedComment=targetNode.closest('.comment');this.raiseEvent('commentbox.moveform',{'targetNode':editedComment});this.raiseEvent('comment.edit',{'parentId':this.getParam('parentid',editedComment),'commentText':jQuery('.commenttexteditable',editedComment),'commentId':this.getParam('commentid',editedComment)});},insertNewComment:function(ev){var data=ev.params.data;switch(data.action){case'postcomment':var commentSelector='.commentid_'+data.objectId;if(data.parentType=='COMMENT'){jQuery('.entryContainer',this.element).before(data.content);var newcomment=jQuery(commentSelector).removeClass('toplevel_comment').addClass('replylevel_comment');var promotedComment=jQuery('.commentid_'+data.parentId);if(promotedComment.hasClass('commentpriority_0')&&this.auth.hasLevel('starcommenters')){this.raiseEvent('comment.commentpromoted',{'commentId':data.parentId});if(data.approvedCommenterId){jQuery('.commentid_'+data.parentId+' .promotedBy').hide();this.raiseEvent('comment.userapproved',{'commenterId':data.approvedCommenterId,'commentId':data.parentId});Message.showMessage('Comment and commenter approved',jQuery('.commentid_'+data.parentId+' .please_leave_a_message').get(0),{stable:false});}}
if(this.options.addThreadPermalink)
{var permalinks=jQuery('div.threadPermalinkContainer',jQuery(commentSelector).parents('div.threadWrapper'));var childNum=permalinks.attr('childnum');if(childNum==0)permalinks.show();childNum++;permalinks.attr('childNum',childNum)
jQuery('span.chnum',permalinks).html(childNum);jQuery('span.chpl',permalinks).html(childNum>1?'ies':'y');}}else{var wrapperDiv=jQuery(document.createElement('div')).addClass('threadWrapper').addClass('threadid_'+data.objectId);wrapperDiv.append(data.content);wrapperDiv.append(jQuery(document.createElement('div')).addClass('showthreadcomments_box'));jQuery('.comment_list_placeholder').prepend(wrapperDiv);var newcomment=jQuery(commentSelector).removeClass('replylevel_comment').addClass('toplevel_comment');}
if(this.justLoggedIn==true)
{var warnLink=jQuery(document.createElement('a')).addClass('commentcontrol').addClass('cn_loadallcomments').html('View pending comments').attr('title','You just logged in, there may be pending comments');newcomment.after(jQuery(document.createElement('div')).addClass('pendingwarning').append(warnLink));this.justLoggedIn=false;}
newcomment.show();jQuery('.cn_commentedit',newcomment).show();break;case'editcomment':jQuery('.commentid_'+data.commentId+' .commenttexteditable').html(data.content);var d=new Date();var h=d.getHours();var am='AM';if(h>12){h=h-12;am='PM';}
var dateStamp=(d.getMonth()+1)+'/'+d.getDate()+'/'+d.getFullYear().toString().substring(2,4)+' '+h+':'+d.getMinutes()+' '+am;jQuery('.commentid_'+data.commentId+' .cn_commentedit').show();jQuery('.commentid_'+data.commentId+' .modifiedBy').text('Edited by '+this.auth.user.smartName+' at '+dateStamp);jQuery('.commentid_'+data.commentId+' .metatext').show();break;}},startNewDiscussion:function(){this.raiseEvent('comment.newdiscussion',{});},handleCommentlistLoad:function(ev){if(!(!+"\v1"))
{this.insertIntoDom(ev.params);}
else
{jQuery(document).ready(function(){this.insertIntoDom(ev.params);}.bind(this,ev.params));}},insertIntoDom:function(args){if(args.data.content||args.data.domAlreadyLoaded){if(!args.data.domAlreadyLoaded){if(args.data.append){this.controls.comments_placeholder[0].innerHTML+=args.data.content;}else{this.controls.comments_placeholder[0].innerHTML='';this.controls.comments_placeholder[0].innerHTML=args.data.content;}}
if((args.data.currentPage+1)<args.data.totalPages){jQuery('.commentPager').show();}else{jQuery('.commentPager').hide();}
jQuery('.pagingIndicator').hide();this.setControls();this.toggleEditIcons();if(this.params.commentId){jQuery('.allComments').show();var hilited=jQuery('.commentid_'+this.params.commentId);this.fireEvent('onScrollTo',{'wg':this,'which':hilited},true);this.fireEvent('onCommentHilite',{'wg':this,'which':hilited},true);jQuery('.commentPager').hide();}
if(args.data.totalThreads>0||this.params.commentId)
{this.params.hasHiddenItems=args.data.hasHiddenItems;if(this.params.commentsCollapsed)this.collapseComments(false);this.setVisibilityControls();}
if(args.data.totalComments&&this.controls.individual_postmeta_commentcount){this.controls.individual_postmeta_commentcount.html(args.data.totalComments).attr('title','Read '+args.data.totalComments+' comments on the post');if(args.data.totalComments>=100){this.controls.commentcount_icon_high.show();this.controls.commentcount_icon_low.hide();}}
myLytebox=new LyteBox();if(jQuery('.facebook_enabled').length>0){redrawFBML(jQuery('.pagedcomment.page_'+args.data.pagenum).get(0));}}
this.raiseEvent('comment.commentlistupdated',{'last_comment_id':args.data.last_comment_id,'pagenum':args.data.currentPage});if(this.params.pagingInProgress)
{document.location.hash='#pager';this.params.pagingInProgress=false;}}});$.extend($.ui.CommentWidget,{'version':'1.0','defaults':{'action_name':'commentlist','onHide':{},'onShow':{},'onReset':{},'controlClass':'commentcontrol','externalElement':'.commentcontrol_external','onScrollTo':function(args){jQuery.scrollTo(args['which'],1200,function(){args['wg'].syncEffect();});return'will_sync';},'onCommentHilite':function(args){args.which.animate({'backgroundColor':'#ffff99'},1500,'swing',function(){args.which.animate({'backgroundColor':jQuery('body').css('background-color')},900,'swing',function(){args.wg.syncEffect();});});return'will_sync';}}});})(jQuery);jQuery.extend(settings.widgets,{commentnotification:{klass:'CommentNotificationWidget',byselector:{'.ganja_notifier':{eventHandlerBuilder:function(pagecontroller_instance){return{};},terminating_el:'.terminating',options:{}}}}});(function($){$.widget('ui.CommentNotificationWidget',{xhr:null,initialize:function(){this.setParam('lastUpdated',new Date().getTime());this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));this.subscribeForEvent('comment.commentlistupdated',this.setMaxId.bind(this));this.xhr=new XHR({klass:'commentnotification',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':this.startUpdating();break;case'user.auth.failure':break;}},startUpdating:function(){if(this.auth.site.newCommentAutoCheck.enabled==true&&this.auth.user.id!=undefined){var issued=this.getParam('postIssued');var now=new Date().getTime();var time=Math.floor(now/1000);if(time-issued<48*3600){var runUpdate=false;five_mins=new Date(now-(5*60000)).getTime();ten_mins=new Date(now-(10*60000)).getTime();var lastUpdated=this.getParam('lastUpdated');if(lastUpdated>five_mins){runUpdate=true;}else if(lastUpdated<ten_mins){runUpdate=false;}else if(now%2==0){runUpdate=true;}
if(runUpdate==true&&this.getParam('maxId')>0){this.doUpdate();}
setTimeout(function(){this.startUpdating()}.bind(this),this.auth.site.newCommentAutoCheck.timer*1000);}}},doUpdate:function(){var params=new Array();params.push('op=newcomments');params.push('postId='+this.getParam('refId'));params.push('id='+this.getParam('maxId'));this.xhr.send(this.options.action_url,params.join('&'));},doNotify:function(message){this.controls.message.html(message);this.element.slideDown();},setMaxId:function(ev){this.setParam('maxId',ev.params.last_comment_id);},handleClick:function(e){var controlName=this.getParam('cn',jQuery(e.target));switch(controlName){case'close':this.element.slideUp();e.preventDefault();e.stopPropagation();return false;break;}},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){if(data.success==true&&data.action=='newcomments'){if(data.replies&&data.replies.length>0)
{var message=new Array();data.replies.each(function(c){message.push('<a href="#c'+c.id+'">'+c.author.displayName+'</a>');});this.doNotify(message.join(', ')+' replied to your comment.');}
else if(data.newcommentscount>0){this.setParam('maxId',data.newest);if(data.newcommentscount>10){data.newcommentscount='10+';}
var ctxt=(data.newcommentscount==1)?'comment':'comments';this.doNotify(data.newcommentscount+' new '+ctxt+' on this post.<br/><br/><a href="#" onclick="location.reload(); return false;">Click here to refresh.</a>');this.setParam('lastUpdated',new Date().getTime());}}},handleAjaxFail:function(){},resetWidget:function(){}});$.extend($.ui.CommentNotificationWidget,{version:'1.0',defaults:{controlClass:'notificationcontrol',action_url:'/'}});})(jQuery);(function($){$.widget('ui.EditorControlsWidget',{initialize:function(){this.xhr=new XHR({klass:'editorcontrols',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});var panels={};var should_init_panels=false;if(this.controls['starinvite_form']){panels['starinvite']={'el':this.controls.starinvite_dialog,'focus':this.controls.starinvite_email};this.starinvite_validator=new Validator(jQuery.extend({},{'scope':this.controls['starinvite_form']}));this.registerEventHandler(this.controls.starinvite_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.starinvite_form,'submit',this.handleStarInviteSubmit.bind(this));this.controls.starinvite_form[0].reset();should_init_panels=true;}
if(this.controls['tagheader_form']){panels['tagheader']={'el':this.controls.tagheader_dialog,'focus':this.controls.tagheader_entry};this.tagheader_validator=new Validator(jQuery.extend({},{'scope':this.controls['tagheader_form']}));this.registerEventHandler(this.controls.tagheader_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.tagheader_form,'submit',this.handleTagheaderSubmit.bind(this));this.controls.tagheader_form[0].reset();should_init_panels=true;}
if(should_init_panels)this.commondialogs.initDialogs({'overlay':this.controls.overlay,'panels':panels,'group':this.options['dialoggroup']?this.options['dialoggroup']:false});this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':var should_show=false;if(this.controls['for_editors']){if(this.auth.hasLevel('authors')){this.controls.for_editors.show();should_show=true;}else this.controls.for_editors.hide();}
if(this.controls['slurp_toggle']){if(this.setupSlurpForm()){this.controls.slurp_toggle.show();should_show=true;}else this.controls.slurp_toggle.hide();}
if(this.controls['starinvite_link']){if(this.auth.hasLevel('commentadmins')){var oldlimit=this.controls.starinvite_email[0].className.split('valid_limit_comma-').pop().split(' ')[0]
this.controls.starinvite_email.removeClass('valid_limit_comma-'+oldlimit);this.starinvite_validator.setupInfield(this.controls.starinvite_email[0]);this.controls.starinvite_left.html('');this.controls.starinvite_link.show();should_show=true;}else if(this.auth.hasLevel('commenters')){var limit=this.getParam('limitnormal',this.controls['starinvite_link']);var epoch=parseInt(this.getParam('epoch',this.controls['starinvite_link']),10);var timeframe=parseInt(this.getParam('timeframe',this.controls['starinvite_link']),10);if(this.auth.hasLevel('starcommenters'))limit=this.getParam('limitstar',this.controls['starinvite_link']);limit=parseInt(limit,10);var lft=limit?limit:10;if(window['myUserLocation']&&window['myUserLocation']['t']&&this.auth.user['lastInviteTime']){var lit=parseInt(this.auth.user['lastInviteTime'],10);if((myUserLocation.t-lit)<(timeframe-((lit-epoch)%timeframe))){lft=limit-parseInt(this.auth.user.recentInviteCount,10);}}
var oldlimit=this.controls.starinvite_email[0].className.split('valid_limit_comma-').pop().split(' ')[0]
this.controls.starinvite_email.removeClass('valid_limit_comma-'+oldlimit).addClass('valid_limit_comma-'+lft);this.starinvite_validator.setupInfield(this.controls.starinvite_email[0]);this.controls.starinvite_left.html('('+lft+' left)');if(lft>0){this.controls.starinvite_link.show();should_show=true;}}else this.controls.starinvite_link.hide();}
if(this.controls['tagheader_link']){if(this.controls.tagheader_enabled.html()=='true'){if(this.auth.hasLevel('editors')){this.controls.tagheader_entry.val(this.controls.tagheader_entry_orig.html().trim());this.controls.tagheader_postid.val(this.controls.tagheader_postid_orig.html());this.controls.tagheader_id.val(this.controls.tagheader_postid_orig.html());this.controls.tagheader_tags.val(this.controls.tagheader_tags_orig.html());this.controls.tagheader_link.show();}}}
if(should_show)this.element.eq(0).show();else this.element.eq(0).hide()
break;case'user.auth.failure':if(this.controls['for_editors'])this.controls.for_editors.hide();if(this.controls['starinvite_link'])this.controls.starinvite_link.hide();if(this.controls['slurp_toggle'])this.controls.slurp_toggle.hide();if(this.controls['slurp_dialog'])this.controls.slurp_dialog.hide();if(this.controls['tagheader_link'])this.controls.tagheader_link.hide();this.element.eq(0).hide();break;}},handleClick:function(e){var t=this.getParam('cn',e.target);switch(t){case'slurp_toggle':case'slurp_cancel':if(this.option('disabled')==false)this.toggleSlurpDialog();break;case'slurp_button':if(this.controls.slurp_select[0].value==-1){Message.showMessage('Please select a site',this.controls.slurp_message[0],{});}else{this.controls.slurp_indicator.show();this.xhr.send('/index.php',this.controls.slurp_form.serialize());}
break;case'draft_link':if(confirm('Delete post?')){var params=[];params.push('op=changepoststatus');params.push('v2=true');params.push('id='+this.getParam('postId',this.controls.draft_link));params.push('publishStatus=DRAFT');params.push('realm=');this.xhr.send('/index.php',params.join('&'));}
break;case'starinvite_link':this.controls.starinvite_postid.val(this.getParam('postId',e.target));case'starinvite_cancel':if(this.auth.hasLevel('commentadmins')||this.auth.hasLevel('commenters')){if(this.controls['starinvite_copy'])this.controls['starinvite_copy'].html('To create invites, paste in a list of comma-separated email addresses, and then click send invites.');}else if(this.auth.hasLevel('starcommenters')){if(this.controls['starinvite_copy'])this.controls['starinvite_copy'].html('To create invites for new users, paste in a list of comma-separated email addresses, and then click send invites.');}
this.commondialogs.toggleDialog({'which':'starinvite'});break;case'tagheader_link':case'tagheader_cancel':if(this.auth.hasLevel('editors')){this.commondialogs.toggleDialog({'which':'tagheader'});}
break;default:return true;break;}
e.stopPropagation();e.preventDefault();return false;},handleKeyUp:function(e){switch(e.keyCode){case jQuery.ui.keyCode.ESCAPE:this.commondialogs.toggleDialog();break;}},handleStarInviteSubmit:function(e){e.stopPropagation();e.preventDefault();this.starinvite_validator.hideErrors();if(this.starinvite_validator.validate()){this.mystate='starinvite_sent';this.xhr.send(this.options.starinvite_action_url,this.controls.starinvite_form.serialize());}else{this.mystate='starinvite_dialog_visible';if(this.options.show_validation_errors){this.starinvite_validator.showErrors();}}},handleTagheaderSubmit:function(e){e.stopPropagation();e.preventDefault();this.tagheader_validator.hideErrors();if(this.tagheader_validator.validate()){this.mystate='tagheader_sent';this.xhr.send(this.options.tagheader_action_url,this.controls.tagheader_form.serialize());}else{this.mystate='tagheader_dialog_visible';if(this.options.show_validation_errors){this.tagheader_validator.showErrors();}}},handleAjaxRequest:function(){switch(this.mystate){case'slurp_sent':this.disableInputs('slurp');break;case'starinvite_sent':this.disableInputs('starinvite');this.controls.starinvite_indicator.show();break;case'tagheader_sent':this.disableInputs('tagheader');this.controls.tagheader_indicator.show();break;}},handleAjaxSuccess:function(data){if(data['postSave']){data={'action':'postSave','success':data.postSave.success,'postid':data.postSave.postId};}
switch(data.action){case'addsitetag':if(data['success']){this.controls.slurp_indicator.hide();Message.showMessage(data.message,this.controls.slurp_message[0],{onComplete:function(){this.toggleSlurpDialog();this.enable();}.bind(this)});}else{this.controls.slurp_indicator.hide();Message.showMessage(data.message,this.controls.slurp_message[0]);this.enableInputs('slurp');}
break;case'changeposttag_add':if(data['success']){this.controls.top_link.hide();this.controls.untop_link.show();}
break;case'changeposttag_remove':if(data['success']){this.controls.top_link.show();this.controls.untop_link.hide();}
break;case'starinvite':this.enableInputs('starinvite');this.controls.starinvite_indicator.hide();if(data['success']){if(!this.auth.hasLevel('commentadmins')){var lft=data['left']?data['left']:0;var oldlimit=this.controls.starinvite_email[0].className.split('valid_limit_comma-').pop().split(' ')[0];this.controls.starinvite_email.removeClass('valid_limit_comma-'+oldlimit).addClass('valid_limit_comma-'+lft);this.starinvite_validator.setupInfield(this.controls.starinvite_email[0]);this.controls.starinvite_left.html('('+lft+' left)');this.auth.resetRevision();if(lft==0)this.controls.starinvite_link.hide();Message.showMessage((data['message']?data['message']:'Invitation(s) sent. '+lft+' left.'),this.controls.starinvitemessage[0]);}else{Message.showMessage((data['message']?data['message']:'Invitation(s) sent.'),this.controls.starinvitemessage[0]);}
this.fireEvent('onInviteSuccess',this,true);this.syncEffect({'el':this.commondialogs,'fn':'toggleDialog','params':{'which':'starinvite','sync_this':this.syncEffect.bind(this)}});this.controls.starinvite_email.val('');this.mystate='idle';}else{Message.showMessage((data['message']?data['message']:'Invitation failed.'),this.controls.starinvitemessage[0]);this.mystate='starinvite_dialog_visible';}
break;case'postSave':this.enableInputs('tagheader');this.controls.tagheader_indicator.hide();if(data['success']){Message.showMessage((data['message']?data['message']:'Tagheader saved.'),this.controls.tagheadermessage[0]);this.fireEvent('onTagheaderSuccess',this,true);this.syncEffect({'el':this.commondialogs,'fn':'toggleDialog','params':{'which':'tagheader','sync_this':this.syncEffect.bind(this)}});this.controls.tagheader_entry_orig.html(this.controls.tagheader_entry.val());this.mystate='idle';}else{Message.showMessage((data['message']?data['message']:'Tagheader save failed.'),this.controls.tagheadermessage[0]);this.mystate='tagheader_dialog_visible';}
break;}},handleAjaxFail:function(){switch(this.mystate){case'starinvite_sent':this.enableInputs('starinvite');this.mystate='starinvite_dialog_visible';break;case'tagheader_sent':this.enableInputs('tagheader');this.mystate='tagheader_dialog_visible';break;}},disableInputs:function(which){switch(which){case'slurp':this.disable();jQuery('select, button',this.controls.slurp_form).each(function(i,element){element.disabled=true;});break;case'starinvite':this.controls.starinvite_email[0].disabled=true;this.controls.starinvite_submit[0].disabled=true;this.controls.starinvite_cancel[0].disabled=true;break;case'tagheader':this.controls.tagheader_entry[0].disabled=true;this.controls.tagheader_submit[0].disabled=true;this.controls.tagheader_cancel[0].disabled=true;break;}},enableInputs:function(which){switch(which){case'slurp':this.enable();jQuery('select, button',this.controls.slurp_form).each(function(i,element){element.disabled=false;});break;case'starinvite':this.controls.starinvite_email[0].disabled=false;this.controls.starinvite_submit[0].disabled=false;this.controls.starinvite_cancel[0].disabled=false;break;case'tagheader':this.controls.tagheader_entry[0].disabled=false;this.controls.tagheader_submit[0].disabled=false;this.controls.tagheader_cancel[0].disabled=false;break;}},toggleSlurpDialog:function(){if(this.controls.slurp_dialog[0].style.display=='none'){this.enableInputs('slurp');this.controls.slurp_form[0].reset();}
this.controls.slurp_dialog.slideToggle();},setupSlurpForm:function(){var options=this.controls.slurp_select[0].options;var l=options.length-1;for(var i=l;i>0;i--){if(this.auth.site.siteId==options[i].value||!this.auth.hasLevel('authors',options[i].value))options[i]=null;}
if(options.length<3)options[0]=null;return(options.length>0);}});$.extend($.ui.EditorControlsWidget,{version:'1.0',defaults:{'controlClass':'editor_control','externalElement':'.presence_control_external, .editorControlsWidget_external','show_validation_errors':true,'starinvite_action_url':'/?op=sendinvite','tagheader_action_url':'/?op=admin_savepost','onInviteSuccess':function(wg){window.setTimeout(function(){wg.syncEffect();},1000);return'will_sync';},'onTagheaderSuccess':function(wg){window.setTimeout(function(){wg.syncEffect();},1000);return'will_sync';}}});})(jQuery);(function($){$.widget('ui.FooterToggler',{initialize:function(){this.registerEventHandler(this.element,'mouseenter',this.handleMouseEnter.bind(this));this.registerEventHandler(this.element,'mouseleave',this.handleMouseLeave.bind(this));this.busy=false;},handleMouseEnter:function(e){if(!this.busy){this.busy=true;this.fireEvent('onFooterShow',this,true);}},handleMouseLeave:function(e){this.fireEvent('onFooterHide',this,true);}});$.extend($.ui.FooterToggler,{version:'1.0',defaults:{'controlClass':'footer_toggler','onFooterShow':function(wg){wg.element.animate({'height':'110px','opacity':1},230,function(){wg.syncEffect();});return'will_sync';},'onFooterHide':function(wg){wg.element.animate({'height':'30px','opacity':0.01},230,function(){wg.busy=false;wg.syncEffect();});return'will_sync';}}});})(jQuery);(function($){$.widget('ui.GalleryPagerWidget',{controls:{},params:{},xhr:null,commentParams:{},next_image_position:0,prev_image_position:0,initialize:function(){this.registerEventHandler(this.element,'click',this.handleClick.bind(this));jQuery(window).keyup(this.handleKeyUp.bind(this));var selImgData=this.getParam('selected',this.element);if(!selImgData)selImgData=/\/gallery\/([0-9]+)/.exec(location.href);if(selImgData)
{var imgPos=selImgData;var imgData=galleryData.images[(imgPos-1)];if(imgData.videoData)this.loadImageByNumber(imgPos);}
if(!galleryData.pre)
{var imgPos=1;var imgData=galleryData.images[(imgPos-1)];if(imgData.videoData)this.loadImageByNumber(imgPos);}
this.next_image_position=selImgData+1;this.prev_image_position=selImgData-1;},handleClick:function(e){var target=jQuery(e.target);if(target.hasClass('overlay'))
{target=target.parent();if(target.children('img').length>0)target=target.children('img');else if(target.children('a').children('img').length>0)target=target.children('a').children('img');}
var toImage=this.getParam('gimage',target);if(toImage=='pre'){this.loadGalleryPrefix();e.stopPropagation();e.preventDefault();}else if(toImage){this.loadImageByNumber(toImage);e.stopPropagation();e.preventDefault();}},handleKeyUp:function(e){switch(e.keyCode){case jQuery.ui.keyCode.RIGHT:if(this.next_image_position)this.loadImageByNumber(this.next_image_position);break;case jQuery.ui.keyCode.LEFT:if(this.prev_image_position)this.loadImageByNumber(this.prev_image_position);break;}},loadImageByNumber:function(imageNum)
{var overlaycontainer=(this.controls.currentimage.is(':hidden'))?this.controls.currentvideo:this.controls.currentimage;this.controls.progressoverlay.width(overlaycontainer.width()).height(overlaycontainer.height()).show();var imgData=galleryData.images[(imageNum-1)];if(imgData){var img=new Image();var imgLoadedFunc=function()
{if(galleryData.images[imageNum]){var nextImage=galleryData.images[imageNum];}else{if(galleryData.pre){var nextImage=galleryData.pre;}else{var nextImage=galleryData.images[0];}}
this.next_image_position=nextImage.position;if(imageNum>1){var prevImage=galleryData.images[(imageNum-2)];}else{if(galleryData.pre){var prevImage=galleryData.pre;}else{var prevImage=galleryData.images[(galleryData.images.length-1)];}}
this.prev_image_position=prevImage.position;var thumbImg=new Image();var thumbImgLoadedFunc=function()
{jQuery('.gallery_pre').hide();jQuery('.second_separator_of_hell, .gallery_image, .galleryThumbnails .caption h1, .cn_imagedescription').show();if(this.controls.nextimage){var nextImagePos=this.getParam('gimage',jQuery(this.controls.nextimage[0]));this.controls.nextimage.removeClass('gimage_'+nextImagePos).addClass('gimage_'+nextImage.position);this.controls.nextimage[0].src=nextImage.pagerThumb;this.controls.nextimage[0].height=nextImage.pagerThumbHeight;}
if(this.controls.previmageoverlay){var prevImagePos=this.getParam('gimage',jQuery(this.controls.previmageoverlay[0]));this.controls.previmageoverlay.removeClass('gimage_'+prevImagePos).addClass('gimage_'+prevImage.position);this.controls.previmageoverlay.attr('href',prevImage.position);this.controls.previmageoverlay.show();}
this.controls.imagedescription.html(imgData.caption);jQuery('a',this.controls.imageurl).attr('href',imageNum);jQuery('a span',this.controls.imageurl).html(imageNum);this.controls.imageurl.show();this.controls.imageurlcontainer.show();if(imgData.bigimage800){jQuery('a',this.controls.image800link).attr('href',imgData.bigimage800);this.controls.image800link.show();}else{this.controls.image800link.hide();}
if(imgData.bigimage800&&imgData.bigimage1600){this.controls.sizeseppa.show();}else{this.controls.sizeseppa.hide();}
if(imgData.bigimage1600){jQuery('a',this.controls.image1600link).attr('href',imgData.bigimage1600);this.controls.image1600link.show();}else{this.controls.image1600link.hide();}
if(imgData.videoData)
{var vd=imgData.videoData;jQuery(this.controls.currentimage).hide();jQuery(this.controls.currentvideo[0]).show();jQuery(this.controls.currentimageoverlay[0]).hide();var classId='';if(jQuery('html').hasClass('ie'))
{if(vd.flashData)
{vd.player=vd.flashData;vd.flashData=false;}
classId='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000';}
var objectString='<object width="'+vd.width+'" height="'+vd.height+'"';if(vd.flashData)objectString+=' data="'+vd.flashData+'"';if(vd.objectId)objectString+=' id="'+vd.objectId+'"';objectString+=' classid="'+classId+'" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="movie" value="'+vd.player+'" /><param name="allowFullScreen" value="true" /><param name="allowScriptAccess" value="always" />';var flashVars='';for(var i=0,l=vd.customParams.length;i<l;i++)
{var item=vd.customParams[i];var lcname=item.name.toLowerCase();if(lcname=='flashvars')flashVars=item.value;else if(lcname=='allowfullscreen'||lcname=='allowscriptaccess')continue;objectString+='<param name="'+item.name+'" value="'+item.value+'" />';}
if(!vd.noEmbed)
{objectString+='<embed src="'+vd.player+'" type="application/x-shockwave-flash" pluginspage="http://www.adobe.com/go/getflashplayer" allowscriptaccess="always" allowfullscreen="true" width="'+vd.width+'" height="'+vd.height+'"';if(flashVars)objectString+=' flashvars="'+vd.flashVars+'"';if(vd.embedName)objectString+=' name="'+vd.embedName+'"';objectString+='></embed>';}
objectString+='</object>';document.getElementById('galleryPageCurrentVideo').innerHTML=objectString;this.controls.currentimageoverlay.html(imgData.position);}
else
{jQuery(this.controls.currentimageoverlay[0]).show();jQuery(this.controls.currentvideo[0]).hide();jQuery(this.controls.currentvideo[0]).html('');jQuery(this.controls.currentimage).show();this.controls.currentimage[0].src=imgData.bigimage;this.controls.currentimageoverlay.html(imgData.position);}
this.controls.progressoverlay.hide();var sitemeter_img=jQuery('#idSiteMeterHREF img');var old_src=sitemeter_img.attr('src');if(old_src)
{var last_ampersand=old_src.lastIndexOf('&');var new_src=old_src.substring(0,last_ampersand)+'&rnd='+Math.random();sitemeter_img.attr('src',new_src);}
if(typeof(quantserve)=="function"){_qpixelsent=undefined;quantserve();}};jQuery(thumbImg).load(thumbImgLoadedFunc.bind(this)).attr('src',nextImage.pagerThumb);};jQuery(img).load(imgLoadedFunc.bind(this)).attr('src',imgData.bigimage);}},loadGalleryPrefix:function(){jQuery('.gallery_pre').show();jQuery('.second_separator_of_hell, .gallery_image, .galleryThumbnails .caption h1, .cn_imagedescription, .cn_previmageoverlay').hide();jQuery('.cn_nextimage.gimage_pre').removeClass('gimage_pre').addClass('gimage_1');jQuery('.cn_previmageoverlay.gimage_pre').hide();jQuery('.cn_previmageoverlay.gimage_pre').removeClass('gimage_pre').addClass('gimage_'+(galleryData.images.length));this.controls.imageurlcontainer.hide();this.controls.imageurl.hide();this.controls.sizeseppa.hide();}});$.extend($.ui.GalleryPagerWidget,{'version':'1.0','defaults':{'onHide':function(args){},'onShow':function(args){},'onReset':function(args){},'controlClass':'gpager_control'}});})(jQuery);(function($){$.widget('ui.HybridWidget',{initialize:function(){this.settings=[];this.xhr=new XHR({klass:'hybrid',success:this.handleAjaxSuccess.bind(this)});this.loadMe();this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':this.loadMe();break;}},loadMe:function(){if(!this.loaded){this.loaded=true;this.xhr.send('/index.php',{'op':'hybrid','action':'getPage','withLogin':this.getParam('canLogin')});}},handleClick:function(e){var shouldstop=false;if(jQuery(e.target).hasClass('cn_tag')){this.tagClick(e);shouldstop=true;}else if(jQuery(e.target).hasClass('hybridsubmit')){this.saveSettings();shouldstop=true;}else if(jQuery(e.target).hasClass('hybridskip')){if(this.changed){this.saveSettings();shouldstop=true;}}else if(jQuery(e.target).hasClass('hybridEditorToggle')){if(jQuery('.hybridEditor:visible').length)jQuery('.hybridEditor').css('display','none');else jQuery('.hybridEditor').css('display','block');shouldstop=true;}else if(jQuery(e.target).hasClass('cn_signup')){this.syncEffect({'el':this,'fn':'raiseEvent','params':'presence.requiresequence.register'});shouldstop=true;}else if(jQuery(e.target).hasClass('cn_signin')){this.syncEffect({'el':this,'fn':'raiseEvent','params':'presence.requiresequence.login'});shouldstop=true;}
if(shouldstop){e.stopPropagation();e.preventDefault();return false;}},handleAjaxSuccess:function(data){if(data.html)jQuery('.hybridcontrol.cn_container').html(data.html);jQuery('.hybridcontrol.cn_container .hybridPageLoader').css('display','none');switch(data.action){case'loadSelector':this.selectorLoaded(data);break;case'saveSettings':this.toggleLoader(false);if(data.success&&data.url)location.href=data.url;break;case'getLogin':jQuery('.hybridcontrol.cn_container .login').css('display','block');break;}
jQuery('.buddyid_'+data.objectId).removeClass('user-friend-progress');jQuery('.buddyid_'+data.objectId).toggleClass('hide');},selectorLoaded:function(data){var html='';var titleHtml='';var first=true;var pos=0;this.sites=[];this.changed=false;for(var item in data.sites){if(isNaN(item))continue;var site=data.sites[item];var tags=data.tags[item];this.sites.push(parseInt(item));titleHtml+='<div class="title hybridtitle_'+item+(first?' first':'')+'">'+site+'</div>';html+='<ul class="hybridsite '+(first?'first ':'')+'hybridsite_'+item+'">';first=false;for(var i=-2,l=tags.length;i<l;i++){var tag=tags[i];if(i==-2)tag='All_Stories';else if(i==-1)tag='Top';var displayTag=tag.replace(/__/g,'/').replace(/_/g,' ');html+='<li class="hybridcontrol cn_tag hybridsite_'+item+' hybridtag_'+tag+'">'+displayTag+'</li>';}
html+='</ul>';pos++;}
jQuery('.hybridcontrol.cn_container .hybridTags').html(html+'<div style="clear: both;"></div>');jQuery('.hybridcontrol.cn_container .hybridTitle').html(titleHtml+'<div style="clear: both;"></div>');for(var i=0,l=data.settings.length;i<l;i++){var parts=data.settings[i].split('-');jQuery('.hybridsite_'+parts[0]+'.hybridtag_'+parts[1]).addClass('selected');}
this.settings=data.settings;jQuery('.hybridcontrol.cn_container .selector').css('display','block');if(this.settings.length==0)jQuery('.hybridEditor').css('display','block');jQuery('.hybridEntrance.secondParagraph').css('display','none');this.setLabels();},setLabels:function(){jQuery('#hybridSkipLink').css('display',(this.settings.length?'inline':'none'));var usedSites=[];for(var i=0,l=this.settings.length;i<l;i++){var parts=this.settings[i].split('-');if(jQuery.inArray(parseInt(parts[0]),usedSites)==-1)usedSites.push(parseInt(parts[0]));}
for(var i=0,l=this.sites.length;i<l;i++){var ttl=jQuery('.hybridTitle .hybridtitle_'+this.sites[i]);if(jQuery.inArray(this.sites[i],usedSites)!=-1)ttl.removeClass('emptySite');else ttl.addClass('emptySite');}},tagClick:function(e){var siteId=this.getParam('hybridsite',jQuery(e.target));var tag=this.getParam('hybridtag',jQuery(e.target));var tag_element=jQuery('.hybridsite_'+siteId+'.hybridtag_'+tag);if(tag_element.hasClass('selected')){tag_element.removeClass('selected');var newSettings=[];for(var i=0,l=this.settings.length;i<l;i++){if(this.settings[i]==siteId+'-'+tag)continue;newSettings.push(this.settings[i]);}
this.settings=newSettings;}else{tag_element.addClass('selected');this.settings.push(siteId+'-'+tag);}
this.setLabels();this.changed=true;},saveSettings:function(){var settingsString='';for(var i=0,l=this.settings.length;i<l;i++)
{if(i)settingsString+=',';settingsString+=encodeURIComponent(this.settings[i]);}
this.toggleLoader(true);this.xhr.send('/index.php',{'op':'hybrid','action':'saveSettings','settings':settingsString});},toggleLoader:function(show){jQuery('.hybridLoader').css('display',(show?'inline':'none'));}});$.extend($.ui.HybridWidget,{'version':'1.0','defaults':{'action_url':'/index.php','controlClass':'hybridcontrol'}});})(jQuery);(function($){$.widget('ui.InfiniteScroll',{initialize:function(){this.xhr=new XHR({type:'GET',dataType:'html',klass:'infinite_scroll',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxResult.bind(this),success:this.handleAjaxResult.bind(this)});this.nextpage=2;this.maxpage=this.getParam('maxpage',this.controls.pager);this.registerEventHandler(this.element,'click',this.handleClick.bind(this));if(this.maxpage==1)this.fireEvent('onPagerHide',this,true);},handleClick:function(e){if(!this.in_progress)this.xhr.send(this.options.action_url+(this.nextpage),null);e.stopPropagation();e.preventDefault();},handleAjaxRequest:function(){this.in_progress=true;this.fireEvent('onLoadtextHide',this,true);this.syncEffect({'el':this.controls.loadtext,'fn':'hide'});this.syncEffect({'el':this.controls.indicator,'fn':'show'});this.fireEvent('onLoadingtextShow',this,true);this.syncEffect({'el':this.controls.loadingtext,'fn':'show'});},handleAjaxResult:function(data){this.syncEffect({'el':this.controls.indicator,'fn':'hide'});this.fireEvent('onLoadingtextHide',this,true);this.syncEffect({'el':this.controls.loadingtext,'fn':'hide'});this.fireEvent('onLoadtextShow',this,true);this.syncEffect({'el':this.controls.loadtext,'fn':'show'});if(data&&data['content']){this.nextpage++;this.syncEffect({'el':this.controls.pager,'fn':'before','params':data.content});}
if(this.nextpage>this.maxpage)this.fireEvent('onPagerHide',this,true);this.in_progress=false;}});$.extend($.ui.InfiniteScroll,{version:'1.0',defaults:{'controlClass':'infinite_scroll','onLoadtextShow':function(wg){wg.controls.loadtext.fadeIn(200,function(){wg.syncEffect();});return'will_sync';},'onLoadtextHide':function(wg){wg.controls.loadtext.fadeOut(200,function(){wg.syncEffect();});return'will_sync';},'onLoadingtextShow':function(wg){wg.controls.loadingtext.fadeIn(200,function(){wg.syncEffect();});return'will_sync';},'onLoadingtextHide':function(wg){wg.controls.loadingtext.fadeOut(200,function(){wg.syncEffect();});return'will_sync';},'onPagerShow':function(wg){wg.controls.pager.fadeIn(200,function(){wg.syncEffect();});return'will_sync';},'onPagerHide':function(wg){wg.controls.pager.fadeOut(200,function(){wg.syncEffect();});return'will_sync';}}});})(jQuery);(function($){$.widget('ui.InflowNotificationWidget',{xhr:null,initialize:function(){var obj=this;this.xhr=new XHR({klass:'inflownotification','type':'GET',beforeSend:function(e){obj.handleAjaxRequest(e);},error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':this.hideWidget();this.showWidget();break;case'user.auth.failure':this.hideWidget();break;}},showWidget:function()
{this.countOnly=true;this.updatePointer=false;this.startIndex=0;this.getNotifications();},getNotifications:function()
{var params={'op':'commentinflow','countOnly':(this.countOnly?1:0),'updatePointer':(this.updatePointer?1:0),'startIndex':this.startIndex}
this.xhr.send('/index.php',params);},moreClick:function()
{this.getNotifications();},clearItems:function()
{this.updatePointer=true;this.startIndex=0;this.countOnly=true;this.getNotifications();this.hideWidget();},displayNotifications:function()
{},parseNotifications:function(items)
{var ret='';for(var i=0,l=items.length;i<l;i++)
{var item=items[i];var template=jQuery('.notificationMsgTemplates span.'+item.type).html();if(!template)template='<a href="%userLink%">%userName%</a> replied to your <a href="%commentLink%">comment</a> in <a href="%postLink%">%postName%</a> <span class="atTime">%time%</span>';for(var k in item)
{var v='';if(k=='time')v='<span title="'+item['fullTime']+'">'+item['time']+'</span>';else v=item[k];template=template.replace('%'+k+'%',v);}
ret+='<div class="notification">'+template+'</div>'+"\n";}
return ret;},handleClick:function(e){if(jQuery(e.target).hasClass('.cn_morenotification'))
{if(jQuery(e.target).hasClass('.cn_notificatonheader'))jQuery('.notifIndicator').show();else jQuery('.moreNotifIndicator').show();this.moreClick();e.stopPropagation();e.preventDefault();}
if(jQuery(e.target).hasClass('.cn_clear'))
{this.clearItems();e.stopPropagation();e.preventDefault();}},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){switch(data.action)
{case'inflownotifications':jQuery('.notifIndicator').hide();jQuery('.moreNotifIndicator').hide();if(this.countOnly)
{if(data.count>0)
{jQuery('div.lead',this.element).html(jQuery('.notificationMsgTemplates span.header-'+(data.count==1?'one':'more')).html().replace('%count%',data.count));jQuery('.see_all',this.element).attr('href',data.seeAllLink);jQuery('div.lead',this.element).show();this.element.show();}
this.countOnly=false;this.updatePointer=true;this.startIndex=0;this.loadedNotifications=0;this.itemCount=data.count;jQuery('div.lead',this.element).show();jQuery('div.notifications',this.element).hide();}
else
{this.loadedNotifications+=data.items.length;var notifCont=jQuery('div.notifications div.text',this.element);notifCont.html(notifCont.html()+this.parseNotifications(data.items));if(data.items.length>0)this.startIndex=data.items[data.items.length-1].pos+1;jQuery('div.lead',this.element).hide();jQuery('div.notifications',this.element).show();if(this.loadedNotifications>=this.itemCount)jQuery('div.notifications div.more',this.element).hide();if(this.updatePointer)this.updatePointer=false;}
break;}},handleAjaxFail:function(){}});$.extend($.ui.InflowNotificationWidget,{'version':'1.0','defaults':{'action_url':'/index.php','controlClass':'notif_control'}});})(jQuery);(function($){$.widget('ui.PostClipWidget',{xhr:null,initialize:function(){this.xhr=new XHR({klass:'postclip',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':this.showWidget();break;case'user.auth.failure':this.hideWidget();break;}},handleClick:function(e){this.togglePostClip(jQuery(e.target));e.stopPropagation();e.preventDefault();},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){jQuery('.clipid_'+data.objectId).removeClass('clip-toggle-progress');if(data.command=='tag'){jQuery('.clipid_'+data.objectId).removeClass('clip-toggle-off').addClass('clip-toggle-on').attr({'title':'Un-clip this article'});}else{jQuery('.clipid_'+data.objectId).removeClass('clip-toggle-on').addClass('clip-toggle-off').attr({'title':'Clip this article'});jQuery('#event_'+data.objectId).fadeOut();}},handleAjaxFail:function(){jQuery('.clip-toggle-progress').removeClass('clip-toggle-progress');},togglePostClip:function(element){var params={'op':'saveusertag','objectType':'POST','objectId':this.getParam('clipid',element)};if(element.hasClass('clip-toggle-on')){params.unTagName='favorite';}else{params.tagName='favorite';}
if(this.controls.postcliptoggle)this.controls.postcliptoggle.addClass('clip-toggle-progress');this.xhr.send('/',params);},hideWidget:function(){if(this.controls.postcliptoggle)this.controls.postcliptoggle.hide();},showWidget:function(){if(this.auth.authenticated&&this.auth.user.clipped&&this.controls.postcliptoggle){this.controls.postcliptoggle.removeClass('clip-toggle-on').addClass('clip-toggle-off').attr({'title':'Clip this article'});for(var i=0,l=this.auth.user.clipped.length;i<l;i++){jQuery('.clipid_'+this.auth.user.clipped[i]).removeClass('clip-toggle-off').addClass('clip-toggle-on').attr({'title':'Un-clip this article'})}
this.controls.postcliptoggle.show();}},resetWidget:function(){}});$.extend($.ui.PostClipWidget,{'version':'1.0','defaults':{'action_url':'/index.php','controlClass':'postclipcontrol'}});})(jQuery);(function($){$.widget('ui.PostStatusToggler',{xhr:null,initialize:function(){this.xhr=new XHR({klass:'post_status_toggler',success:this.promoteSuccess.bind(this),error:this.ajaxFailure.bind(this)});this.registerEventHandler(this.element,'click',this.handleStatusToggleClick.bind(this));this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':this.showWidget();break;case'user.auth.failure':this.hideWidget();break;}},handleStatusToggleClick:function(e){var target=jQuery('a',e.target);if(target.hasClass(this.options.classes['promote'])){e.stopPropagation();e.preventDefault();this.promoteItem(target.parent());}else{if(target.hasClass(this.options.classes['demote'])){e.stopPropagation();e.preventDefault();this.demoteItem(target.parent());}else if(target.hasClass(this.options.classes['sitetag'])){e.stopPropagation();e.preventDefault();this.removeSiteTag(target.parent());}}},getPostInfo:function(el,isPromotion){var ret={'el':el,'id':this.getParam(this.options['prefixes']['postid'],el)};if(isPromotion){ret['realm']=this.getParam(this.options['prefixes']['postrealm'],el);}else{ret['issued']=this.getParam(this.options['prefixes']['postissued'],el);}
ret.message=jQuery('.cn_message',el.parent());ret.indicator=jQuery('.cn_indicator',el.parent());return ret;},promoteItem:function(el){this.context=this.getPostInfo(el,true);this.context['addclass']='demote';this.context['removeclass']='promote';this.context.indicator.show();this.xhr.send(this.options.promote_url,{'id':this.context['id'],'publishStatus':'PUBLISHED','realm':this.context['realm']});},demoteItem:function(el){this.context=this.getPostInfo(el,true);this.context['addclass']='promote';this.context['removeclass']='demote';this.context.indicator.show();this.xhr.send(this.options.promote_url,{'id':this.context['id'],'publishStatus':'REVIEWED','realm':this.context['realm']});},removeSiteTag:function(el){this.context=this.getPostInfo(el,false);this.context['addclass']='removesitetag';this.context['removeclass']='addsitetag';this.context.indicator.show();this.xhr.send(this.options.sitetag_url,{'postId':this.context['id'],'postIssued':this.context['issued']});},promoteSuccess:function(data){this.context.indicator.hide();Message.showMessage(data.message,this.context.message[0]);var a=jQuery('a',this.context['el']);if(data.deleted){var postdiv=jQuery('#id_'+data.id+'_'+data.issued);window.setTimeout(function(){postdiv.hide();},3000);}
if(data.success){a.removeClass(this.options.classes[this.context['removeclass']]);a.addClass(this.options.classes[this.context['addclass']]);a.attr('title',this.options.titles[this.context['addclass']]);a.attr('alt',this.options.titles[this.context['addclass']]);}},ajaxFailure:function(){this.context.indicator.hide();Message.showMessage('Network problem has occured.',this.context.message[0]);},showWidget:function(){if(this.auth.user&&this.auth.hasLevel('editors')&&typeof this.controls.actionbutton!='undefined'){this.controls.actionbutton.show();}},hideWidget:function(){if(typeof this.controls.actionbutton!='undefined'){this.controls.actionbutton.hide();}}});$.extend($.ui.PostStatusToggler,{version:'1.0',defaults:{controlClass:'postpromotionalWidget','classes':{'promote':'doPromote','demote':'doDemote','sitetag':'doRemoveSiteTag','removesitetag':'deleteButton','addsitetag':'addButton'},'prefixes':{'postid':'tpid','postissued':'tpissued','postrealm':'tprealm'},'titles':{'promote':'Promote this post','demote':'Demote this post','addsitetag':'Add this crosspromoted post to this site','removesitetag':'Remove this crosspromoted post from this site'},'promote_url':'/?op=changepoststatus','sitetag_url':'/?op=removesitetag'}});})(jQuery);(function($){$.widget('ui.PresenceWidget',{validator:null,xhr:null,initialize:function(){this.jwindow=jQuery(window);this.xhr=new XHR({klass:'presence',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});this.registerEventHandler(this.element,'click',this.handleClicks.bind(this));var panels={};if(this.controls['login_form']){panels['login']={'el':this.controls.login_dialog,'focus':this.controls.username};this.login_validator=new Validator(jQuery.extend({},{'scope':this.controls['login_form']}));this.registerEventHandler(this.controls.login_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.login_form,'submit',this.handleLoginSubmit.bind(this));}
if(this.controls['resetpw_form']){panels['resetpw']={'el':this.controls.resetpw_dialog,'focus':this.controls.resetpwemail};this.resetpw_validator=new Validator(jQuery.extend({},{'scope':this.controls['resetpw_form']}));this.registerEventHandler(this.controls.resetpw_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.resetpw_form,'submit',this.handleResetPasswordSubmit.bind(this));}
if(this.controls['register_form']){panels['register']={'el':this.controls.register_dialog,'focus':this.controls.register_username};this.register_validator=new Validator(jQuery.extend({},{'scope':this.controls['register_form']}));this.registerEventHandler(this.controls.register_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.register_form,'submit',this.handleRegisterSubmit.bind(this));}
if(this.controls['subscribe_form']){panels['subscribe']={'el':this.controls.subscribe_dialog,'focus':this.controls.subscribe_email};this.subscribe_validator=new Validator(jQuery.extend({},{'scope':this.controls['subscribe_form']}));this.registerEventHandler(this.controls.subscribe_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.subscribe_form,'submit',this.handleSubscribeSubmit.bind(this));}
if(this.controls['commentsettings_form']){panels['commentsettings']={'el':this.controls.commentsettings_dialog};this.registerEventHandler(this.controls.commentsettings_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.commentsettings_form,'submit',this.handleCommentSettingsSubmit.bind(this));}
if(this.controls['avatarupload_form']){panels['avatarupload']={'el':this.controls.avatarupload_dialog,'focus':this.controls.avatarupload_file};this.avatarupload_validator=new Validator(jQuery.extend({},{'scope':this.controls['avatarupload_form']}));this.registerEventHandler(this.controls.avatarupload_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.avatarupload_form,'submit',this.handleAvataruploadSubmit.bind(this));GawkerClientside['callbacks']={'avatarUploadResponse':this.handleAjaxSuccess.bind(this)};}
if(this.controls['profileedit_form']){panels['profileedit']={'el':this.controls.profileedit_dialog,'focus':this.controls.profileedit_displayname};this.profileedit_validator=new Validator(jQuery.extend({},{'scope':this.controls['profileedit_form']}));this.registerEventHandler(this.controls.profileedit_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.profileedit_form,'submit',this.handleProfileeditSubmit.bind(this));}
if(this.controls['changepassword_form']){panels['changepassword']={'el':this.controls.changepassword_dialog,'focus':this.controls.changepassword_password};this.changepassword_validator=new Validator(jQuery.extend({},{'scope':this.controls['changepassword_form']}));this.registerEventHandler(this.controls.changepassword_form,'keyup',this.handleKeyUp.bind(this));this.registerEventHandler(this.controls.changepassword_form,'submit',this.handleChangepasswordSubmit.bind(this));}
this.commondialogs.initDialogs({'overlay':this.controls.overlay,'panels':panels,'group':this.options['dialoggroup']?this.options['dialoggroup']:false});this.resetWidget();this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));this.subscribeForEvent('presence.requiresequence.',this.sequenceHandler.bind(this));},authEventHandler:function(ev){var is_init=this.inState('init');switch(ev.name){case'user.auth.success':if(this.controls['profile_link'])this.controls.profile_link.attr('href','/people/'+this.auth.user.username).html(this.auth.user.smartName.length>18?(this.auth.user.smartName.substr(0,18)+'...'):this.auth.user.smartName);if(!is_init){this.fireEvent('onLoginPanelHide',this,true);this.syncEffect({'el':this.controls.login_panel,'fn':'hide'});}
this.fireEvent('onLogoutPanelShow',this,true);this.syncEffect({'el':this.controls.logout_panel,'fn':'show'});this.mystate='loggedin';if(this.controls['profilepagecontrols']){var profile_id=this.getParam('uid',this.controls.profilepagecontrols);if(this.auth.user.id===profile_id){if(!this.auth.user['fb_uid']&&this.controls['main_changepassword_link'])this.controls.main_changepassword_link.show();this.controls.profilepagecontrols.show();this.setupProfileForms();}}
break;case'user.auth.failure':if(!is_init){this.fireEvent('onLogoutPanelHide',this,true);this.syncEffect({'el':this.controls.logout_panel,'fn':'hide'});}
this.fireEvent('onLoginPanelShow',this,true);this.syncEffect({'el':this.controls.login_panel,'fn':'show'});this.mystate='loggedout:no_dialog';if(this.controls['profilepagecontrols']){if(this.controls['main_changepassword_link'])this.controls.main_changepassword_link.hide();this.controls.profilepagecontrols.hide();this.controls.profileedit_contactname[0].disabled=true;this.controls.profileedit_contactname_panel.hide();this.controls.profileedit_contactemail[0].disabled=true;this.controls.profileedit_contactemail_panel.hide();}
break;}
if(is_init&&window.location.hash.length>0){if(window.location.hash.indexOf('register')>=0){var hashparts=window.location.hash.split('|');if(hashparts.length>1&&this.controls['register_invitecode']){this.controls.register_invitecode.val(hashparts[1]);if(hashparts.length>2){if(hashparts[2]=='a'){this.controls.register_copy.html('Registering will give you a star user profile with the ability to comment immediately. You will also be able to add other users as friends.');}else if(hashparts[2]=='s'){this.controls.register_copy.html('Registering will give you a user profile with the ability to comment immediately. You will also be able to add other users as friends.');}}}
window.location.hash='';this.commondialogs.toggleDialog({'which':'register'});}else if(window.location.hash.indexOf('login')>=0){window.location.hash='';this.commondialogs.toggleDialog({'which':'login'});}else if(window.location.hash.indexOf('resetpassword')>=0){window.location.hash='';this.commondialogs.toggleDialog({'which':'resetpw'});}}},sequenceHandler:function(ev){switch(ev.name){case'presence.requiresequence.fblogin':this.triggerFBLogin();break;case'presence.requiresequence.login':this.commondialogs.toggleDialog({'which':'login'});break;case'presence.requiresequence.register':this.commondialogs.toggleDialog({'which':'register'});break;case'presence.requiresequence.resetpw':this.commondialogs.toggleDialog({'which':'resetpw'});break;}},handleClicks:function(e){var t=this.getParam('cn',e.target);var shouldstop=false;switch(t){case'fb_login':shouldstop=true;this.triggerFBLogin();break;case'login_cancel':this.xhr.abort();case'togglelogindialog':shouldstop=true;if(this.inState('loggedout:no_dialog')){this.resetWidget();}
this.commondialogs.toggleDialog({'which':'login'});break;case'logout_link':shouldstop=true;this.mystate='loggedin:logging_out:clicked';if(this.auth.user.fb_uid){this.auth.fbWhenReady(function(){FB.Connect.logout(function(){this.xhr.send(this.options.logout_action_url,{});}.bind(this));}.bind(this));}else{this.xhr.send(this.options.logout_action_url,{});}
break;case'toggleresetpwdialog':case'resetpw_cancel':shouldstop=true;this.commondialogs.toggleDialog({'which':'resetpw'});break;case'toggleregisterdialog':case'register_cancel':shouldstop=true;this.commondialogs.toggleDialog({'which':'register'});break;case'togglesubscribedialog':case'subscribe_cancel':shouldstop=true;this.commondialogs.toggleDialog({'which':'subscribe'});break;case'togglecommentsettingsdialog':case'commentsettings_cancel':shouldstop=true;this.commondialogs.toggleDialog({'which':'commentsettings'});break;case'toggleprofileeditdialog':case'profileedit_cancel':shouldstop=true;this.commondialogs.toggleDialog({'which':'profileedit'});break;case'togglechangepassworddialog':case'changepassword_cancel':shouldstop=true;this.commondialogs.toggleDialog({'which':'changepassword'});break;case'toggleavataruploaddialog':case'avatarupload_cancel':shouldstop=true;this.commondialogs.toggleDialog({'which':'avatarupload'});break;}
if(shouldstop){e.stopPropagation();e.preventDefault();}},triggerFBLogin:function(){FB.Bootstrap.requireFeatures(["Connect"],function(){FB.Connect.requireSession(function(){this.mystate='loggedout:login_dialog_active:request_sent';this.auth.fbWhenReady(function(){this.xhr.send(this.options.facebook_action_url,{'action':'loginOrRegister'});}.bind(this));}.bind(this),true);}.bind(this));this.disableInputs('login');},handleKeyUp:function(e){switch(e.keyCode){case jQuery.ui.keyCode.ESCAPE:this.commondialogs.toggleDialog();break;}},handleLoginSubmit:function(e){e.stopPropagation();e.preventDefault();this.login_validator.hideErrors();if(this.login_validator.validate()){this.mystate='loggedout:login_dialog_active:request_sent';this.xhr.send(this.options.login_action_url,this.controls.login_form.serialize());this.disableInputs('login');}else{if(this.options.show_validation_errors){this.login_validator.showErrors();}}},handleResetPasswordSubmit:function(e){e.stopPropagation();e.preventDefault();this.resetpw_validator.hideErrors();if(this.resetpw_validator.validate()){this.mystate='loggedout:resetpw_dialog_active:request_sent';this.xhr.send(this.options.resetpw_action_url,this.controls.resetpw_form.serialize());this.disableInputs('resetpw');}else{if(this.options.show_validation_errors){this.resetpw_validator.showErrors();}}},handleRegisterSubmit:function(e){e.stopPropagation();e.preventDefault();this.register_validator.hideErrors();if(this.register_validator.validate()){this.mystate='loggedout:register_dialog_active:request_sent';this.xhr.send(this.options.register_action_url,this.controls.register_form.serialize());this.disableInputs('register');}else{if(this.options.show_validation_errors){this.register_validator.showErrors();}}},handleSubscribeSubmit:function(e){this.subscribe_validator.hideErrors();if(!this.subscribe_validator.validate()){e.stopPropagation();e.preventDefault();if(this.options.show_validation_errors){this.subscribe_validator.showErrors();}}else{this.fireEvent('onSubscribeRequestSent',this);var _this=this;window.setTimeout(function(){_this.disableInputs('subscribe');},300);}},handleCommentSettingsSubmit:function(e){e.stopPropagation();e.preventDefault();this.mystate='loggedin:commentsettings_dialog_active:request_sent';this.xhr.send(this.options.setprofile_action_url,this.controls.commentsettings_form.serialize());this.disableInputs('commentsettings');},handleAvataruploadSubmit:function(e){this.avatarupload_validator.hideErrors();if(!this.avatarupload_validator.validate()){e.stopPropagation();e.preventDefault();if(this.options.show_validation_errors){this.avatarupload_validator.showErrors();}}else{this.mystate='loggedin:avatarupload_dialog_active:avatar_request_sent';if(this.controls['avatarupload_indicator'])this.controls.avatarupload_indicator.show();this.fireEvent('onAvataruploadRequestSent',this);var _this=this;window.setTimeout(function(){_this.disableInputs('avatarupload');},300);}},handleProfileeditSubmit:function(e){e.stopPropagation();e.preventDefault();this.profileedit_validator.hideErrors();if(this.profileedit_validator.validate()){this.mystate='loggedin:profileedit_dialog_active:request_sent';this.xhr.send(this.options.setprofile_action_url,this.controls.profileedit_form.serialize());this.disableInputs('profileedit');}else{if(this.options.show_validation_errors){this.profileedit_validator.showErrors();}}},handleChangepasswordSubmit:function(e){e.stopPropagation();e.preventDefault();this.changepassword_validator.hideErrors();if(this.changepassword_validator.validate()){this.mystate='loggedin:changepassword_dialog_active:request_sent';this.xhr.send(this.options.setprofile_action_url,this.controls.changepassword_form.serialize());this.disableInputs('changepassword');}else{if(this.options.show_validation_errors){this.changepassword_validator.showErrors();}}},handleAjaxRequest:function(){if(this.inState('loggedin:logging_out:clicked')){if(this.controls['logout_indicator'])this.controls.logout_indicator.show();this.fireEvent('onLogoutRequestSent',this);this.mystate='loggedin:logging_out';}else if(this.inState('loggedout:login_dialog_active:request_sent')){if(this.controls['login_indicator'])this.controls.login_indicator.show();this.fireEvent('onLoginRequestSent',this);}else if(this.inState('loggedout:resetpw_dialog_active:request_sent')){if(this.controls['resetpw_indicator'])this.controls.resetpw_indicator.show();this.fireEvent('onResetPWRequestSent',this);}else if(this.inState('loggedout:register_dialog_active:request_sent')){if(this.controls['register_indicator'])this.controls.register_indicator.show();this.fireEvent('onRegisterRequestSent',this);}else if(this.inState('loggedin:commentsettings_dialog_active:request_sent')){if(this.controls['commentsettings_indicator'])this.controls.commentsettings_indicator.css('display','inline');this.fireEvent('onCommentSettingsRequestSent',this);}else if(this.inState('loggedin:profileedit_dialog_active:request_sent')){if(this.controls['profileedit_indicator'])this.controls.profileedit_indicator.show();this.fireEvent('onProfileEditRequestSent',this);}else if(this.inState('loggedin:changepassword_dialog_active:request_sent')){if(this.controls['changepassword_indicator'])this.controls.changepassword_indicator.show();this.fireEvent('onChangePasswordRequestSent',this);}},handleAjaxSuccess:function(data){switch(data['action']){case'login':case'fblogin':Message.showMessage(data.message,this.controls.loginmessage[0]);if(this.controls.login_indicator)this.controls.login_indicator.hide();this.enableInputs('login');if(data['success']){this.auth.user=data.user;this.auth.authenticated=true;this.fireEvent('onLoginSuccess',this,true);this.syncEffect({'el':this.commondialogs,'fn':'toggleDialog','params':{'which':'login','sync_this':this.syncEffect.bind(this)}});this.resetWidget({'except':'login_form'});this.syncEffect({'el':this,'fn':'resetWidget','params':{'only':'login_form'}});this.raiseEvent('user.auth.success',data);this.auth.resetRevision();}else{this.fireEvent('onLoginFailure',this);}
break;case'logout':if(data['success']){this.auth.user=false;this.auth.authenticated=false;this.fireEvent('onLogoutSuccess',this);this.raiseEvent('user.auth.failure',data);this.auth.resetRevision();}else{this.fireEvent('onLogoutFailure',this);}
if(this.controls.logout_indicator)this.controls.logout_indicator.hide();break;case'register':Message.showMessage(data.message,this.controls.registermessage[0]);if(this.controls.register_indicator)this.controls.register_indicator.hide();this.enableInputs('register');if(data['success']){this.auth.user=data.user;this.auth.authenticated=true;this.fireEvent('onRegisterSuccess',this,true);this.syncEffect({'el':this.commondialogs,'fn':'toggleDialog','params':{'which':'register','sync_this':this.syncEffect.bind(this)}});this.resetWidget({'except':'register_form'});this.syncEffect({'el':this,'fn':'resetWidget','params':{'only':'register_form'}});this.raiseEvent('user.auth.success',data);this.auth.resetRevision();}else{this.fireEvent('onRegisterFailure',this);}
break;case'resetpassword':if(data['success']){this.commondialogs.toggleDialog({'which':'resetpw'});this.fireEvent('onResetPWSuccess',this);}else{this.fireEvent('onResetPWFailure',this);}
Message.showMessage(data.message,this.controls.resetpwmessage[0]);if(this.controls.resetpw_indicator)this.controls.resetpw_indicator.hide();this.enableInputs('resetpw');break;case'setprofile':if(this.inState('loggedin:changepassword_dialog_active:request_sent')){if(data['success']){Message.showMessage('Password saved.',this.controls.changepassword_message[0],{stable:false});this.commondialogs.toggleDialog({'which':'changepassword'});}else{Message.showMessage('Password save failed.',this.controls.changepassword_message[0],{stable:false});}
if(this.controls['changepassword_indicator'])this.controls.changepassword_indicator.hide();this.enableInputs('changepassword');}else if(this.inState('loggedin:profileedit_dialog_active:request_sent')){if(data['success']){Message.showMessage('Profile saved.',this.controls.profileedit_message[0],{stable:false});this.auth.user.smartName=this.controls.profileedit_displayname.val();this.auth.user['url']=this.controls.profileedit_url.val();this.auth.user['email']=this.controls.profileedit_email.val();this.auth.user['aimname']=this.controls.profileedit_aimname.val();if(this.controls['profileedit_extended']){for(var i=0,l=this.controls.profileedit_extended.length;i<l;i++){var extname=this.getParam('ext',this.controls.profileedit_extended[i]);this.auth.user[extname]=this.controls.profileedit_extended.eq(i).val();}}
this.commondialogs.toggleDialog({'which':'profileedit'});this.auth.resetRevision();}else{Message.showMessage('Profile save failed.',this.controls.profileedit_message[0],{stable:false});}
if(this.controls['profileedit_indicator'])this.controls.profileedit_indicator.hide();this.enableInputs('profileedit');}else if(this.inState('loggedin:commentsettings_dialog_active:request_sent')){if(data['success']){this.commondialogs.toggleDialog({'which':'commentsettings'});this.auth.user.commentViewMode=data.commentViewMode;this.auth.user.commentOrder=data.commentOrder;this.auth.resetRevision();}else{Message.showMessage('Save failed.',this.controls.commentsettings_message[0],{stable:false});}
if(this.controls.commentsettings_indicator)this.controls.commentsettings_indicator.hide();this.enableInputs('commentsettings');}
break;case'avatarupload':if(data['success']){this.controls['profileedit_avatarimage'].attr({'src':data.big});this.auth.user.avatarPath=data.big;Message.showMessage(data.message,this.controls.avatarupload_message[0],{stable:false});this.mystate='loggedin:avatarupload_dialog_active';this.commondialogs.toggleDialog({'which':'avatarupload'});this.auth.resetRevision();this.fireEvent('onAvataruploadSuccess',this);}else{this.fireEvent('onAvataruploadFailure',this);Message.showMessage(data.message,this.controls.avatarupload_message[0],{stable:false});}
if(this.controls['avatarupload_indicator'])this.controls.avatarupload_indicator.hide();this.enableInputs('avatarupload');break;};},handleAjaxFail:function(){if(this.inState('loggedin')){if(this.inState('loggedin:logging_out')){if(this.controls.logout_indicator)this.controls.logout_indicator.hide();this.fireEvent('onLogoutFailure',this);this.mystate='loggedin';}else if(this.inState('loggedin:commentsettings_dialog_active:request_sent')){if(this.controls['commentsettings_indicator'])this.controls.commentsettings_indicator.css('display','none');this.fireEvent('onCommentSettingsRequestFail',this);this.mystate='loggedin:commentsettings_dialog_active';}else if(this.inState('loggedin:profileedit_dialog_active:request_sent')){if(this.controls['profileedit_indicator'])this.controls.profileedit_indicator.hide();this.fireEvent('onProfileEditRequestFail',this);this.mystate='loggedin:profileedit_dialog_active';}else if(this.inState('loggedin:changepassword_dialog_active:request_sent')){if(this.controls['changepassword_indicator'])this.controls.changepassword_indicator.hide();this.fireEvent('onChangePasswordRequestFail',this);this.mystate='loggedin:changepassword_dialog_active';}}else{if(this.inState('loggedout:login_dialog_active:request_sent')){if(this.controls.login_indicator)this.controls.login_indicator.hide();this.fireEvent('onLoginRequestFail',this);this.mystate='loggedout:login_dialog_active';this.enableInputs('login');}else if(this.inState('loggedout:resetpw_dialog_active:request_sent')){if(this.controls.resetpw_indicator)this.controls.resetpw_indicator.hide();this.fireEvent('onResetPWRequestFail',this);this.mystate='loggedout:resetpw_dialog_active';this.enableInputs('resetpw');}else if(this.inState('loggedout:register_dialog_active:request_sent')){if(this.controls.register_indicator)this.controls.register_indicator.hide();this.fireEvent('onRegisterRequestFail',this);this.mystate='loggedout:register_dialog_active';this.enableInputs('register');}}},disableInputs:function(which){switch(which){case'login':this.controls.username[0].disabled=true;this.controls.password[0].disabled=true;this.controls.login_button[0].disabled=true;break;case'resetpw':this.controls.resetpwemail[0].disabled=true;this.controls.resetpw_submit[0].disabled=true;this.controls.resetpw_cancel[0].disabled=true;break;case'register':this.controls.register_username[0].disabled=true;this.controls.register_password[0].disabled=true;this.controls.register_confirm_password[0].disabled=true;this.controls.register_email[0].disabled=true;this.controls.register_remember[0].disabled=true;this.controls.register_submit[0].disabled=true;this.controls.register_cancel[0].disabled=true;break;case'subscribe':this.controls.subscribe_email[0].disabled=true;this.controls.subscribe_submit[0].disabled=true;this.controls.subscribe_cancel[0].disabled=true;break;case'commentsettings':this.controls.commentsettings_submit[0].disabled=true;this.controls.commentsettings_cancel[0].disabled=true;this.controls.cvm_featured[0].disabled=true;this.controls.cvm_hidden[0].disabled=true;this.controls.corder_desc[0].disabled=true;this.controls.corder_asc[0].disabled=true;break;case'profileedit':this.controls.profileedit_displayname[0].disabled=true;this.controls.profileedit_url[0].disabled=true;this.controls.profileedit_email[0].disabled=true;this.controls.profileedit_aimname[0].disabled=true;if(this.controls['profileedit_extended']){for(var i=0,l=this.controls.profileedit_extended.length;i<l;i++){var extname=this.getParam('ext',this.controls.profileedit_extended[i]);this.controls.profileedit_extended[i].disabled=true;}}
if(this.auth.authenticated&&this.auth.hasLevel('authors')){this.controls.profileedit_contactname[0].disabled=true;this.controls.profileedit_contactemail[0].disabled=true;}
this.controls.profileedit_submit[0].disabled=true;this.controls.profileedit_cancel[0].disabled=true;break;case'changepassword':this.controls.changepassword_password[0].disabled=true;this.controls.changepassword_new_password[0].disabled=true;this.controls.changepassword_confirm_password[0].disabled=true;this.controls.changepassword_submit[0].disabled=true;this.controls.changepassword_cancel[0].disabled=true;break;case'avatarupload':this.controls.avatarupload_file[0].disabled=true;this.controls.avatarupload_submit[0].disabled=true;this.controls.avatarupload_cancel[0].disabled=true;break;}},enableInputs:function(which){switch(which){case'login':this.controls.username[0].disabled=false;this.controls.password[0].disabled=false;this.controls.login_button[0].disabled=false;break;case'resetpw':this.controls.resetpwemail[0].disabled=false;this.controls.resetpw_submit[0].disabled=false;this.controls.resetpw_cancel[0].disabled=false;break;case'register':this.controls.register_username[0].disabled=false;this.controls.register_password[0].disabled=false;this.controls.register_confirm_password[0].disabled=false;this.controls.register_email[0].disabled=false;this.controls.register_remember[0].disabled=false;this.controls.register_submit[0].disabled=false;this.controls.register_cancel[0].disabled=false;break;case'subscribe':this.controls.subscribe_email[0].disabled=false;this.controls.subscribe_submit[0].disabled=false;this.controls.subscribe_cancel[0].disabled=false;break;case'commentsettings':this.controls.commentsettings_submit[0].disabled=false;this.controls.commentsettings_cancel[0].disabled=false;if(this.controls.togglecommentsettingsdialog&&this.controls.togglecommentsettingsdialog[1])this.controls.togglecommentsettingsdialog[1].disabled=false;this.controls.cvm_featured[0].disabled=false;this.controls.cvm_hidden[0].disabled=false;this.controls.corder_desc[0].disabled=false;this.controls.corder_asc[0].disabled=false;break;case'profileedit':this.controls.profileedit_displayname[0].disabled=false;this.controls.profileedit_url[0].disabled=false;this.controls.profileedit_email[0].disabled=false;this.controls.profileedit_aimname[0].disabled=false;if(this.controls['profileedit_extended']){for(var i=0,l=this.controls.profileedit_extended.length;i<l;i++){var extname=this.getParam('ext',this.controls.profileedit_extended[i]);this.controls.profileedit_extended[i].disabled=false;}}
if(this.auth.authenticated&&this.auth.hasLevel('authors')){this.controls.profileedit_contactname[0].disabled=false;this.controls.profileedit_contactemail[0].disabled=false;}
this.controls.profileedit_submit[0].disabled=false;this.controls.profileedit_cancel[0].disabled=false;break;case'changepassword':this.controls.changepassword_password[0].disabled=false;this.controls.changepassword_new_password[0].disabled=false;this.controls.changepassword_confirm_password[0].disabled=false;this.controls.changepassword_submit[0].disabled=false;this.controls.changepassword_cancel[0].disabled=false;break;case'avatarupload':this.controls.avatarupload_file[0].disabled=false;this.controls.avatarupload_submit[0].disabled=false;this.controls.avatarupload_cancel[0].disabled=false;break;}},resetWidget:function(params){if(!params)params={'except':false,'only':false};else{if(!params['except'])params['except']=false;if(!params['only'])params['only']=false;}
var mustbreak=params['only']?true:false;switch(params['only']){default:case'login_form':if(this.controls['login_form']&&params['except']!=='login_form'){this.controls.login_form[0].reset();this.login_validator.hideErrors();this.controls.login_button[0].value='Login';this.controls.login_indicator.hide();this.enableInputs('login');}
if(mustbreak)break;case'resetpw_form':if(this.controls['resetpw_form']&&params['except']!=='resetpw_form'){this.controls.resetpw_form[0].reset();this.resetpw_validator.hideErrors();this.enableInputs('resetpw');}
if(mustbreak)break;case'register_form':if(this.controls['register_form']&&params['except']!=='register_form'){this.controls.register_form[0].reset();this.register_validator.hideErrors();this.enableInputs('register');}
if(mustbreak)break;case'subscribe_form':if(this.controls['subscribe_form']&&params['except']!=='subscribe_form'){this.controls.subscribe_form[0].reset();this.subscribe_validator.hideErrors();this.enableInputs('subscribe');}
if(mustbreak)break;case'commentsettings_form':if(this.controls['commentsettings_form']&&params['except']!=='commentsettings_form'){this.controls.commentsettings_form[0].reset();this.enableInputs('commentsettings');}
if(mustbreak)break;case'profileedit_form':if(this.controls['profileedit_form']&&params['except']!=='profileedit_form'){this.controls.profileedit_form[0].reset();this.enableInputs('profileedit');}
if(mustbreak)break;case'avatarupload_form':if(this.controls['avatarupload_form']&&params['except']!=='avatarupload_form'){this.controls.avatarupload_form[0].reset();this.enableInputs('avatarupload');}
if(mustbreak)break;case'changepassword_form':if(this.controls['changepassword_form']&&params['except']!=='changepassword_form'){this.controls.changepassword_form[0].reset();this.enableInputs('changepassword');}
if(mustbreak)break;}},setupProfileForms:function(){if(this.auth.authenticated){if(this.controls['profileedit_form']){this.controls.profileedit_displayname.val(this.auth.user.smartName);this.controls.profileedit_url.val(this.auth.user['url']?this.auth.user['url']:'');this.controls.profileedit_email.val(this.auth.user['email']?this.auth.user['email']:'');this.controls.profileedit_aimname.val(this.auth.user['aimname']?this.auth.user['aimname']:'');if(this.controls['profileedit_extended']){for(var i=0,l=this.controls.profileedit_extended.length;i<l;i++){var extname=this.getParam('ext',this.controls.profileedit_extended[i]);this.controls.profileedit_extended.eq(i).val(this.auth.user[extname]?this.auth.user[extname]:'');}}
if(this.auth.hasLevel('authors')){this.controls.profileedit_contactname[0].disabled=false;this.controls.profileedit_contactname_panel.show();this.controls.profileedit_contactemail[0].disabled=false;this.controls.profileedit_contactemail_panel.show();this.controls.profileedit_contactname.val(this.auth.user['contactName']?this.auth.user['contactName']:'');this.controls.profileedit_contactemail.val(this.auth.user['contactEmail']?this.auth.user['contactEmail']:'');}else{this.controls.profileedit_contactname.val('');this.controls.profileedit_contactemail.val('');this.controls.profileedit_contactname[0].disabled=true;this.controls.profileedit_contactname_panel.hide();this.controls.profileedit_contactemail[0].disabled=true;this.controls.profileedit_contactemail_panel.hide();}}
if(this.controls['avatarupload_form']){if(this.controls['profileedit_avatarimage'])this.controls['profileedit_avatarimage'].attr({'src':this.options.commenterimage_host_prefix+this.auth.user.avatarPath+this.options.commenterimage_host_postfix});this.controls.avatarupload_authtoken.val(this.auth.user['authToken']?this.auth.user['authToken']:'');}
if(this.controls['changepassword_form']){this.controls.changepassword_username.val(this.auth.user.username);this.controls.changepassword_id.val(this.auth.user.id);this.controls.changepassword_password.val('');this.controls.changepassword_new_password.val('');this.controls.changepassword_confirm_password.val('');}
if(this.controls['commentsettings_form']){if(this.auth.user['commentViewMode']&&this.auth.user['commentViewMode']=='featured'){this.controls.cvm_hidden[0].checked='false';this.controls.cvm_featured[0].checked='true';}else{this.controls.cvm_featured[0].checked='false';this.controls.cvm_hidden[0].checked='true';}
if(this.auth.user['commentOrder']&&this.auth.user['commentOrder']=='asc'){this.controls.corder_desc[0].checked='false';this.controls.corder_asc[0].checked='true';}else{this.controls.corder_asc[0].checked='false';this.controls.corder_desc[0].checked='true';}}}}});$.extend($.ui.PresenceWidget,{version:'1.0',defaults:{controlClass:'presence_control',selectors:{},show_validation_errors:true,isReloading:true,facebook_action_url:'/?op=fb',login_action_url:'/?op=ajax_login',logout_action_url:'/?op=ajax_logout',register_action_url:'/?op=register',resetpw_action_url:'/?op=emailpassword',setprofile_action_url:'/?op=setprofile',externalElement:'.presence_control_external',commenterimage_host_prefix:'http://cache-foo.gawker.com/gawker/assets/images/commenter/',commenterimage_host_postfix:'_160.jpg','onLoginRequestSent':function(wg){wg.controls.login_button[0].value='Logging in...';},'onLoginRequestFail':function(wg){Message.showMessage('Login failed',wg.controls.login_button[0],{'nextMessage':'Login'});},'onLoginSuccess':function(wg){Message.showMessage('Logged in',wg.controls.login_button[0],{'nextMessage':'Login'});window.setTimeout(function(){wg.syncEffect();},500);if(wg.options.isReloading==true)window.location.reload();return'will_sync';},'onLoginFailure':function(wg){Message.showMessage('Login failed',wg.controls.login_button[0],{'nextMessage':'Login'});},'onLoginPanelShow':function(wg){wg.controls.login_panel.fadeIn(500,function(){wg.syncEffect();});return'will_sync';},'onLoginPanelHide':function(wg){wg.controls.login_panel.fadeOut(500,function(){wg.syncEffect();});return'will_sync';},'onLogoutRequestSent':function(wg){wg.controls.logout_link.html('Logging out...');},'onLogoutRequestFail':function(wg){wg.controls.logout_link.html('Logging out...');},'onLogoutSuccess':function(wg){if(wg.options.isReloading==true){window.location.reload();}else{Message.showMessage('Logged out',wg.controls.logout_link[0],{'nextMessage':'logout'});}},'onLogoutFailure':function(wg){Message.showMessage('Logout failed',wg.controls.logout_link[0],{'nextMessage':'logout'});},'onLogoutPanelShow':function(wg){wg.controls.logout_panel.fadeIn(500,function(){wg.syncEffect();});return'will_sync';},'onLogoutPanelHide':function(wg){wg.controls.logout_panel.fadeOut(500,function(){wg.syncEffect();});return'will_sync';},'onResetPWRequestSent':function(wg){wg.controls.resetpw_submit[0].value='Resetting...';},'onResetPWRequestFail':function(wg){Message.showMessage('Reset failed',wg.controls.resetpw_submit[0],{'nextMessage':'Reset'});},'onResetPWSuccess':function(wg){Message.showMessage('Password sent',wg.controls.resetpw_submit[0],{'nextMessage':'Reset'});},'onResetPWFailure':function(wg){Message.showMessage('Reset failed',wg.controls.resetpw_submit[0],{'nextMessage':'Reset'});},'onRegisterRequestSent':function(wg){wg.controls.register_submit[0].value='Registering...';},'onRegisterRequestFail':function(wg){Message.showMessage('Register failed',wg.controls.register_submit[0],{'nextMessage':'Register'});},'onRegisterSuccess':function(wg){Message.showMessage('Done',wg.controls.register_submit[0],{'nextMessage':'Register'});window.setTimeout(function(){wg.syncEffect();},1000);return'will_sync';},'onRegisterFailure':function(wg){Message.showMessage('Register failed',wg.controls.register_submit[0],{'nextMessage':'Register'});},'onSubscribeRequestSent':function(wg){wg.controls.subscribe_submit[0].value='Subscribing...';},'onCommentSettingsRequestSent':function(wg){},'onProfileeditRequestSent':function(wg){wg.controls.profileedit_submit[0].value='Saving profile...';},'onProfileeditRequestFail':function(wg){Message.showMessage('Profile save failed.',wg.controls.profileedit_submit[0],{'nextMessage':'Save profile'});},'onProfileeditSuccess':function(wg){Message.showMessage('Done',wg.controls.profileedit_submit[0],{'nextMessage':'Save profile'});},'onProfileeditFailure':function(wg){Message.showMessage('Profile save failed.',wg.controls.profileedit_submit[0],{'nextMessage':'Save profile'});},'onChangepasswordRequestSent':function(wg){wg.controls.changepassword_submit[0].value='Saving password...';},'onChangepasswordRequestFail':function(wg){Message.showMessage('Password save failed.',wg.controls.changepassword_submit[0],{'nextMessage':'Save'});},'onChangepasswordSuccess':function(wg){Message.showMessage('Done',wg.controls.changepassword_submit[0],{'nextMessage':'Save'});},'onChangepasswordFailure':function(wg){Message.showMessage('Password save failed.',wg.controls.changepassword_submit[0],{'nextMessage':'Save'});},'onAvataruploadRequestSent':function(wg){wg.controls.avatarupload_submit[0].value='Sending image...';},'onAvataruploadRequestFail':function(wg){Message.showMessage('Image upload failed.',wg.controls.avatarupload_submit[0],{'nextMessage':'upload image'});},'onAvataruploadSuccess':function(wg){Message.showMessage('Done',wg.controls.avatarupload_submit[0],{'nextMessage':'upload image'});},'onAvataruploadFailure':function(wg){Message.showMessage('Image upload failed.',wg.controls.avatarupload_submit[0],{'nextMessage':'upload image'});}}});})(jQuery);jQuery.extend(settings.widgets,{profileeditor:{klass:'ProfileEditorWidget',byselector:{'#profileEditor':{eventHandlerBuilder:function(pagecontroller_instance){},terminating_el:'.terminating',options:{}}}}});(function($){$.widget('ui.ProfileEditorWidget',{validator:null,xhr:null,initialize:function(){this.element.accordion({'autoHeight':false});this.registerEventHandler(this.controls.profileEditorForm,'submit',this.handleSubmit.bind(this));this.registerEventHandler(this.controls.passwordEditorForm,'submit',this.handleSubmit.bind(this));var profileValidator=new Validator(jQuery.extend({},{'scope':this.controls.profileEditorForm}));this.controls.profileEditorForm.data('validator',profileValidator);this.controls.profileEditorForm.data('indicator',this.controls.profileIndicator);var passwordValidator=new Validator(jQuery.extend({},{'scope':this.controls.passwordEditorForm}));this.controls.passwordEditorForm.data('validator',passwordValidator);this.controls.passwordEditorForm.data('indicator',this.controls.passwordIndicator);this.xhr=new XHR({klass:'profileeditor',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});},setUser:function(user){for(groupId in user.groups){if(user.groups[groupId].name=='removedusers'){this.controls.screenNameRO.show();return true;}}
this.controls.screenNameRW.show();return true;},handleSubmit:function(e){var target=jQuery(e.target);target.data('validator').hideErrors();this.controls.profileMessage[0].innerHTML='';this.controls.passwordMessage[0].innerHTML='';if(target.data('validator').validate()){target.data('indicator').show();this.xhr.send(this.options.action_url,target.serialize());}
else
{if(this.options.show_validation_errors){target.data('validator').showErrors();}}
e.preventDefault();e.stopPropagation();},handleAjaxRequest:function(){this.disableInputs();},handleAjaxSuccess:function(data){switch(data.action)
{case'setprofile':var messageContainer=this.controls.profileMessage;break;case'setpassword':var messageContainer=this.controls.passwordMessage;break;}
Message.showMessage(data.message,messageContainer[0],{stable:!data.success});this.controls.profileIndicator.hide();this.controls.passwordIndicator.hide();this.enableInputs();},handleAjaxFail:function(){var message='Error occurred, please try again later.';Message.showMessage(message,this.controls.profileMessage[0]);Message.showMessage(message,this.controls.passwordMessage[0]);this.controls.profileIndicator.hide();this.controls.passwordIndicator.hide();this.enableInputs();},hideWidget:function(){},showWidget:function(){},resetWidget:function(){},disableInputs:function(){jQuery('input',this.element).each(function(i,element){element.disabled=true;});},enableInputs:function(){jQuery('input',this.element).each(function(i,element){element.disabled=false;});}});$.extend($.ui.ProfileEditorWidget,{version:'1.0',defaults:{show_validation_errors:true,action_url:'/index.php'}});})(jQuery);(function($){$.widget('ui.PromoteTweetWidget',{xhr:null,initialize:function(){this.registerEventHandler(this.element,'click',this.handleClick.bind(this));var obj=this;this.xhr=new XHR({klass:'buddytoggle',beforeSend:function(e){obj.handleAjaxRequest(e);},error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});},handleClick:function(e){if(jQuery(e.target).hasClass('cn_promote'))
{if(jQuery(e.target).hasClass('hasPost'))
{var publishUrl='http://publish.'+this.auth.site.canonicalHost.replace(/^([^\.]*\.)?([^\.]*\.[^\.]*)$/,'$2')+'/ged/'+this.getParam('postId',jQuery(e.target));location.href=publishUrl;}
else
{this.getUserList(this.getParam('tweetid',jQuery(e.target)),this.getParam('tweetfeed',jQuery(e.target)));if(!jQuery('#tweetPromoteMenu').is(':hidden'))jQuery('#tweetPromoteMenu').slideUp(this.options.effectsSlideSpeed);}
e.stopPropagation();e.preventDefault();}
else if(jQuery(e.target).hasClass('cn_promotelink'))
{this.promoteTweet(this.getParam('tweetid',jQuery(e.target)),this.getParam('userid',jQuery(e.target)),this.getParam('feed',jQuery(e.target)));e.stopPropagation();e.preventDefault();}},getUserList:function(tweetId,feed)
{this.xhr.send('/index.php',{'op':'tweet_authorlist','tweetId':tweetId,'feed':feed});this.showProgress(true,tweetId);},promoteTweet:function(tweetId,userId,feed)
{this.xhr.send('/index.php',{'op':'tweet_promote','postId':tweetId,'feed':feed,'authorId':userId});this.showProgress(true,tweetId);},showProgress:function(show,tweetId)
{if(!tweetId)tweetId=0;jQuery('#tweetPromoteProgress').appendTo((show?'.cn_promote.tweetid_'+tweetId:'#tweetPromoteToolsContainer'));},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){this.showProgress(false);switch(data.action)
{case'tweet_authorlist':var divObj=jQuery('#tweetPromoteMenu');var linkPanel=jQuery('.cn_promote.tweetid_'+data.tweetId);divObj.empty();if(data.success)
{divObj.append('<span class="smallfont">Choose an author:</span><br />');for(var i=0,l=data.users.length;i<l;i++)divObj.append('<a href="#" class="smallfont promotetweetcontrol cn_promotelink feed_'+data.feed+' tweetid_'+data.tweetId+' userid_'+data.users[i].id+'">'+data.users[i].name+'</a><br />');divObj.css('position','absolute');divObj.css('top',Math.round(linkPanel.offset()['top'])+'px');divObj.css('left',Math.round((linkPanel.offset()['left'])+linkPanel.width()+10)+'px');divObj.css('border','1px dotted #cccccc');divObj.css('padding','5px');divObj.appendTo("#tweet_"+data.tweetId);divObj.slideDown(this.options.effectsSlideSpeed);}
else
{}
break;case'tweet_promote':if(!jQuery('#tweetPromoteMenu').is(':hidden'))jQuery('#tweetPromoteMenu').slideUp(this.options.effectsSlideSpeed);if(data.success)
{jQuery('.cn_promote.tweetid_'+data.tweetId).text('edit promoted post');jQuery('.cn_promote.tweetid_'+data.tweetId).addClass('hasPost');jQuery('.cn_promote.tweetid_'+data.tweetId).addClass('postId_'+data.postId);}
else
{jQuery('.cn_promote.tweetid_'+data.tweetId).text('promote again');}
break;}
jQuery('.buddyid_'+data.objectId).removeClass('user-friend-progress');jQuery('.buddyid_'+data.objectId).toggleClass('hide');},handleAjaxFail:function(){this.showProgress(false);}});$.extend($.ui.PromoteTweetWidget,{'version':'1.0','defaults':{'action_url':'/index.php','controlClass':'promotetweetcontrol'}});})(jQuery);jQuery.extend(settings.widgets,{rating:{klass:'RatingWidget',byselector:{'.ganjaRatingWidget':{eventHandlerBuilder:function(pagecontroller_instance){return{onMouseaction:function(widget){for(var i=0,l=widget.controls.stars.length;i<l;i++)
{if(i<widget.actualRating)
{jQuery(widget.controls.stars[i]).removeClass('empty');jQuery(widget.controls.stars[i]).addClass('filled');}
else
{jQuery(widget.controls.stars[i]).removeClass('filled');jQuery(widget.controls.stars[i]).addClass('empty');}}}};},terminating_el:'.terminating',options:{selectors:{},action_url:'/?op=postrating'}}}}});(function($){$.widget('ui.RatingWidget',{actualRating:null,xhr:null,initialize:function(){this.registerEventHandler(this.element,'mouseout',this.handleMouseout.bind(this));this.registerEventHandler(this.element,'mouseover',this.handleMouseover.bind(this));this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.xhr=new XHR({klass:'rating',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});},handleMouseover:function(e){for(var i=0,l=this.controls.stars.length;i<l;i++){if(e.originalTarget==this.controls.stars[i]){this.setRating(i+1);}}
this.fireEvent('onMouseaction',this);e.stopPropagation();return false;},handleMouseout:function(e){this.setRating(this.getParam('userRating'));e.stopPropagation();this.fireEvent('onMouseaction',this);},handleClick:function(e){if(this.option('disabled')==false){var url=e.originalTarget.href+'&mode=ajax';this.xhr.send(url);this.disable();}
e.stopPropagation();return false;},handleAjaxRequest:function(){this.toggleIndicator();},handleAjaxSuccess:function(data){this.toggleIndicator();if(data.action=='postrating'&&data.success==true){this.setParam('userRating',data.rating);this.setRating(data.rating);this.fireEvent('onMouseaction',this);}
this.enable();},handleAjaxFail:function(){this.toggleIndicator();this.enable();},setRating:function(r){this.actualRating=r;}});$.extend($.ui.RatingWidget,{version:'1.0',defaults:{controlClass:'ratingcontrol'}});})(jQuery);(function($){$.widget('ui.ReplycountWidget',{initialize:function(){this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':if(this.auth.user.reply_count&&this.auth.user.reply_count>0)this.controls.replycount.html(this.auth.user.reply_count);this.fireEvent('onShow',this);this.element.show();break;case'user.auth.faliure':this.fireEvent('onHide',this);this.element.hide();this.controls.replycount.html('');break;}},handleClick:function(e){e.stopPropagation();window.location='/people/'+this.auth.user.username+'/replies';}});$.extend($.ui.ReplycountWidget,{version:'1.0',defaults:{controlClass:'replycount_control'}});})(jQuery);(function($){$.widget('ui.SearchFormWidget',{initialize:function(){if(this.controls.q[0].value==''){this.controls.q[0].value=this.options.defaultValue;this.controls.q.addClass('noq');}
this.registerEventHandler(this.controls.form[0],'submit',this.handleSubmit.bind(this));this.registerEventHandler(this.controls.q[0],'focus',this.inputFocus.bind(this));this.registerEventHandler(this.controls.q[0],'blur',this.inputBlur.bind(this));},handleSubmit:function(e){Logger.debugLog('SearchFormWidget handleSubmit');if(this.controls.q[0].value==''){Message.showMessage('Please provide a search phrase.',this.controls.q[0],{'stable':false});e.preventDefault();e.stopPropagation();return false;}
this.controls.form[0].action=this.controls.form[0].action+'/'+this.controls.q[0].value;if(this.controls.searchall[0].value==1){this.controls.form[0].action=this.controls.form[0].action+'/all';}},inputFocus:function(e){Logger.debugLog('SearchFormWidget inputFocus');if(this.controls.q[0].value==this.options.defaultValue){this.controls.q[0].value='';}
this.controls.q.removeClass('noq');},inputBlur:function(e){Logger.debugLog('SearchFormWidget inputBlur');if(this.controls.q[0].value==''){this.controls.q.addClass('noq');this.controls.q[0].value=this.options.defaultValue;}}});$.extend($.ui.SearchFormWidget,{version:'1.0',defaults:{controlClass:'searchControl',defaultValue:'Search'}});})(jQuery);jQuery.extend(settings.widgets,{simpleform:{klass:'SimpleFormWidget',byselector:{'#helpMessage':{eventHandlerBuilder:function(pagecontroller_instance){return{onHide:function(args){},onShow:function(args){},onReset:function(args){},onClick:function(args){},onAjaxSuccess:function(args){},onAjaxFailure:function(args){}}},terminating_el:'.terminating',options:{show_validation_errors:true,action_url:'/index.php',controlClass:'helpcontrol',xhrKlass:'helpmessage'}},'#mail2container':{options:{show_validation_errors:true,action_url:'/index.php',controlClass:'mail2control',xhrKlass:'mail2',onHide:function(args){},onShow:function(args){},onReset:function(args){},onClick:function(args){var controlName=args.widget.getParam('cn',jQuery(args.e.target));switch(controlName)
{case'toggle':if(args.widget.controls.form[0].style.display=='none')
{args.widget.clearInputs();args.widget.controls.message[0].innerHTML='';}
args.widget.controls.form.slideToggle(args.widget.options.effectsSlideSpeed);args.e.stopPropagation();args.e.preventDefault();break;}},onAjaxSuccess:function(args){if(true==args.data.success){setTimeout(function(){args.widget.controls.form.slideToggle(args.widget.options.effectsSlideSpeed);},3000);}},onAjaxFailure:function(args){}}},'.surveyform':{eventHandlerBuilder:function(pagecontroller_instance){return{onHide:function(args){},onShow:function(args){var cookieName=args.widget.getParam('cookie');if(true==jQuery.cookie(cookieName))
{args.widget.controls.message[0].innerHTML='You took this survey earlier.';}
else
{args.widget.controls.form.show();}},onReset:function(args){},onClick:function(args){},onAjaxSuccess:function(args){if(true==args.data.success){args.widget.controls.form.hide();}},onAjaxFailure:function(args){}}},terminating_el:'.terminating',options:{show_validation_errors:true,action_url:'/index.php',controlClass:'surveycontrol',xhrKlass:'survey'}},'.guestcommentform':{eventHandlerBuilder:function(pagecontroller_instance){return{onHide:function(args){},onShow:function(args){},onReset:function(args){jQuery('.text',args.widget.element).val('');args.widget.controls.message.html('');args.widget.element.slideUp();},onClick:function(args){var controlName=args.widget.getParam('cn',jQuery(args.e.target));switch(controlName)
{case'submit':args.widget.controls.form.submit();args.e.stopPropagation();args.e.preventDefault();break;case'reset':args.widget.resetWidget();args.e.stopPropagation();args.e.preventDefault();break;}},onAjaxSuccess:function(args){if(true==args.data.success){setTimeout(function(){args.widget.resetWidget();},5000);}},onAjaxFailure:function(args){}}},terminating_el:'.terminating',options:{show_validation_errors:true,action_url:'/index.php',controlClass:'guestcommentcontrol',xhrKlass:'guestcomment'}}}}});(function($){$.widget('ui.SimpleFormWidget',{validator:null,xhr:null,initialize:function(){this.registerEventHandler(this.controls.form,'submit',this.handleSubmit.bind(this));this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.validator=new Validator(jQuery.extend({},{'scope':this.controls.form}));this.xhr=new XHR({klass:this.options.xhrKlass,beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});},handleSubmit:function(e){this.validator.hideErrors();if(this.validator.validate()){this.xhr.send(this.options.action_url,jQuery(e.target).serialize());}
else
{if(this.options.show_validation_errors){this.validator.showErrors();}}
e.preventDefault();e.stopPropagation();return false;},handleClick:function(e){this.fireEvent('onClick',{'e':e,'widget':this});},handleAjaxRequest:function(){this.disableInputs();this.controls.indicator.show();},handleAjaxSuccess:function(data){Message.showMessage(data.message,this.controls.message[0],{stable:true});this.enableInputs();this.controls.indicator.hide();this.fireEvent('onAjaxSuccess',{'data':data,'widget':this});},handleAjaxFail:function(){var message='Error occurred, please try again later.';Message.showMessage(message,this.controls.message[0]);this.controls.indicator.hide();this.enableInputs();this.fireEvent('onAjaxFailure',{'widget':this});},hideWidget:function(){this.fireEvent('onHide',{'widget':this});},showWidget:function(){this.fireEvent('onShow',{'widget':this});},resetWidget:function(){this.fireEvent('onReset',{'widget':this});},clearInputs:function(){jQuery('input:text, textarea',this.element).each(function(i,element){element.value='';});},disableInputs:function(){jQuery('input, textarea, select',this.element).each(function(i,element){element.disabled=true;});},enableInputs:function(){jQuery('input, textarea, select',this.element).each(function(i,element){element.disabled=false;});}});$.extend($.ui.SimpleFormWidget,{version:'1.0',defaults:{}});})(jQuery);(function($){$.widget('ui.StatusUpdateWidget',{initialize:function(){this.registerEventHandler(this.controls.toggle,'click',this.toggleStatusForm.bind(this));this.registerEventHandler(this.controls.cancel,'click',this.cancelUpdate.bind(this));this.registerEventHandler(this.controls.statusForm,'submit',this.submitUpdate.bind(this));this.registerEventHandler(this.controls.submit,'click',this.submitUpdate.bind(this));this.xhr=new XHR({klass:'statusupdate',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});this.subscribeForEvent('user.auth.',this.authEventHandler.bind(this));},authEventHandler:function(ev){switch(ev.name){case'user.auth.success':this.showWidget();break;}},cancelUpdate:function(e){this.toggleStatusForm(e);this.resetWidget();return false;},submitUpdate:function(e){e.preventDefault();if(this.isEnabled()){this.xhr.send(this.options.action_url,this.controls.statusForm.serialize());}
return false;},handleAjaxRequest:function(){this.disable();this.toggleIndicator();this.toggleButtons();},handleAjaxFail:function(){this.enable();this.toggleIndicator();this.toggleButtons();},handleAjaxSuccess:function(data){if(data.action=='setprofile'&&data.success==true){this.controls.originalStatus[0].innerHTML=this.controls.status[0].value;this.enable();this.toggleIndicator();this.toggleStatusForm();this.toggleButtons();}else{this.toggleIndicator();Message.showMessage(data.message,this.controls.message[0],{stable:false,onComplete:function(){this.toggleButtons();this.enable();}});}},toggleStatusForm:function(e){if(e)
{e.preventDefault();}
this.controls.toggle.toggle();this.controls.statusForm.toggle();return false;},toggleIndicator:function(){this.controls.indicator.toggle();},toggleButtons:function(){this.controls.status[0].disabled=!this.controls.status[0].disabled;this.controls.submit.toggle();this.controls.cancel.toggle();},showWidget:function(){this.element.show();},hideWidget:function(){this.element.hide();},resetWidget:function(){this.controls.status[0].value=this.controls.originalStatus[0].innerHTML;}});$.extend($.ui.StatusUpdateWidget,{version:'1.0',defaults:{action_url:'/?op=setstatusupdate'}});})(jQuery);jQuery.extend(settings.widgets,{thumbnailscroller:{klass:'ThumbnailScrollerWidget',byselector:{'.thumbnail_scroller':{eventHandlerBuilder:function(pagecontroller_instance){return{};},terminating_el:'.terminating',options:{}}}}});(function($){$.widget('ui.ThumbnailScrollerWidget',{scrollMarginTop:0,scrollLineHeight:105,scrollEffectLength:200,scrollTotalHeight:0,initialize:function(){this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.scrollTotalHeight=jQuery('#scrollWrapper')[0].offsetHeight;this.jumpToThumbnail(this.getParam('slidenum',this.element));this.scrollTo();},handleClick:function(e){switch(e.target){case this.controls.scroll_left[0]:this.thumbnailScrollUp()
break;case this.controls.scroll_right[0]:this.thumbnailScrollDown()
break;}
e.stopPropagation();},scrollTo:function(){mt=this.scrollMarginTop+'px';if(jQuery('#scrollWrapper').css('margin-top')!=mt){jQuery('#scrollWrapper').fadeOut(this.scrollEffectLength,function(){jQuery(this).css('margin-top',mt).fadeIn(this.scrollEffectLength);});}
this.scrollAtEnd=false;this.scrollAtStart=false;if((this.scrollMarginTop-(this.scrollLineHeight))<=(-1*this.scrollTotalHeight))
{this.scrollAtEnd=true;}
if(this.scrollMarginTop>=0)
{this.scrollAtStart=true;}
if(this.scrollAtEnd){this.controls.scroll_right.addClass('scrollhide');}else{this.controls.scroll_right.removeClass('scrollhide');}
if(this.scrollAtStart){this.controls.scroll_left.addClass('scrollhide');}else{this.controls.scroll_left.removeClass('scrollhide');}},thumbnailScrollDown:function(){if((this.scrollMarginTop-(2*this.scrollLineHeight))<=(-1*this.scrollTotalHeight)){this.scrollMarginTop=(-1*this.scrollTotalHeight)+this.scrollLineHeight;}else{this.scrollMarginTop=this.scrollMarginTop-this.scrollLineHeight;}
this.scrollTo();},thumbnailScrollUp:function(){if((this.scrollMarginTop+this.scrollLineHeight)>=0){this.scrollMarginTop=0;}else{this.scrollMarginTop=this.scrollMarginTop+this.scrollLineHeight;}
this.scrollTo();},jumpToThumbnail:function(imgnum)
{if(!imgnum)return false;jQuery('#scrollLine li').removeClass('hilite');jQuery('#image'+imgnum).addClass('hilite');this.scrollMarginTop=(-1*(jQuery('#image'+imgnum)[0].offsetTop));}});$.extend($.ui.ThumbnailScrollerWidget,{version:'1.0',defaults:{onHide:{},onShow:{},onReset:{}}});})(jQuery);(function($){$.widget('ui.UserMessageWidget',{xhr:null,initialize:function(){this.xhr=new XHR({klass:'usermessage',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});this.registerEventHandler(this.controls.form,'submit',this.handleSubmit.bind(this));this.registerEventHandler(this.element,'click',this.handleClick.bind(this));},cleanMarkup:function(text){text=text.replace(/<a.*javascript:.*?>/ig,'');text=text.replace(/<a.*class=.*?>/ig,'');text=text.replace(/<a.*style=.*?>/ig,'');text=text.replace(/<a.*on\w+=.*?>/ig,'');text=text.replace(/<i.*class=.*?>/ig,'');text=text.replace(/<i.*style=.*?>/ig,'');text=text.replace(/<i.*on\w+=.*?>/ig,'');text=text.replace(/<b.*class=.*?>/ig,'');text=text.replace(/<b.*style=.*?>/ig,'');text=text.replace(/<b.*on\w+=.*?>/ig,'');text=text.replace(/<img.*?>/g,'');text=text.replace(/<(?!a.*?|\/a|b|\/b|i|\/i).*?>/ig,'');text=text.replace(/<iframe.*?/ig,'');text=text.replace(/<embed.*?/ig,'');text=this.autoLink(text);text=this.createParagraphs(text);text=this.cleanQuotes(text);var div=document.createElement('div');div.innerHTML=text;return div.innerHTML;},autoLink:function(text){text=' '+text;text=text.replace(/([^"=])(https?\:\/\/)([^,'"\s\<\>\)\]\!\/]*)((\/)(([^,'"\s\<\>\)\]\!]|[,])*))?/igm,'$1<a href="$2$3$4">[$3]</a>');text=text.substring(1,text.length);var re=new RegExp(/href.+>(.*?)<\/a>/g);var amatches=re.exec(text);if(amatches){for(i=1;i<amatches.length;i+=2){var href=amatches[i];if(href.length>60){var nhref=href.substr(0,59);var index=text.indexOf(href);var stext=text.substr(0,index);var etext=text.substr(index+href.length,text.length);text=stext+nhref+"...</a>"+etext;}}}
return text;},createParagraphs:function(text){var pars=text.split(/\r?\n\r?\n/);var newtext='';for(i=0;i<pars.length;i++){pars[i]=pars[i].replace(/^\s+|\s+$/g,'');pars[i]=pars[i].replace(/\r?\n/g,'<br />\n');if(pars[i].length>0)newtext+='<p>'+pars[i]+'</p>'+(i+1<pars.length?'\n':'');}
return newtext;},cleanQuotes:function(text){var chars=text.split("");var newtext='';for(i=0;i<chars.length;i++){var chr=chars[i].charCodeAt(0);switch(chr){case 8216:newtext+="'";break;case 8217:newtext+="'";break;case 8220:newtext+='"';break;case 8221:newtext+='"';break;case 8211:newtext+="-";break;case 8212:newtext+="-";break;default:newtext+=chars[i];}}
return newtext;},handleSubmit:function(e){Logger.debugLog('UserMessageWidget handleSubmit');if(this.controls.form[0].elements.messageText.value!=''){var tmp=this.controls.form[0].elements.messageText.value;var tmp_cleaned=this.cleanMarkup(tmp);this.controls.form[0].elements.messageText.value=tmp_cleaned;var params=this.controls.form.serialize();this.controls.form[0].elements.messageText.value=tmp;if(this.controls.form[0].elements.public_message.checked==true){params+='&status=PUBLIC';}
else
{params+='&status=PRIVATE';}
this.xhr.send(this.options.action_url,params);this.toggleIndicator();this.disableInputs();}
e.preventDefault();e.stopPropagation();return false;},handleClick:function(e){Logger.debugLog('UserMessageWidget handleClick');controlName=this.getParam('cn',e.target);switch(controlName){case'delete':var parameters=['op=changemessagestatus','publishStatus=DELETED','id='+this.getParam('mId',e.target)];if(window.confirm('Are you sure?')){this.xhr.send(this.options.action_url,parameters.join('&'));}
e.preventDefault();e.stopPropagation();return false;break;case'reveal':messageId=this.getParam('mId',e.target);originalMessageId=this.getParam('omId',e.target);if(jQuery('#userMessage'+originalMessageId).length>0)
{return true;}
else
{jQuery('#originalMessage'+messageId+'_'+originalMessageId).slideToggle(this.options.effectsSlideSpeed);}
e.preventDefault();e.stopPropagation();return false;break;case'reply':messageId=this.getParam('mId',e.target);sentToId=this.getParam('aId',e.target);if(messageId!=this.controls.attachedObjId[0].value)
{jQuery('#commentBox').slideUp(this.options.effectsSlideSpeed,function(){this.controls.sentToId[0].value=sentToId;this.controls.attachedObjId[0].value=messageId;this.controls.messageText[0].value='';jQuery('#commentBox').insertAfter('#userMessage'+messageId).slideDown(this.options.effectsSlideSpeed,function(){this.controls.messageText[0].focus();}.bind(this));}.bind(this));}
e.preventDefault();e.stopPropagation();return false;break;}},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){this.enableInputs();switch(data.action){case'postmessage':this.toggleIndicator();if(data.success==true){jQuery(jQuery('#messageList').prepend(data.content).children()[0]).attr('style','display: none').slideDown(this.options.effectsSlideSpeed);this.controls.form[0].elements.messageText.value='';Message.showMessage(data.message,this.controls.message[0]);}
else
{Message.showMessage(data.message,this.controls.message[0],{stable:true});}
break;case'changemessagestatus':if(data.success==true){jQuery('#userMessage'+data.messageId).slideUp(this.options.effectsSlideSpeed);if(this.controls.attachedObjId[0].value==data.messageId)
{jQuery('#commentBox').slideUp(this.options.effectsSlideSpeed,function(){this.controls.sentToId[0].value='';this.controls.attachedObjId[0].value='';this.controls.messageText[0].value='';jQuery('#commentBox').prependTo('#userMessage').slideDown(this.options.effectsSlideSpeed,function(){this.controls.messageText[0].focus();}.bind(this));}.bind(this));}}
else
{Message.showMessage(data.message,jQuery('div#userMessage'+data.messageId+' div.userMessageMessage')[0]);}
break;}},handleAjaxFail:function(){},inputBlur:function(e){if(e.target.value==''){jQuery(e.target).addClass('themEmail');}},inputFocus:function(e){jQuery(e.target).removeClass('themEmail');},disableInputs:function(){this.disable();jQuery('input, button, textarea',this.controls.form).each(function(i,element){element.disabled=true;});},enableInputs:function(){this.enable();jQuery('input, button, textarea',this.controls.form).each(function(i,element){element.disabled=false;});},showWidget:function(){this.element.show();this.resetWidget();},toggleForm:function(e){if(e!=undefined){e.stopPropagation();}
this.controls.formcontainer.slideToggle();return false;},resetWidget:function(){this.controls.form[0].reset();}});$.extend($.ui.UserMessageWidget,{version:'1.0',defaults:{controlClass:'messageControl',action_url:'/index.php'}});})(jQuery);(function($){$.widget('ui.WarningCountWidget',{xhr:null,initialize:function(){this.registerEventHandler(this.element,'click',this.handleClick.bind(this));this.xhr=new XHR({klass:'warningcount',beforeSend:this.handleAjaxRequest.bind(this),error:this.handleAjaxFail.bind(this),success:this.handleAjaxSuccess.bind(this)});},handleClick:function(e){var controlName=this.getParam('cn',jQuery(e.target));switch(controlName){case'decrease':case'increase':var comment=prompt('Add some comment please');if(null!=comment)
{var userId=this.getParam('uId',jQuery(e.target));var params={'op':'changewarningcount','userId':userId,'direction':(jQuery(e.target).hasClass('cn_decrease')?-1:1),'comment':comment};this.xhr.send(this.options.action_url,params);jQuery('#action_indicator_'+userId).show();}
e.stopPropagation();e.preventDefault();break;case'history_toggle':var userId=this.getParam('uId',jQuery(e.target));var history_container=jQuery('#warning_history_container_'+userId)[0];if(history_container.style.display=='none'){history_container.style.display='';this.loadHistory(userId);}
else
{history_container.style.display='none';}
e.stopPropagation();e.preventDefault();break;}},handleAjaxRequest:function(){},handleAjaxSuccess:function(data){jQuery('#action_indicator_'+data.userId).hide();jQuery('.cn_history_toggle').filter('.uId_'+data.userId)[0].innerHTML=data.warnCount;this.loadHistory(data.userId);},handleAjaxFail:function(){jQuery('#action_indicator_'+data.userId).hide();},loadHistory:function(userId){var params={'op':'userlist_warning_history','userId':userId};jQuery('#warning_history_openable_indicator_'+userId).show();jQuery('#warning_history_'+userId).hide();jQuery('#warning_history_'+userId).load(this.options.action_url,params,function(){jQuery('#warning_history_openable_indicator_'+userId).hide();jQuery('#warning_history_'+userId).show();});},hideWidget:function(){},showWidget:function(){},resetWidget:function(){}});$.extend($.ui.WarningCountWidget,{'version':'1.0','defaults':{'action_url':'/index.php','controlClass':'warningcount_control'}});})(jQuery);Cc8b={changeLink:function(cipher)
{var key=cipher.substr(0,cipher.indexOf('.'));var link=cipher.substr(cipher.indexOf('.')+1);var email=link.substr(0,link.indexOf('.'));var text=link.substr(link.indexOf('.')+1);var decoded_text=Cc8b.decipher(text,key);var decoded_link=Cc8b.decipher(email,key);return decoded_text.link("mailto:"+decoded_link);},decipher:function(cipherText,key)
{var plainText=new String("");var temp;key=parseInt(key,10);for(var i=0;i<=cipherText.length-2;i=i+2)
{temp=cipherText.substr(i,2);temp=parseInt(temp,16);temp+=0xFF;temp-=key;temp=temp%0xFF;plainText+=String.fromCharCode(temp);}
return plainText;},write:function(cipher)
{document.write(Cc8b.changeLink(cipher));}}
function changePostStatus(postId,state,realm,linkobj,needsConfirm)
{var skip=false;if(needsConfirm)
{if(!confirm('Delete post?'))
{skip=true;}}
if(!skip)
{var params=new Array;params.push('op=changepoststatus');params.push('id='+postId);params.push('publishStatus='+state);params.push('realm='+realm);new Ajax.Updater('postStatusResponse',"/index.php",{parameters:params.join('&'),evalScripts:true});}}
function switchView(viewtype)
{if(viewtype!='classic')
{viewtype='condensed';}
jQuery.cookie('postlistView',viewtype,{expires:730,path:'/'});location.reload();}
if(jQuery.cookie('ganjaPostlistView')==null)
{jQuery.cookie('ganjaPostlistView',false,{expires:730,path:'/'});}
function expandTopStories(){jQuery('#splashPosts .hide').show();jQuery('#ad-300x250').hide();jQuery("#topMenu").animate({width:"1000px"},500);jQuery("#contentSwitch").animate({width:"650px"},500);return 0;}
function collapseSkyscraper(){jQuery('#skyscraper')[0].style.display='none';jQuery('#skySpacer')[0].style.marginTop='-1em';jQuery('#skySpacer')[0].style.height='1em';jQuery('#siteInfo')[0].style.marginTop='10px';return 0;}
var lastopened=false;var menuout;var tmenuout;var menuin;function initMenu()
{jQuery('.menu li').each(function(i,menuitem){menuitem.onmouseover=function(){jQuery('.menu li.toplevelmenu').each(function(i,cmi){if(menuitem!=cmi&&jQuery(menuitem).descendantOf(cmi).length==0)
{jQuery('ul',cmi).each(function(i,si){si.style.display='none';});jQuery(cmi).removeClass('selected');}});jQuery(menuitem).addClass('selected');jQuery('ul',menuitem).each(function(i,mitem){var mfunc=function(){mitem.style.display='block';}
clearTimeout(menuout);clearTimeout(tmenuout);menuin=setTimeout(mfunc,200);lastopened=mitem;});}
menuitem.onmouseout=function(){if(jQuery(menuitem).hasClass('toplevelmenu'))
{var munselect=function(){jQuery(menuitem).removeClass('selected');}
tmenuout=setTimeout(munselect,200);}
else
{jQuery(menuitem).removeClass('selected');}
jQuery('ul',menuitem).each(function(i,mitem){var mfuncout=function(){mitem.style.display='none';}
if(jQuery(mitem).descendantOf(lastopened).length==0)
{clearTimeout(menuin);menuout=setTimeout(mfuncout,200);}});}});}
function checkHashForErrors()
{var messageContainer='errorbar';var message;if(document.location.hash=='#ERR404'){message='You were redirected to our front page because the URL you requested is unavailable. Please try again later.';}
else if(document.location.hash=='#ERR500'){message='You were redirected to our front page because the URL you requested is unavailable. Please try again later.';}
else if(document.location.hash=='#passworderror'){message='Password change failed. Check your username and password and resubmit.';}
else if(document.location.hash=='#emailerror'){message='Email already used. Please type another one.';}
else if(document.location.hash=='#authrequired'){message='Authorization required. Please login first.';}
else if(document.location.hash=='#profilesuccess'){messageContainer='infobar';message='Profile successfully updated.';}
if(message){var messageContainerElement=document.getElementById(messageContainer);messageContainerElement.innerHTML=message;messageContainerElement.style.display='block';setTimeout('document.getElementById(\''+messageContainer+'\').style.display = \'none\';',30000);}}
function setVote(pollid,answerid)
{var req=jQuery.post('/index.php',{op:'polldaddyvote',pollid:pollid,answerid:answerid});}
function gawkerGallery(postId,numImages,title){}
var css_browser_selector=function(){var ua=navigator.userAgent.toLowerCase(),is=function(t){return ua.indexOf(t)!=-1;},h=document.getElementsByTagName('html')[0],b=(!(/opera|webtv/i.test(ua))&&/msie (\d)/.test(ua))?('ie ie'+RegExp.$1):is('firefox/2')?'gecko ff2':is('firefox/3')?'gecko ff3':is('gecko/')?'gecko':is('opera/9')?'opera opera9':/opera (\d)/.test(ua)?'opera opera'+RegExp.$1:is('konqueror')?'konqueror':is('applewebkit/')?'webkit safari':is('mozilla/')?'gecko':'',os=(is('x11')||is('linux'))?' linux':is('mac')?' mac':is('win')?' win':'';var c=b+os+' js';h.className+=h.className?' '+c:c;}();Array.prototype.removeDuplicates=function(){for(var i=1;i<this.length;i++){if(this[i][0]==this[i-1][0]){this.splice(i,1);}}}
Array.prototype.empty=function(){for(var i=0;i<=this.length;i++){this.shift();}}
String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');}
function LyteBox(){this.theme='grey';this.hideFlash=true;this.outerBorder=true;this.resizeSpeed=8;this.maxOpacity=80;this.navType=1;this.autoResize=false;this.doAnimations=true;this.borderSize=12;this.slideInterval=10000;this.showNavigation=true;this.showClose=true;this.showDetails=true;this.showPlayPause=true;this.autoEnd=true;this.pauseOnNextClick=false;this.pauseOnPrevClick=true;this.thumb800Transform='804x_';this.thumb1024Transform='';if(this.resizeSpeed>10){this.resizeSpeed=10;}
if(this.resizeSpeed<1){resizeSpeed=1;}
this.resizeDuration=(11-this.resizeSpeed)*0.15;this.resizeWTimerArray=new Array();this.resizeWTimerCount=0;this.resizeHTimerArray=new Array();this.resizeHTimerCount=0;this.showContentTimerArray=new Array();this.showContentTimerCount=0;this.overlayTimerArray=new Array();this.overlayTimerCount=0;this.imageTimerArray=new Array();this.imageTimerCount=0;this.timerIDArray=new Array();this.timerIDCount=0;this.slideshowIDArray=new Array();this.slideshowIDCount=0;this.imageArray=new Array();this.activeImage=null;this.slideArray=new Array();this.activeSlide=null;this.frameArray=new Array();this.activeFrame=null;this.checkFrame();this.isSlideshow=false;this.isLyteframe=false;this.LyteImageSize=0;this.ie=false;this.ie7=(this.ie&&window.XMLHttpRequest);this.initialize();}
LyteBox.prototype.initialize=function(){this.updateLyteboxItems();var objBody=this.doc.getElementsByTagName("body").item(0);if(this.doc.getElementById('lbOverlay')){objBody.removeChild(this.doc.getElementById("lbOverlay"));objBody.removeChild(this.doc.getElementById("lbMain"));}
var objOverlay=this.doc.createElement("div");objOverlay.setAttribute('id','lbOverlay');objOverlay.setAttribute((this.ie?'className':'class'),this.theme);if((this.ie&&!this.ie7)||(this.ie7&&this.doc.compatMode=='BackCompat')){objOverlay.style.position='absolute';}
objOverlay.style.display='none';objBody.appendChild(objOverlay);var objLytebox=this.doc.createElement("div");objLytebox.setAttribute('id','lbMain');objLytebox.style.display='none';objBody.appendChild(objLytebox);var objOuterContainer=this.doc.createElement("div");objOuterContainer.setAttribute('id','lbOuterContainer');objOuterContainer.setAttribute((this.ie?'className':'class'),this.theme);objLytebox.appendChild(objOuterContainer);var objIframeContainer=this.doc.createElement("div");objIframeContainer.setAttribute('id','lbIframeContainer');objIframeContainer.style.display='none';objOuterContainer.appendChild(objIframeContainer);var objIframe=this.doc.createElement("iframe");objIframe.setAttribute('id','lbIframe');objIframe.setAttribute('name','lbIframe');objIframe.style.display='none';objIframeContainer.appendChild(objIframe);var objImageContainer=this.doc.createElement("div");objImageContainer.setAttribute('id','lbImageContainer');objOuterContainer.appendChild(objImageContainer);var objLyteboxImage=this.doc.createElement("img");objLyteboxImage.setAttribute('id','lbImage');objImageContainer.appendChild(objLyteboxImage);var objLoading=this.doc.createElement("div");objLoading.setAttribute('id','lbLoading');objOuterContainer.appendChild(objLoading);var objDetailsContainer=this.doc.createElement("div");objDetailsContainer.setAttribute('id','lbDetailsContainer');objDetailsContainer.setAttribute((this.ie?'className':'class'),this.theme);objLytebox.appendChild(objDetailsContainer);var objDetailsData=this.doc.createElement("div");objDetailsData.setAttribute('id','lbDetailsData');objDetailsData.setAttribute((this.ie?'className':'class'),this.theme);objDetailsContainer.appendChild(objDetailsData);var objDetails=this.doc.createElement("div");objDetails.setAttribute('id','lbDetails');objDetailsData.appendChild(objDetails);var objCaption=this.doc.createElement("span");objCaption.setAttribute('id','lbCaption');objDetails.appendChild(objCaption);var objHoverNav=this.doc.createElement("div");objHoverNav.setAttribute('id','lbHoverNav');objImageContainer.appendChild(objHoverNav);var objBottomNav=this.doc.createElement("div");objBottomNav.setAttribute('id','lbBottomNav');objDetailsData.appendChild(objBottomNav);var objPrev=this.doc.createElement("a");objPrev.setAttribute('id','lbPrev');objPrev.setAttribute((this.ie?'className':'class'),this.theme);objPrev.setAttribute('href','#');objHoverNav.appendChild(objPrev);var objNext=this.doc.createElement("a");objNext.setAttribute('id','lbNext');objNext.setAttribute((this.ie?'className':'class'),this.theme);objNext.setAttribute('href','#');objHoverNav.appendChild(objNext);var objNumberDisplay=this.doc.createElement("span");objNumberDisplay.setAttribute('id','lbNumberDisplay');objDetails.appendChild(objNumberDisplay);var objNavDisplay=this.doc.createElement("span");objNavDisplay.setAttribute('id','lbNavDisplay');objNavDisplay.style.display='none';objDetails.appendChild(objNavDisplay);var objClose=this.doc.createElement("a");objClose.setAttribute('id','lbClose');objClose.setAttribute((this.ie?'className':'class'),this.theme);objClose.setAttribute('href','#');objBottomNav.appendChild(objClose);var objPause=this.doc.createElement("a");objPause.setAttribute('id','lbPause');objPause.setAttribute((this.ie?'className':'class'),this.theme);objPause.setAttribute('href','#');objPause.style.display='none';objBottomNav.appendChild(objPause);var objPlay=this.doc.createElement("a");objPlay.setAttribute('id','lbPlay');objPlay.setAttribute((this.ie?'className':'class'),this.theme);objPlay.setAttribute('href','#');objPlay.style.display='none';objBottomNav.appendChild(objPlay);};LyteBox.prototype.updateLyteboxItems=function(){var anchors=(this.isFrame)?window.parent.frames[window.name].document.getElementsByTagName('a'):document.getElementsByTagName('a');for(var i=0;i<anchors.length;i++){var anchor=anchors[i];var relAttribute=String(anchor.getAttribute('rel'));if(anchor.getAttribute('href')){if(relAttribute.toLowerCase().match('lytebox')){anchor.onclick=function(){myLytebox.start(this,false,false);return false;}}else if(relAttribute.toLowerCase().match('lyteshow')){anchor.onclick=function(){myLytebox.start(this,true,false);return false;}}else if(relAttribute.toLowerCase().match('lyteframe')){anchor.onclick=function(){myLytebox.start(this,false,true);return false;}}}}};LyteBox.prototype.start=function(imageLink,doSlide,doFrame){if(this.ie&&!this.ie7){this.toggleSelects('hide');}
if(this.hideFlash){this.toggleFlash('hide');}
this.isLyteframe=(doFrame?true:false);var pageSize=this.getPageSize();var objOverlay=this.doc.getElementById('lbOverlay');var objBody=this.doc.getElementsByTagName("body").item(0);objOverlay.style.height=pageSize[1]+"px";objOverlay.style.display='';this.appear('lbOverlay',(this.doAnimations?0:this.maxOpacity));var anchors=(this.isFrame)?window.parent.frames[window.name].document.getElementsByTagName('a'):document.getElementsByTagName('a');if(this.isLyteframe){this.frameArray=[];this.frameNum=0;if((imageLink.getAttribute('rel')=='lyteframe')){var rev=imageLink.getAttribute('rev');this.frameArray.push(new Array(imageLink.getAttribute('href'),imageLink.getAttribute('title'),(rev==null||rev==''?'width: 400px; height: 400px; scrolling: auto;':rev)));}else{if(imageLink.getAttribute('rel').indexOf('lyteframe')!=-1){for(var i=0;i<anchors.length;i++){var anchor=anchors[i];if(anchor.getAttribute('href')&&(anchor.getAttribute('rel')==imageLink.getAttribute('rel'))){var rev=anchor.getAttribute('rev');this.frameArray.push(new Array(anchor.getAttribute('href'),anchor.getAttribute('title'),(rev==null||rev==''?'width: 400px; height: 400px; scrolling: auto;':rev)));}}
this.frameArray.removeDuplicates();while(this.frameArray[this.frameNum][0]!=imageLink.getAttribute('href')){this.frameNum++;}}}}else{this.imageArray=[];this.imageNum=0;this.slideArray=[];this.slideNum=0;if((imageLink.getAttribute('rel')=='lytebox')){this.imageArray.push(new Array(imageLink.getAttribute('href'),imageLink.getAttribute('title')));}else{if(imageLink.getAttribute('rel').indexOf('lytebox')!=-1){for(var i=0;i<anchors.length;i++){var anchor=anchors[i];var imgOriginalWidth=0;if(anchor.getAttribute('href')&&(anchor.getAttribute('rel')==imageLink.getAttribute('rel'))){try
{var imgclasses=anchor.getAttribute('class').split(" ");for(var k=0;k<imgclasses.length;k++)
{if(imgclasses[k].indexOf('imagewidth_')!=-1)
{imgOriginalWidth=imgclasses[k].substr(11);}}}
catch(e){}
this.imageArray.push(new Array(anchor.getAttribute('href'),anchor.getAttribute('title'),imgOriginalWidth));}}
this.imageArray.removeDuplicates();while(this.imageArray[this.imageNum][0]!=imageLink.getAttribute('href')){this.imageNum++;}}
if(imageLink.getAttribute('rel').indexOf('lyteshow')!=-1){for(var i=0;i<anchors.length;i++){var anchor=anchors[i];var imgOriginalWidth=0;if(anchor.getAttribute('href')&&(anchor.getAttribute('rel')==imageLink.getAttribute('rel'))){try
{var imgclasses=anchor.getAttribute('class').split(" ");for(var k=0;k<imgclasses.length;k++)
{if(imgclasses[k].indexOf('imagewidth_')!=-1)
{imgOriginalWidth=imgclasses[k].substr(11);}}}
catch(e){}
this.slideArray.push(new Array(anchor.getAttribute('href'),anchor.getAttribute('title'),imgOriginalWidth));}}
this.slideArray.removeDuplicates();while(this.slideArray[this.slideNum][0]!=imageLink.getAttribute('href')){this.slideNum++;}}}}
var object=this.doc.getElementById('lbMain');object.style.top=(this.getPageScroll()+(pageSize[3]/15))+"px";object.style.display='';if(!this.outerBorder){this.doc.getElementById('lbOuterContainer').style.border='none';this.doc.getElementById('lbDetailsContainer').style.border='none';}else{this.doc.getElementById('lbOuterContainer').style.borderBottom='';this.doc.getElementById('lbOuterContainer').setAttribute((this.ie?'className':'class'),this.theme);}
this.doc.getElementById('lbOverlay').onclick=function(){myLytebox.end();return false;}
this.doc.getElementById('lbMain').onclick=function(e){var e=e;if(!e){if(window.parent.frames[window.name]&&(parent.document.getElementsByTagName('frameset').length<=0)){e=window.parent.window.event;}else{e=window.event;}}
var id=(e.target?e.target.id:e.srcElement.id);if(id=='lbMain'){myLytebox.end();return false;}}
this.doc.getElementById('lbClose').onclick=function(){myLytebox.end();return false;}
this.doc.getElementById('lbPause').onclick=function(){myLytebox.togglePlayPause("lbPause","lbPlay");return false;}
this.doc.getElementById('lbPlay').onclick=function(){myLytebox.togglePlayPause("lbPlay","lbPause");return false;}
this.isSlideshow=doSlide;this.isPaused=(this.slideNum!=0?true:false);if(this.isSlideshow&&this.showPlayPause&&this.isPaused){this.doc.getElementById('lbPlay').style.display='';this.doc.getElementById('lbPause').style.display='none';}
if(this.isLyteframe){this.changeContent(this.frameNum);}else{if(this.isSlideshow){this.changeContent(this.slideNum);}else{this.changeContent(this.imageNum);}}};LyteBox.prototype.changeContent=function(imageNum){if(this.isSlideshow){for(var i=0;i<this.slideshowIDCount;i++){window.clearTimeout(this.slideshowIDArray[i]);}}
this.activeImage=this.activeSlide=this.activeFrame=imageNum;if(!this.outerBorder){this.doc.getElementById('lbOuterContainer').style.border='none';this.doc.getElementById('lbDetailsContainer').style.border='none';}else{this.doc.getElementById('lbOuterContainer').style.borderBottom='';this.doc.getElementById('lbOuterContainer').setAttribute((this.ie?'className':'class'),this.theme);}
this.doc.getElementById('lbLoading').style.display='';this.doc.getElementById('lbImage').style.display='none';this.doc.getElementById('lbIframe').style.display='none';this.doc.getElementById('lbPrev').style.display='none';this.doc.getElementById('lbNext').style.display='none';this.doc.getElementById('lbIframeContainer').style.display='none';this.doc.getElementById('lbDetailsContainer').style.display='none';this.doc.getElementById('lbNumberDisplay').style.display='none';if(this.navType==2||this.isLyteframe){object=this.doc.getElementById('lbNavDisplay');object.innerHTML='&nbsp;&nbsp;&nbsp;<span id="lbPrev2_Off" style="display: none;" class="'+this.theme+'">&laquo; prev</span><a href="#" id="lbPrev2" class="'+this.theme+'" style="display: none;">&laquo; prev</a> <b id="lbSpacer" class="'+this.theme+'">||</b> <span id="lbNext2_Off" style="display: none;" class="'+this.theme+'">next &raquo;</span><a href="#" id="lbNext2" class="'+this.theme+'" style="display: none;">next &raquo;</a>';object.style.display='none';}
if(this.isLyteframe){var iframe=myLytebox.doc.getElementById('lbIframe');var styles=this.frameArray[this.activeFrame][2];var aStyles=styles.split(';');for(var i=0;i<aStyles.length;i++){if(aStyles[i].indexOf('width:')>=0){var w=aStyles[i].replace('width:','');iframe.width=w.trim();}else if(aStyles[i].indexOf('height:')>=0){var h=aStyles[i].replace('height:','');iframe.height=h.trim();}else if(aStyles[i].indexOf('scrolling:')>=0){var s=aStyles[i].replace('scrolling:','');iframe.scrolling=s.trim();}else if(aStyles[i].indexOf('border:')>=0){}}
this.resizeContainer(parseInt(iframe.width),parseInt(iframe.height));}else{var imgUrl=(myLytebox.isSlideshow?myLytebox.slideArray[myLytebox.activeSlide][0]:myLytebox.imageArray[myLytebox.activeImage][0]);var imgOriginalWidth=(myLytebox.isSlideshow?myLytebox.slideArray[myLytebox.activeSlide][2]:myLytebox.imageArray[myLytebox.activeImage][2]);if(myLytebox.LyteImageSize==1024)
{if(imgOriginalWidth>1024)
{imgUrl=imgUrl.replace('504x_',myLytebox.thumb1024Transform);}
else
{imgUrl=imgUrl.replace('504x_',myLytebox.thumb1024Transform);}}
if(myLytebox.LyteImageSize==800)
{if(imgOriginalWidth>800)
{imgUrl=imgUrl.replace('504x_',myLytebox.thumb800Transform);}}
imgPreloader=new Image();imgPreloader.onload=function(){var imageWidth=imgPreloader.width;var imageHeight=imgPreloader.height;if(myLytebox.autoResize){var pagesize=myLytebox.getPageSize();var x=pagesize[2]-150;var y=pagesize[3]-150;if(imageWidth>x){imageHeight=Math.round(imageHeight*(x/imageWidth));imageWidth=x;if(imageHeight>y){imageWidth=Math.round(imageWidth*(y/imageHeight));imageHeight=y;}}else if(imageHeight>y){imageWidth=Math.round(imageWidth*(y/imageHeight));imageHeight=y;if(imageWidth>x){imageHeight=Math.round(imageHeight*(x/imageWidth));imageWidth=x;}}}
var lbImage=myLytebox.doc.getElementById('lbImage')
lbImage.src=imgUrl;lbImage.width=imageWidth;lbImage.height=imageHeight;myLytebox.resizeContainer(imageWidth,imageHeight);imgPreloader.onload=function(){};}
imgPreloader.src=imgUrl;}};LyteBox.prototype.resizeContainer=function(imgWidth,imgHeight){this.wCur=this.doc.getElementById('lbOuterContainer').offsetWidth;this.hCur=this.doc.getElementById('lbOuterContainer').offsetHeight;this.xScale=((imgWidth+(this.borderSize*2))/this.wCur)*100;this.yScale=((imgHeight+(this.borderSize*2))/this.hCur)*100;var wDiff=(this.wCur-this.borderSize*2)-imgWidth;var hDiff=(this.hCur-this.borderSize*2)-imgHeight;if(!(hDiff==0)){this.hDone=false;this.resizeH('lbOuterContainer',this.hCur,imgHeight+this.borderSize*2,this.getPixelRate(this.hCur,imgHeight));}else{this.hDone=true;}
if(!(wDiff==0)){this.wDone=false;this.resizeW('lbOuterContainer',this.wCur,imgWidth+this.borderSize*2,this.getPixelRate(this.wCur,imgWidth));}else{this.wDone=true;}
if((hDiff==0)&&(wDiff==0)){if(this.ie){this.pause(250);}else{this.pause(100);}}
this.doc.getElementById('lbPrev').style.height=imgHeight+"px";this.doc.getElementById('lbNext').style.height=imgHeight+"px";this.doc.getElementById('lbDetailsContainer').style.width=(imgWidth+(this.borderSize*2)+(this.ie&&this.doc.compatMode=="BackCompat"&&this.outerBorder?2:0))+"px";this.showContent();};LyteBox.prototype.showContent=function(){if(this.wDone&&this.hDone){for(var i=0;i<this.showContentTimerCount;i++){window.clearTimeout(this.showContentTimerArray[i]);}
if(this.outerBorder){this.doc.getElementById('lbOuterContainer').style.borderBottom='none';}
this.doc.getElementById('lbLoading').style.display='none';if(this.isLyteframe){this.doc.getElementById('lbIframe').style.display='';this.appear('lbIframe',(this.doAnimations?0:100));}else{this.doc.getElementById('lbImage').style.display='';this.appear('lbImage',(this.doAnimations?0:100));this.preloadNeighborImages();}
if(this.isSlideshow){if(this.activeSlide==(this.slideArray.length-1)){if(this.autoEnd){this.slideshowIDArray[this.slideshowIDCount++]=setTimeout("myLytebox.end('slideshow')",this.slideInterval);}}else{if(!this.isPaused){this.slideshowIDArray[this.slideshowIDCount++]=setTimeout("myLytebox.changeContent("+(this.activeSlide+1)+")",this.slideInterval);}}
this.doc.getElementById('lbHoverNav').style.display=(this.showNavigation&&this.navType==1?'':'none');this.doc.getElementById('lbClose').style.display=(this.showClose?'':'none');this.doc.getElementById('lbDetails').style.display=(this.showDetails?'':'none');this.doc.getElementById('lbPause').style.display=(this.showPlayPause&&!this.isPaused?'':'none');this.doc.getElementById('lbPlay').style.display=(this.showPlayPause&&!this.isPaused?'none':'');this.doc.getElementById('lbNavDisplay').style.display=(this.showNavigation&&this.navType==2?'':'none');}else{this.doc.getElementById('lbHoverNav').style.display=(this.navType==1&&!this.isLyteframe?'':'none');if((this.navType==2&&!this.isLyteframe&&this.imageArray.length>1)||(this.frameArray.length>1&&this.isLyteframe)){this.doc.getElementById('lbNavDisplay').style.display='';}else{this.doc.getElementById('lbNavDisplay').style.display='none';}
this.doc.getElementById('lbClose').style.display='';this.doc.getElementById('lbDetails').style.display='';this.doc.getElementById('lbPause').style.display='none';this.doc.getElementById('lbPlay').style.display='none';}
this.doc.getElementById('lbImageContainer').style.display=(this.isLyteframe?'none':'');this.doc.getElementById('lbIframeContainer').style.display=(this.isLyteframe?'':'none');try{this.doc.getElementById('lbIframe').src=this.frameArray[this.activeFrame][0];}catch(e){}}else{this.showContentTimerArray[this.showContentTimerCount++]=setTimeout("myLytebox.showContent()",200);}};LyteBox.prototype.updateDetails=function(){var object=this.doc.getElementById('lbCaption');var sTitle=(this.isSlideshow?this.slideArray[this.activeSlide][1]:(this.isLyteframe?this.frameArray[this.activeFrame][1]:this.imageArray[this.activeImage][1]));var imgOriginalWidth=(this.isSlideshow?this.slideArray[this.activeSlide][2]:(this.isLyteframe?this.frameArray[this.activeFrame][2]:this.imageArray[this.activeImage][2]));object.style.display='';object.innerHTML=(sTitle==null?'':sTitle);if(imgOriginalWidth>=800)
{object.innerHTML+='<br />';object.innerHTML+='<span class="nobold">Other sizes: ';if(myLytebox.LyteImageSize!=0)object.innerHTML+='<a id="settomedium">600px</a> ';if(imgOriginalWidth>=1024&&myLytebox.LyteImageSize!=1024)object.innerHTML+=' <a id="setto1024">'+imgOriginalWidth+'px</a>';object.innerHTML+='</span>';}
var tomedium=document.getElementById('settomedium');var to1024=document.getElementById('setto1024');this.updateNav();this.doc.getElementById('lbDetailsContainer').style.display='';object=this.doc.getElementById('lbNumberDisplay');if(this.isSlideshow&&this.slideArray.length>1){object.style.display='';object.innerHTML="Image "+eval(this.activeSlide+1)+" of "+this.slideArray.length;this.doc.getElementById('lbNavDisplay').style.display=(this.navType==2&&this.showNavigation?'':'none');if(tomedium)tomedium.onclick=function(){myLytebox.LyteImageSize=0;myLytebox.changeContent(myLytebox.activeSlide);}
if(to1024)to1024.onclick=function(){myLytebox.LyteImageSize=1024;myLytebox.changeContent(myLytebox.activeSlide);}}else if(this.imageArray.length>1&&!this.isLyteframe){object.style.display='';object.innerHTML="Image "+eval(this.activeImage+1)+" of "+this.imageArray.length;this.doc.getElementById('lbNavDisplay').style.display=(this.navType==2?'':'none');if(tomedium)tomedium.onclick=function(){myLytebox.LyteImageSize=0;myLytebox.changeContent(myLytebox.activeImage);}
if(to1024)to1024.onclick=function(){myLytebox.LyteImageSize=1024;myLytebox.changeContent(myLytebox.activeImage);}}else if(this.frameArray.length>1&&this.isLyteframe){object.style.display='';object.innerHTML="Page "+eval(this.activeFrame+1)+" of "+this.frameArray.length;this.doc.getElementById('lbNavDisplay').style.display='';if(tomedium)tomedium.onclick=function(){myLytebox.LyteImageSize=0;myLytebox.changeContent(myLytebox.activeFrame);}
if(to1024)to1024.onclick=function(){myLytebox.LyteImageSize=1024;myLytebox.changeContent(myLytebox.activeFrame);}}else{this.doc.getElementById('lbNavDisplay').style.display='none';}
this.appear('lbDetailsContainer',(this.doAnimations?0:100));};LyteBox.prototype.updateNav=function(){if(this.isSlideshow){if(this.activeSlide!=0){var object=(this.navType==2?this.doc.getElementById('lbPrev2'):this.doc.getElementById('lbPrev'));object.style.display='';object.onclick=function(){if(myLytebox.pauseOnPrevClick){myLytebox.togglePlayPause("lbPause","lbPlay");}
myLytebox.changeContent(myLytebox.activeSlide-1);return false;}}else{if(this.navType==2){this.doc.getElementById('lbPrev2_Off').style.display='';}}
if(this.activeSlide!=(this.slideArray.length-1)){var object=(this.navType==2?this.doc.getElementById('lbNext2'):this.doc.getElementById('lbNext'));object.style.display='';object.onclick=function(){if(myLytebox.pauseOnNextClick){myLytebox.togglePlayPause("lbPause","lbPlay");}
myLytebox.changeContent(myLytebox.activeSlide+1);return false;}}else{if(this.navType==2){this.doc.getElementById('lbNext2_Off').style.display='';}}}else if(this.isLyteframe){if(this.activeFrame!=0){var object=this.doc.getElementById('lbPrev2');object.style.display='';object.onclick=function(){myLytebox.changeContent(myLytebox.activeFrame-1);return false;}}else{this.doc.getElementById('lbPrev2_Off').style.display='';}
if(this.activeFrame!=(this.frameArray.length-1)){var object=this.doc.getElementById('lbNext2');object.style.display='';object.onclick=function(){myLytebox.changeContent(myLytebox.activeFrame+1);return false;}}else{this.doc.getElementById('lbNext2_Off').style.display='';}}else{if(this.activeImage!=0){var object=(this.navType==2?this.doc.getElementById('lbPrev2'):this.doc.getElementById('lbPrev'));object.style.display='';object.onclick=function(){myLytebox.changeContent(myLytebox.activeImage-1);return false;}}else{if(this.navType==2){this.doc.getElementById('lbPrev2_Off').style.display='';}}
if(this.activeImage!=(this.imageArray.length-1)){var object=(this.navType==2?this.doc.getElementById('lbNext2'):this.doc.getElementById('lbNext'));object.style.display='';object.onclick=function(){myLytebox.changeContent(myLytebox.activeImage+1);return false;}}else{if(this.navType==2){this.doc.getElementById('lbNext2_Off').style.display='';}}}
this.enableKeyboardNav();};LyteBox.prototype.enableKeyboardNav=function(){document.onkeydown=this.keyboardAction;};LyteBox.prototype.disableKeyboardNav=function(){document.onkeydown='';};LyteBox.prototype.keyboardAction=function(e){var keycode=(e==null)?event.keyCode:e.which;var key=String.fromCharCode(keycode).toLowerCase();var escape_omg=(e==null)?27:e.DOM_VK_ESCAPE;if((key=='x')||(key=='c')||(keycode==escape_omg)){myLytebox.end();}else if((key=='p')||(keycode==37)){if(myLytebox.isSlideshow){if(myLytebox.activeSlide!=0){myLytebox.disableKeyboardNav();myLytebox.changeContent(myLytebox.activeSlide-1);}}else if(myLytebox.isLyteframe){if(myLytebox.activeFrame!=0){myLytebox.disableKeyboardNav();myLytebox.changeContent(myLytebox.activeFrame-1);}}else{if(myLytebox.activeImage!=0){myLytebox.disableKeyboardNav();myLytebox.changeContent(myLytebox.activeImage-1);}}}else if((key=='n')||(keycode==39)){if(myLytebox.isSlideshow){if(myLytebox.activeSlide!=(myLytebox.slideArray.length-1)){myLytebox.disableKeyboardNav();myLytebox.changeContent(myLytebox.activeSlide+1);}}else if(myLytebox.isLyteframe){if(myLytebox.activeFrame!=(myLytebox.frameArray.length-1)){myLytebox.disableKeyboardNav();myLytebox.changeContent(myLytebox.activeFrame+1);}}else{if(myLytebox.activeImage!=(myLytebox.imageArray.length-1)){myLytebox.disableKeyboardNav();myLytebox.changeContent(myLytebox.activeImage+1);}}}};LyteBox.prototype.preloadNeighborImages=function(){if(this.isSlideshow){if((this.slideArray.length-1)>this.activeSlide){preloadNextImage=new Image();preloadNextImage.src=this.slideArray[this.activeSlide+1][0];}
if(this.activeSlide>0){preloadPrevImage=new Image();preloadPrevImage.src=this.slideArray[this.activeSlide-1][0];}}else{if((this.imageArray.length-1)>this.activeImage){preloadNextImage=new Image();preloadNextImage.src=this.imageArray[this.activeImage+1][0];}
if(this.activeImage>0){preloadPrevImage=new Image();preloadPrevImage.src=this.imageArray[this.activeImage-1][0];}}};LyteBox.prototype.togglePlayPause=function(hideID,showID){if(this.isSlideshow&&hideID=="lbPause"){for(var i=0;i<this.slideshowIDCount;i++){window.clearTimeout(this.slideshowIDArray[i]);}}
this.doc.getElementById(hideID).style.display='none';this.doc.getElementById(showID).style.display='';if(hideID=="lbPlay"){this.isPaused=false;if(this.activeSlide==(this.slideArray.length-1)){this.end();}else{this.changeContent(this.activeSlide+1);}}else{this.isPaused=true;}};LyteBox.prototype.end=function(caller){var closeClick=(caller=='slideshow'?false:true);if(this.isSlideshow&&this.isPaused&&!closeClick){return;}
this.disableKeyboardNav();this.doc.getElementById('lbMain').style.display='none';this.fade('lbOverlay',(this.doAnimations?this.maxOpacity:0));this.toggleSelects('visible');if(this.hideFlash){this.toggleFlash('visible');}
if(this.isSlideshow){for(var i=0;i<this.slideshowIDCount;i++){window.clearTimeout(this.slideshowIDArray[i]);}}
if(this.isLyteframe){this.initialize();}};LyteBox.prototype.checkFrame=function(){if(window.parent.frames[window.name]&&(parent.document.getElementsByTagName('frameset').length<=0)){this.isFrame=true;this.lytebox="window.parent."+window.name+".myLytebox";this.doc=parent.document;}else{this.isFrame=false;this.lytebox="myLytebox";this.doc=document;}};LyteBox.prototype.getPixelRate=function(cur,img){var diff=(img>cur)?img-cur:cur-img;if(diff>=0&&diff<=100){return 10;}
if(diff>100&&diff<=200){return 15;}
if(diff>200&&diff<=300){return 20;}
if(diff>300&&diff<=400){return 25;}
if(diff>400&&diff<=500){return 30;}
if(diff>500&&diff<=600){return 35;}
if(diff>600&&diff<=700){return 40;}
if(diff>700){return 45;}};LyteBox.prototype.appear=function(id,opacity){var object=this.doc.getElementById(id).style;object.opacity=(opacity/100);object.MozOpacity=(opacity/100);object.KhtmlOpacity=(opacity/100);object.filter="alpha(opacity="+(opacity+10)+")";if(opacity==100&&(id=='lbImage'||id=='lbIframe')){try{object.removeAttribute("filter");}catch(e){}
this.updateDetails();}else if(opacity>=this.maxOpacity&&id=='lbOverlay'){for(var i=0;i<this.overlayTimerCount;i++){window.clearTimeout(this.overlayTimerArray[i]);}
return;}else if(opacity>=100&&id=='lbDetailsContainer'){try{object.removeAttribute("filter");}catch(e){}
for(var i=0;i<this.imageTimerCount;i++){window.clearTimeout(this.imageTimerArray[i]);}
this.doc.getElementById('lbOverlay').style.height=this.getPageSize()[1]+"px";}else{if(id=='lbOverlay'){this.overlayTimerArray[this.overlayTimerCount++]=setTimeout("myLytebox.appear('"+id+"', "+(opacity+20)+")",1);}else{this.imageTimerArray[this.imageTimerCount++]=setTimeout("myLytebox.appear('"+id+"', "+(opacity+10)+")",1);}}};LyteBox.prototype.fade=function(id,opacity){var object=this.doc.getElementById(id).style;object.opacity=(opacity/100);object.MozOpacity=(opacity/100);object.KhtmlOpacity=(opacity/100);object.filter="alpha(opacity="+opacity+")";if(opacity<=0){try{object.display='none';}catch(err){}}else if(id=='lbOverlay'){this.overlayTimerArray[this.overlayTimerCount++]=setTimeout("myLytebox.fade('"+id+"', "+(opacity-20)+")",1);}else{this.timerIDArray[this.timerIDCount++]=setTimeout("myLytebox.fade('"+id+"', "+(opacity-10)+")",1);}};LyteBox.prototype.resizeW=function(id,curW,maxW,pixelrate,speed){if(!this.hDone){this.resizeWTimerArray[this.resizeWTimerCount++]=setTimeout("myLytebox.resizeW('"+id+"', "+curW+", "+maxW+", "+pixelrate+")",100);return;}
var object=this.doc.getElementById(id);var timer=speed?speed:(this.resizeDuration/2);var newW=(this.doAnimations?curW:maxW);object.style.width=(newW)+"px";if(newW<maxW){newW+=(newW+pixelrate>=maxW)?(maxW-newW):pixelrate;}else if(newW>maxW){newW-=(newW-pixelrate<=maxW)?(newW-maxW):pixelrate;}
this.resizeWTimerArray[this.resizeWTimerCount++]=setTimeout("myLytebox.resizeW('"+id+"', "+newW+", "+maxW+", "+pixelrate+", "+(timer+0.02)+")",timer+0.02);if(parseInt(object.style.width)==maxW){this.wDone=true;for(var i=0;i<this.resizeWTimerCount;i++){window.clearTimeout(this.resizeWTimerArray[i]);}}};LyteBox.prototype.resizeH=function(id,curH,maxH,pixelrate,speed){var timer=speed?speed:(this.resizeDuration/2);var object=this.doc.getElementById(id);var newH=(this.doAnimations?curH:maxH);object.style.height=(newH)+"px";if(newH<maxH){newH+=(newH+pixelrate>=maxH)?(maxH-newH):pixelrate;}else if(newH>maxH){newH-=(newH-pixelrate<=maxH)?(newH-maxH):pixelrate;}
this.resizeHTimerArray[this.resizeHTimerCount++]=setTimeout("myLytebox.resizeH('"+id+"', "+newH+", "+maxH+", "+pixelrate+", "+(timer+.02)+")",timer+.02);if(parseInt(object.style.height)==maxH){this.hDone=true;for(var i=0;i<this.resizeHTimerCount;i++){window.clearTimeout(this.resizeHTimerArray[i]);}}};LyteBox.prototype.getPageScroll=function(){if(self.pageYOffset){return this.isFrame?parent.pageYOffset:self.pageYOffset;}else if(this.doc.documentElement&&this.doc.documentElement.scrollTop){return this.doc.documentElement.scrollTop;}else if(document.body){return this.doc.body.scrollTop;}};LyteBox.prototype.getPageSize=function(){var xScroll,yScroll,windowWidth,windowHeight;if(window.innerHeight&&window.scrollMaxY){xScroll=this.doc.scrollWidth;yScroll=(this.isFrame?parent.innerHeight:self.innerHeight)+(this.isFrame?parent.scrollMaxY:self.scrollMaxY);}else if(this.doc.body.scrollHeight>this.doc.body.offsetHeight){xScroll=this.doc.body.scrollWidth;yScroll=this.doc.body.scrollHeight;}else{xScroll=this.doc.getElementsByTagName("html").item(0).offsetWidth;yScroll=this.doc.getElementsByTagName("html").item(0).offsetHeight;xScroll=(xScroll<this.doc.body.offsetWidth)?this.doc.body.offsetWidth:xScroll;yScroll=(yScroll<this.doc.body.offsetHeight)?this.doc.body.offsetHeight:yScroll;}
if(self.innerHeight){windowWidth=(this.isFrame)?parent.innerWidth:self.innerWidth;windowHeight=(this.isFrame)?parent.innerHeight:self.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){windowWidth=this.doc.documentElement.clientWidth;windowHeight=this.doc.documentElement.clientHeight;}else if(document.body){windowWidth=this.doc.getElementsByTagName("html").item(0).clientWidth;windowHeight=this.doc.getElementsByTagName("html").item(0).clientHeight;windowWidth=(windowWidth==0)?this.doc.body.clientWidth:windowWidth;windowHeight=(windowHeight==0)?this.doc.body.clientHeight:windowHeight;}
var pageHeight=(yScroll<windowHeight)?windowHeight:yScroll;var pageWidth=(xScroll<windowWidth)?windowWidth:xScroll;return new Array(pageWidth,pageHeight,windowWidth,windowHeight);};LyteBox.prototype.toggleFlash=function(state){var objects=this.doc.getElementsByTagName("object");for(var i=0;i<objects.length;i++){objects[i].style.visibility=(state=="hide")?'hidden':'visible';}
var embeds=this.doc.getElementsByTagName("embed");for(var i=0;i<embeds.length;i++){embeds[i].style.visibility=(state=="hide")?'hidden':'visible';}
if(this.isFrame){for(var i=0;i<parent.frames.length;i++){try{objects=parent.frames[i].window.document.getElementsByTagName("object");for(var j=0;j<objects.length;j++){objects[j].style.visibility=(state=="hide")?'hidden':'visible';}}catch(e){}
try{embeds=parent.frames[i].window.document.getElementsByTagName("embed");for(var j=0;j<embeds.length;j++){embeds[j].style.visibility=(state=="hide")?'hidden':'visible';}}catch(e){}}}};LyteBox.prototype.toggleSelects=function(state){var selects=this.doc.getElementsByTagName("select");for(var i=0;i<selects.length;i++){selects[i].style.visibility=(state=="hide")?'hidden':'visible';}
if(this.isFrame){for(var i=0;i<parent.frames.length;i++){try{selects=parent.frames[i].window.document.getElementsByTagName("select");for(var j=0;j<selects.length;j++){selects[j].style.visibility=(state=="hide")?'hidden':'visible';}}catch(e){}}}};LyteBox.prototype.pause=function(numberMillis){var now=new Date();var exitTime=now.getTime()+numberMillis;while(true){now=new Date();if(now.getTime()>exitTime){return;}}};if(window.addEventListener){window.addEventListener("load",initLytebox,false);}else if(window.attachEvent){window.attachEvent("onload",initLytebox);}else{window.onload=function(){initLytebox();}}
function initLytebox(){myLytebox=new LyteBox();}
function playMBX(videoToPlay){document.writeln('<object   classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"    codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"    width="500"    height="281"    id="mbox_player_4c96d2b61f1be3c5c3">');document.writeln('<param name="movie" value="http://player.motionbox.com/VideoPlayer.swf?" />   <param name="allowScriptAccess" value="always" />   <param name="allowFullscreen" value="true" />   <param value="'+videoToPlay+'" name="flashvars" />');document.writeln('<!--[if !IE]>-->     <object        width="500"        height="281"        name="progressive_player"        allowscriptaccess="always"        allowfullscreen="true"        data="http://player.motionbox.com/VideoPlayer.swf?"        type="application/x-shockwave-flash"       flashvars="'+videoToPlay+'"     >   <!--<![endif]-->');document.writeln('<h2>To watch the video, you\'ll first need to  <a href="http://www.adobe.com/go/getflashplayer">install the flash player</a>.</h2>   <!--[if !IE]>-->     </object>\'   <!--<![endif]--> </object>');}
Rot13={map:null,convert:function(a){Rot13.init();var s="";for(i=0;i<a.length;i++){var b=a.charAt(i);s+=((b>='A'&&b<='Z')||(b>='a'&&b<='z')?Rot13.map[b]:b);}
return s;},init:function(){if(Rot13.map!=null)
return;var map=new Array();var s="abcdefghijklmnopqrstuvwxyz";for(i=0;i<s.length;i++)
map[s.charAt(i)]=s.charAt((i+13)%26);for(i=0;i<s.length;i++)
map[s.charAt(i).toUpperCase()]=s.charAt((i+13)%26).toUpperCase();Rot13.map=map;},write:function(a){document.write(Rot13.convert(a));}}
var swfobject=function(){var UNDEF="undefined",OBJECT="object",SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",EXPRESS_INSTALL_ID="SWFObjectExprInst",ON_READY_STATE_CHANGE="onreadystatechange",win=window,doc=document,nav=navigator,plugin=false,domLoadFnArr=[main],regObjArr=[],objIdArr=[],listenersArr=[],storedAltContent,storedAltContentId,storedCallbackFn,storedCallbackObj,isDomLoaded=false,isExpressInstallActive=false,dynamicStylesheet,dynamicStylesheetMedia,autoHideShow=true,ua=function(){var w3cdom=typeof doc.getElementById!=UNDEF&&typeof doc.getElementsByTagName!=UNDEF&&typeof doc.createElement!=UNDEF,u=nav.userAgent.toLowerCase(),p=nav.platform.toLowerCase(),windows=p?/win/.test(p):/win/.test(u),mac=p?/mac/.test(p):/mac/.test(u),webkit=/webkit/.test(u)?parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,ie=!+"\v1",playerVersion=[0,0,0],d=null;if(typeof nav.plugins!=UNDEF&&typeof nav.plugins[SHOCKWAVE_FLASH]==OBJECT){d=nav.plugins[SHOCKWAVE_FLASH].description;if(d&&!(typeof nav.mimeTypes!=UNDEF&&nav.mimeTypes[FLASH_MIME_TYPE]&&!nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)){plugin=true;ie=false;d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1");playerVersion[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10);playerVersion[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10);playerVersion[2]=/[a-zA-Z]/.test(d)?parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}
else if(typeof win.ActiveXObject!=UNDEF){try{var a=new ActiveXObject(SHOCKWAVE_FLASH_AX);if(a){d=a.GetVariable("$version");if(d){ie=true;d=d.split(" ")[1].split(",");playerVersion=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)];}}}
catch(e){}}
return{w3:w3cdom,pv:playerVersion,wk:webkit,ie:ie,win:windows,mac:mac};}(),onDomLoad=function(){if(!ua.w3){return;}
if((typeof doc.readyState!=UNDEF&&doc.readyState=="complete")||(typeof doc.readyState==UNDEF&&(doc.getElementsByTagName("body")[0]||doc.body))){callDomLoadFunctions();}
if(!isDomLoaded){if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("DOMContentLoaded",callDomLoadFunctions,false);}
if(ua.ie&&ua.win){doc.attachEvent(ON_READY_STATE_CHANGE,function(){if(doc.readyState=="complete"){doc.detachEvent(ON_READY_STATE_CHANGE,arguments.callee);callDomLoadFunctions();}});if(win==top){(function(){if(isDomLoaded){return;}
try{doc.documentElement.doScroll("left");}
catch(e){setTimeout(arguments.callee,0);return;}
callDomLoadFunctions();})();}}
if(ua.wk){(function(){if(isDomLoaded){return;}
if(!/loaded|complete/.test(doc.readyState)){setTimeout(arguments.callee,0);return;}
callDomLoadFunctions();})();}
addLoadEvent(callDomLoadFunctions);}}();function callDomLoadFunctions(){if(isDomLoaded){return;}
try{var t=doc.getElementsByTagName("body")[0].appendChild(createElement("span"));t.parentNode.removeChild(t);}
catch(e){return;}
isDomLoaded=true;var dl=domLoadFnArr.length;for(var i=0;i<dl;i++){domLoadFnArr[i]();}}
function addDomLoadEvent(fn){if(isDomLoaded){fn();}
else{domLoadFnArr[domLoadFnArr.length]=fn;}}
function addLoadEvent(fn){if(typeof win.addEventListener!=UNDEF){win.addEventListener("load",fn,false);}
else if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("load",fn,false);}
else if(typeof win.attachEvent!=UNDEF){addListener(win,"onload",fn);}
else if(typeof win.onload=="function"){var fnOld=win.onload;win.onload=function(){fnOld();fn();};}
else{win.onload=fn;}}
function main(){if(plugin){testPlayerVersion();}
else{matchVersions();}}
function testPlayerVersion(){var b=doc.getElementsByTagName("body")[0];var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);var t=b.appendChild(o);if(t){var counter=0;(function(){if(typeof t.GetVariable!=UNDEF){var d=t.GetVariable("$version");if(d){d=d.split(" ")[1].split(",");ua.pv=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)];}}
else if(counter<10){counter++;setTimeout(arguments.callee,10);return;}
b.removeChild(o);t=null;matchVersions();})();}
else{matchVersions();}}
function matchVersions(){var rl=regObjArr.length;if(rl>0){for(var i=0;i<rl;i++){var id=regObjArr[i].id;var cb=regObjArr[i].callbackFn;var cbObj={success:false,id:id};if(ua.pv[0]>0){var obj=getElementById(id);if(obj){if(hasPlayerVersion(regObjArr[i].swfVersion)&&!(ua.wk&&ua.wk<312)){setVisibility(id,true);if(cb){cbObj.success=true;cbObj.ref=getObjectById(id);cb(cbObj);}}
else if(regObjArr[i].expressInstall&&canExpressInstall()){var att={};att.data=regObjArr[i].expressInstall;att.width=obj.getAttribute("width")||"0";att.height=obj.getAttribute("height")||"0";if(obj.getAttribute("class")){att.styleclass=obj.getAttribute("class");}
if(obj.getAttribute("align")){att.align=obj.getAttribute("align");}
var par={};var p=obj.getElementsByTagName("param");var pl=p.length;for(var j=0;j<pl;j++){if(p[j].getAttribute("name").toLowerCase()!="movie"){par[p[j].getAttribute("name")]=p[j].getAttribute("value");}}
showExpressInstall(att,par,id,cb);}
else{displayAltContent(obj);if(cb){cb(cbObj);}}}}
else{setVisibility(id,true);if(cb){var o=getObjectById(id);if(o&&typeof o.SetVariable!=UNDEF){cbObj.success=true;cbObj.ref=o;}
cb(cbObj);}}}}}
function getObjectById(objectIdStr){var r=null;var o=getElementById(objectIdStr);if(o&&o.nodeName=="OBJECT"){if(typeof o.SetVariable!=UNDEF){r=o;}
else{var n=o.getElementsByTagName(OBJECT)[0];if(n){r=n;}}}
return r;}
function canExpressInstall(){return!isExpressInstallActive&&hasPlayerVersion("6.0.65")&&(ua.win||ua.mac)&&!(ua.wk&&ua.wk<312);}
function showExpressInstall(att,par,replaceElemIdStr,callbackFn){isExpressInstallActive=true;storedCallbackFn=callbackFn||null;storedCallbackObj={success:false,id:replaceElemIdStr};var obj=getElementById(replaceElemIdStr);if(obj){if(obj.nodeName=="OBJECT"){storedAltContent=abstractAltContent(obj);storedAltContentId=null;}
else{storedAltContent=obj;storedAltContentId=replaceElemIdStr;}
att.id=EXPRESS_INSTALL_ID;if(typeof att.width==UNDEF||(!/%$/.test(att.width)&&parseInt(att.width,10)<310)){att.width="310";}
if(typeof att.height==UNDEF||(!/%$/.test(att.height)&&parseInt(att.height,10)<137)){att.height="137";}
doc.title=doc.title.slice(0,47)+" - Flash Player Installation";var pt=ua.ie&&ua.win?"ActiveX":"PlugIn",fv="MMredirectURL="+win.location.toString().replace(/&/g,"%26")+"&MMplayerType="+pt+"&MMdoctitle="+doc.title;if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+fv;}
else{par.flashvars=fv;}
if(ua.ie&&ua.win&&obj.readyState!=4){var newObj=createElement("div");replaceElemIdStr+="SWFObjectNew";newObj.setAttribute("id",replaceElemIdStr);obj.parentNode.insertBefore(newObj,obj);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj);}
else{setTimeout(arguments.callee,10);}})();}
createSWF(att,par,replaceElemIdStr);}}
function displayAltContent(obj){if(ua.ie&&ua.win&&obj.readyState!=4){var el=createElement("div");obj.parentNode.insertBefore(el,obj);el.parentNode.replaceChild(abstractAltContent(obj),el);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj);}
else{setTimeout(arguments.callee,10);}})();}
else{obj.parentNode.replaceChild(abstractAltContent(obj),obj);}}
function abstractAltContent(obj){var ac=createElement("div");if(ua.win&&ua.ie){ac.innerHTML=obj.innerHTML;}
else{var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj){var c=nestedObj.childNodes;if(c){var cl=c.length;for(var i=0;i<cl;i++){if(!(c[i].nodeType==1&&c[i].nodeName=="PARAM")&&!(c[i].nodeType==8)){ac.appendChild(c[i].cloneNode(true));}}}}}
return ac;}
function createSWF(attObj,parObj,id){var r,el=getElementById(id);if(ua.wk&&ua.wk<312){return r;}
if(el){if(typeof attObj.id==UNDEF){attObj.id=id;}
if(ua.ie&&ua.win){var att="";for(var i in attObj){if(attObj[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){parObj.movie=attObj[i];}
else if(i.toLowerCase()=="styleclass"){att+=' class="'+attObj[i]+'"';}
else if(i.toLowerCase()!="classid"){att+=' '+i+'="'+attObj[i]+'"';}}}
var par="";for(var j in parObj){if(parObj[j]!=Object.prototype[j]){par+='<param name="'+j+'" value="'+parObj[j]+'" />';}}
el.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+att+'>'+par+'</object>';objIdArr[objIdArr.length]=attObj.id;r=getElementById(attObj.id);}
else{var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);for(var m in attObj){if(attObj[m]!=Object.prototype[m]){if(m.toLowerCase()=="styleclass"){o.setAttribute("class",attObj[m]);}
else if(m.toLowerCase()!="classid"){o.setAttribute(m,attObj[m]);}}}
for(var n in parObj){if(parObj[n]!=Object.prototype[n]&&n.toLowerCase()!="movie"){createObjParam(o,n,parObj[n]);}}
el.parentNode.replaceChild(o,el);r=o;}}
return r;}
function createObjParam(el,pName,pValue){var p=createElement("param");p.setAttribute("name",pName);p.setAttribute("value",pValue);el.appendChild(p);}
function removeSWF(id){var obj=getElementById(id);if(obj&&obj.nodeName=="OBJECT"){if(ua.ie&&ua.win){obj.style.display="none";(function(){if(obj.readyState==4){removeObjectInIE(id);}
else{setTimeout(arguments.callee,10);}})();}
else{obj.parentNode.removeChild(obj);}}}
function removeObjectInIE(id){var obj=getElementById(id);if(obj){for(var i in obj){if(typeof obj[i]=="function"){obj[i]=null;}}
obj.parentNode.removeChild(obj);}}
function getElementById(id){var el=null;try{el=doc.getElementById(id);}
catch(e){}
return el;}
function createElement(el){return doc.createElement(el);}
function addListener(target,eventType,fn){target.attachEvent(eventType,fn);listenersArr[listenersArr.length]=[target,eventType,fn];}
function hasPlayerVersion(rv){var pv=ua.pv,v=rv.split(".");v[0]=parseInt(v[0],10);v[1]=parseInt(v[1],10)||0;v[2]=parseInt(v[2],10)||0;return(pv[0]>v[0]||(pv[0]==v[0]&&pv[1]>v[1])||(pv[0]==v[0]&&pv[1]==v[1]&&pv[2]>=v[2]))?true:false;}
function createCSS(sel,decl,media,newStyle){if(ua.ie&&ua.mac){return;}
var h=doc.getElementsByTagName("head")[0];if(!h){return;}
var m=(media&&typeof media=="string")?media:"screen";if(newStyle){dynamicStylesheet=null;dynamicStylesheetMedia=null;}
if(!dynamicStylesheet||dynamicStylesheetMedia!=m){var s=createElement("style");s.setAttribute("type","text/css");s.setAttribute("media",m);dynamicStylesheet=h.appendChild(s);if(ua.ie&&ua.win&&typeof doc.styleSheets!=UNDEF&&doc.styleSheets.length>0){dynamicStylesheet=doc.styleSheets[doc.styleSheets.length-1];}
dynamicStylesheetMedia=m;}
if(ua.ie&&ua.win){if(dynamicStylesheet&&typeof dynamicStylesheet.addRule==OBJECT){dynamicStylesheet.addRule(sel,decl);}}
else{if(dynamicStylesheet&&typeof doc.createTextNode!=UNDEF){dynamicStylesheet.appendChild(doc.createTextNode(sel+" {"+decl+"}"));}}}
function setVisibility(id,isVisible){if(!autoHideShow){return;}
var v=isVisible?"visible":"hidden";if(isDomLoaded&&getElementById(id)){getElementById(id).style.visibility=v;}
else{createCSS("#"+id,"visibility:"+v);}}
function urlEncodeIfNecessary(s){var regex=/[\\\"<>\.;]/;var hasBadChars=regex.exec(s)!=null;return hasBadChars&&typeof encodeURIComponent!=UNDEF?encodeURIComponent(s):s;}
var cleanup=function(){if(ua.ie&&ua.win){window.attachEvent("onunload",function(){var ll=listenersArr.length;for(var i=0;i<ll;i++){listenersArr[i][0].detachEvent(listenersArr[i][1],listenersArr[i][2]);}
var il=objIdArr.length;for(var j=0;j<il;j++){removeSWF(objIdArr[j]);}
for(var k in ua){ua[k]=null;}
ua=null;for(var l in swfobject){swfobject[l]=null;}
swfobject=null;});}}();return{registerObject:function(objectIdStr,swfVersionStr,xiSwfUrlStr,callbackFn){if(ua.w3&&objectIdStr&&swfVersionStr){var regObj={};regObj.id=objectIdStr;regObj.swfVersion=swfVersionStr;regObj.expressInstall=xiSwfUrlStr;regObj.callbackFn=callbackFn;regObjArr[regObjArr.length]=regObj;setVisibility(objectIdStr,false);}
else if(callbackFn){callbackFn({success:false,id:objectIdStr});}},getObjectById:function(objectIdStr){if(ua.w3){return getObjectById(objectIdStr);}},embedSWF:function(swfUrlStr,replaceElemIdStr,widthStr,heightStr,swfVersionStr,xiSwfUrlStr,flashvarsObj,parObj,attObj,callbackFn){var callbackObj={success:false,id:replaceElemIdStr};if(ua.w3&&!(ua.wk&&ua.wk<312)&&swfUrlStr&&replaceElemIdStr&&widthStr&&heightStr&&swfVersionStr){setVisibility(replaceElemIdStr,false);addDomLoadEvent(function(){widthStr+="";heightStr+="";var att={};if(attObj&&typeof attObj===OBJECT){for(var i in attObj){att[i]=attObj[i];}}
att.data=swfUrlStr;att.width=widthStr;att.height=heightStr;var par={};if(parObj&&typeof parObj===OBJECT){for(var j in parObj){par[j]=parObj[j];}}
if(flashvarsObj&&typeof flashvarsObj===OBJECT){for(var k in flashvarsObj){if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+k+"="+flashvarsObj[k];}
else{par.flashvars=k+"="+flashvarsObj[k];}}}
if(hasPlayerVersion(swfVersionStr)){var obj=createSWF(att,par,replaceElemIdStr);if(att.id==replaceElemIdStr){setVisibility(replaceElemIdStr,true);}
callbackObj.success=true;callbackObj.ref=obj;}
else if(xiSwfUrlStr&&canExpressInstall()){att.data=xiSwfUrlStr;showExpressInstall(att,par,replaceElemIdStr,callbackFn);return;}
else{setVisibility(replaceElemIdStr,true);}
if(callbackFn){callbackFn(callbackObj);}});}
else if(callbackFn){callbackFn(callbackObj);}},switchOffAutoHideShow:function(){autoHideShow=false;},ua:ua,getFlashPlayerVersion:function(){return{major:ua.pv[0],minor:ua.pv[1],release:ua.pv[2]};},hasFlashPlayerVersion:hasPlayerVersion,createSWF:function(attObj,parObj,replaceElemIdStr){if(ua.w3){return createSWF(attObj,parObj,replaceElemIdStr);}
else{return undefined;}},showExpressInstall:function(att,par,replaceElemIdStr,callbackFn){if(ua.w3&&canExpressInstall()){showExpressInstall(att,par,replaceElemIdStr,callbackFn);}},removeSWF:function(objElemIdStr){if(ua.w3){removeSWF(objElemIdStr);}},createCSS:function(selStr,declStr,mediaStr,newStyleBoolean){if(ua.w3){createCSS(selStr,declStr,mediaStr,newStyleBoolean);}},addDomLoadEvent:addDomLoadEvent,addLoadEvent:addLoadEvent,getQueryParamValue:function(param){var q=doc.location.search||doc.location.hash;if(q){if(/\?/.test(q)){q=q.split("?")[1];}
if(param==null){return urlEncodeIfNecessary(q);}
var pairs=q.split("&");for(var i=0;i<pairs.length;i++){if(pairs[i].substring(0,pairs[i].indexOf("="))==param){return urlEncodeIfNecessary(pairs[i].substring((pairs[i].indexOf("=")+1)));}}}
return"";},expressInstallCallback:function(){if(isExpressInstallActive){var obj=getElementById(EXPRESS_INSTALL_ID);if(obj&&storedAltContent){obj.parentNode.replaceChild(storedAltContent,obj);if(storedAltContentId){setVisibility(storedAltContentId,true);if(ua.ie&&ua.win){storedAltContent.style.display="block";}}
if(storedCallbackFn){storedCallbackFn(storedCallbackObj);}}
isExpressInstallActive=false;}}};}();function newVideoPlayer(videoURL,movieWidth,movieHeight,waterMarkURL){var vidId='flv_'+Math.round(Math.random()*10000);if(!parseInt(movieWidth))
movieWidth=500;if(!parseInt(movieHeight))
movieHeight=375;if(movieWidth>500){var oldMovieWidth=movieWidth;movieWidth=500;movieHeight=Math.round(movieHeight/oldMovieWidth*movieWidth)+20;}else{movieHeight+=20;}
var flashvars={bgcolor:"#000000",videoURL:videoURL,stageWidth:movieWidth,stageHeight:movieHeight,waterMarkImageURL:waterMarkURL};var params={quality:'best',scale:'noscale',salign:'tl',allowScriptAccess:'always'};var attributes={'class':"flv gawkerVideo"};if(window.permalink)
flashvars.permalink=permalink;else
flashvars.permalink="undefined";if(window.autoplay)
{flashvars.autoplay=autoplay;window.autoplay=false;}
else
flashvars.autoplay="undefined";document.writeln('<object class="flv gawkerVideo" style="height: '+movieHeight+'px; width: '+movieWidth+'px;" id="'+vidId+'"></object>');swfobject.embedSWF("http://cache-foo.gawkerassets.com/gawker/assets/util/videoModule.008.2.swf",vidId,movieWidth,movieHeight,"9.0.0","expressInstall.swf",flashvars,params,attributes);}

